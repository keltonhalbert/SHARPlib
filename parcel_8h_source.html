<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<title>SPC Sounding and Hodoraph Analysis and Research Program Calculation Library: parcel.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
   DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SPC Sounding and Hodoraph Analysis and Research Program Calculation Library
   &#160;<span id="projectnumber">1.0.0 Preview</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('parcel_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">parcel.h</div></div>
</div><!--header-->
<div class="contents">
<a href="parcel_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#ifndef SHARP_PARCEL_H</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#define SHARP_PARCEL_H</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;<a class="code" href="constants_8h.html">SHARPlib/constants.h</a>&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;<a class="code" href="interp_8h.html">SHARPlib/interp.h</a>&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;<a class="code" href="layer_8h.html">SHARPlib/layer.h</a>&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;<a class="code" href="thermo_8h.html">SHARPlib/thermo.h</a>&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;cstddef&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacesharp.html">sharp</a> {</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="comment">//</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__wobus.html">   46</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structsharp_1_1lifter__wobus.html">lifter_wobus</a> {</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__wobus.html#ad3b54dc77d2e28f97155f7522b7972df">   47</a></span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="structsharp_1_1lifter__wobus.html#ad3b54dc77d2e28f97155f7522b7972df">lift_from_lcl</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__wobus.html#aff7ac3dd393ccac49f491014ffa09f57">   57</a></span>    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="structsharp_1_1lifter__wobus.html#aff7ac3dd393ccac49f491014ffa09f57">setup</a>([[maybe_unused]] <span class="keyword">const</span> <span class="keywordtype">float</span> lcl_pres,</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>                      [[maybe_unused]] <span class="keyword">const</span> <span class="keywordtype">float</span> lcl_tmpk)<span class="keyword"> const </span>{}</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__wobus.html#a92ffe04c0425aef07c524759d799066e">   68</a></span>    [[nodiscard]] <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="structsharp_1_1lifter__wobus.html#a92ffe04c0425aef07c524759d799066e">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> pres, <span class="keyword">const</span> <span class="keywordtype">float</span> tmpk,</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>                                          <span class="keyword">const</span> <span class="keywordtype">float</span> new_pres)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#ad4014313c60a66a321e4050a2a07058e">wetlift</a>(pres, tmpk, new_pres);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    }</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__wobus.html#a82be5bdfdff54890488bbc1461b5b05e">   80</a></span>    [[nodiscard]] <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="structsharp_1_1lifter__wobus.html#a82be5bdfdff54890488bbc1461b5b05e">parcel_virtual_temperature</a>(</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> pres, <span class="keyword">const</span> <span class="keywordtype">float</span> tmpk)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a46e2f332f68747fee1eb817f7bd3a00b">virtual_temperature</a>(tmpk, <a class="code hl_function" href="namespacesharp.html#ac38870166f07ac30aadbc46b81340cc4">mixratio</a>(pres, tmpk));</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    }</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>};</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__cm1.html">   86</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structsharp_1_1lifter__cm1.html">lifter_cm1</a> {</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>   <span class="keyword">private</span>:</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__cm1.html#a1758f1feeedd42ff248ad6b55cbde000">   91</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1lifter__cm1.html#a1758f1feeedd42ff248ad6b55cbde000">rv_total</a> = <a class="code hl_variable" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>;</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__cm1.html#a4cdf7ebf0718b56fba138b928b559182">   96</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1lifter__cm1.html#a4cdf7ebf0718b56fba138b928b559182">rv</a> = <a class="code hl_variable" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>;</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span> </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__cm1.html#a4ae0d7ec453ae9489643f8ff57cf8139">  101</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1lifter__cm1.html#a4ae0d7ec453ae9489643f8ff57cf8139">rl</a> = <a class="code hl_variable" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>;</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__cm1.html#aaa41a6bdf1541d95e19f8a56d39c8865">  106</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1lifter__cm1.html#aaa41a6bdf1541d95e19f8a56d39c8865">ri</a> = <a class="code hl_variable" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>   <span class="keyword">public</span>:</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__cm1.html#ae9db9fdbbb833b32bcae1044a21c9040">  109</a></span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="structsharp_1_1lifter__cm1.html#ae9db9fdbbb833b32bcae1044a21c9040">lift_from_lcl</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__cm1.html#ae46c58cea6eb213e69cefa910b897538">  114</a></span>    <a class="code hl_enumeration" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81">adiabat</a> <a class="code hl_variable" href="structsharp_1_1lifter__cm1.html#ae46c58cea6eb213e69cefa910b897538">ma_type</a> = <a class="code hl_enumvalue" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81a2950b2ab4ab4c2d385ff16dfae8003c0">adiabat::pseudo_liq</a>;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__cm1.html#a14991ad94ae6bac4421a2a7f3f9a5e4c">  119</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1lifter__cm1.html#a14991ad94ae6bac4421a2a7f3f9a5e4c">pressure_incr</a> = 500.0f;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__cm1.html#a645233f46f93344a4050118a3fcd0c9c">  124</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1lifter__cm1.html#a645233f46f93344a4050118a3fcd0c9c">converge</a> = 0.001f;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__cm1.html#a4750e359411eefdfb6d4970052637750">  134</a></span>    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="structsharp_1_1lifter__cm1.html#a4750e359411eefdfb6d4970052637750">setup</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> lcl_pres, <span class="keyword">const</span> <span class="keywordtype">float</span> lcl_tmpk) {</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>        this-&gt;rv_total = <a class="code hl_function" href="namespacesharp.html#ac38870166f07ac30aadbc46b81340cc4">mixratio</a>(lcl_pres, lcl_tmpk);</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>        this-&gt;rv = 0.0f;</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>        this-&gt;rl = 0.0f;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>        this-&gt;ri = 0.0f;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    }</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span> </div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__cm1.html#a2eeb5b118ef40e873c09ac9b3635f7b9">  150</a></span>    [[nodiscard]] <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="structsharp_1_1lifter__cm1.html#a2eeb5b118ef40e873c09ac9b3635f7b9">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> pres, <span class="keyword">const</span> <span class="keywordtype">float</span> tmpk,</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>                                          <span class="keyword">const</span> <span class="keywordtype">float</span> new_pres) {</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#aa258841692c25171d3f3b2e8b1f52079">moist_adiabat_cm1</a>(pres, tmpk, new_pres, this-&gt;rv_total, this-&gt;rv,</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>                                 this-&gt;rl, this-&gt;ri, this-&gt;pressure_incr,</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>                                 this-&gt;converge, this-&gt;ma_type);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    }</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno"><a class="line" href="structsharp_1_1lifter__cm1.html#a2fc203010e232bd969ac0b09f15c4329">  164</a></span>    [[nodiscard]] <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="structsharp_1_1lifter__cm1.html#a2fc203010e232bd969ac0b09f15c4329">parcel_virtual_temperature</a>(</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        [[maybe_unused]] <span class="keyword">const</span> <span class="keywordtype">float</span> pres, <span class="keyword">const</span> <span class="keywordtype">float</span> tmpk)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a46e2f332f68747fee1eb817f7bd3a00b">virtual_temperature</a>(tmpk, this-&gt;rv, this-&gt;rl, this-&gt;ri);</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    }</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>};</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span><span class="comment">//</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span><span class="comment"></span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno"><a class="line" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997f">  195</a></span><span class="keyword">enum class</span> <a class="code hl_enumeration" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997f">LPL</a> : <span class="keywordtype">int</span> {</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997faf3385210bc009d67471bd739689779de">SFC</a> = 1,</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span> </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fa0f46ff8d6503905b6b729f2ec851079f">FCST</a> = 2,</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fae5919ba9cf2e803bdbc98334a7f64daa">MU</a> = 3,  <span class="comment">// most unstable</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fad01fd9b01e9dde8bd3dc247afbfb7218">ML</a> = 4,  <span class="comment">// Mixed layer</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fa2b6cc9c30eaad9c109091ea928529cbd">USR</a> = 5,  <span class="comment">// user-defined</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab1a326c06d88bf042f73d70f50197905">END</a>,</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>};</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html">  232</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structsharp_1_1Parcel.html">Parcel</a> {</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#acdce27acf6bd8a327993f5d4cf240906">  236</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#acdce27acf6bd8a327993f5d4cf240906">pres</a> = <a class="code hl_variable" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#abd477130779ca88ce737770fb7a0b748">  241</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#abd477130779ca88ce737770fb7a0b748">tmpk</a> = <a class="code hl_variable" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#aec26ccd19be00c0c3368b416bee1cd61">  246</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#aec26ccd19be00c0c3368b416bee1cd61">dwpk</a> = <a class="code hl_variable" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span> </div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#ae4798e73dc979eb1bf00d7057ed7eea0">  251</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#ae4798e73dc979eb1bf00d7057ed7eea0">lcl_pressure</a> = <a class="code hl_variable" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#a55dcb9c777b42c5f35537730c044e004">  256</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#a55dcb9c777b42c5f35537730c044e004">lfc_pressure</a> = <a class="code hl_variable" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#ac76710675fd2f495d52ac35d0d1de246">  261</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#ac76710675fd2f495d52ac35d0d1de246">eql_pressure</a> = <a class="code hl_variable" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">  267</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">cape</a> = 0.0;</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#af2f4106c560b37ed8d13c3f272fa68a4">  272</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#af2f4106c560b37ed8d13c3f272fa68a4">cinh</a> = 0.0;</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#a43773542f542f0fb4a2c85bd71a39cb8">  277</a></span>    <a class="code hl_enumeration" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997f">LPL</a> <a class="code hl_variable" href="structsharp_1_1Parcel.html#a43773542f542f0fb4a2c85bd71a39cb8">source</a>;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <a class="code hl_function" href="structsharp_1_1Parcel.html#a4141b5aa7889103f11e031be28545f4d">Parcel</a>();</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    <a class="code hl_function" href="structsharp_1_1Parcel.html#a4141b5aa7889103f11e031be28545f4d">Parcel</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, <span class="keyword">const</span> <span class="keywordtype">float</span> temperature, <span class="keyword">const</span> <span class="keywordtype">float</span> dewpoint,</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>           <span class="keyword">const</span> <a class="code hl_enumeration" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997f">LPL</a> lpl);</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Lft&gt;</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#a9523de2b8b4c28ca49fba3013f94cb06">  300</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="structsharp_1_1Parcel.html#a9523de2b8b4c28ca49fba3013f94cb06">lift_parcel</a>(Lft&amp; liftpcl, <span class="keyword">const</span> <span class="keywordtype">float</span> pressure_arr[],</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>                     <span class="keywordtype">float</span> pcl_vtmpk_arr[], <span class="keyword">const</span> std::ptrdiff_t N) {</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>        <span class="comment">// Lift the parcel from the LPL to the LCL</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        <span class="keywordtype">float</span> pres_lcl;</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        <span class="keywordtype">float</span> tmpk_lcl;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        <a class="code hl_function" href="namespacesharp.html#ae4385866921cd7286946d9ffdd65c25e">drylift</a>(this-&gt;pres, this-&gt;tmpk, this-&gt;dwpk, pres_lcl, tmpk_lcl);</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>        <span class="comment">// If we are lifting elevated parcel (i.e. EIL), we need to make</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        <span class="comment">// sure our LCL isnt above the top of our data.</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>        <span class="keywordflow">if</span> (pres_lcl &lt; pressure_arr[N - 1]) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span> </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>        this-&gt;lcl_pressure = pres_lcl;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> qv_lcl = <a class="code hl_function" href="namespacesharp.html#ac38870166f07ac30aadbc46b81340cc4">mixratio</a>(pres_lcl, tmpk_lcl);</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> thetav_lcl =</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>            <a class="code hl_function" href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">theta</a>(pres_lcl, <a class="code hl_function" href="namespacesharp.html#a46e2f332f68747fee1eb817f7bd3a00b">virtual_temperature</a>(tmpk_lcl, qv_lcl),</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>                  <a class="code hl_variable" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">THETA_REF_PRESSURE</a>);</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span> </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        <span class="comment">// Define the dry and saturated lift layers</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>        <a class="code hl_struct" href="structsharp_1_1PressureLayer.html">PressureLayer</a> dry_lyr = {this-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#acdce27acf6bd8a327993f5d4cf240906">pres</a>, this-&gt;lcl_pressure};</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <a class="code hl_struct" href="structsharp_1_1PressureLayer.html">PressureLayer</a> sat_lyr = {this-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#ae4798e73dc979eb1bf00d7057ed7eea0">lcl_pressure</a>, pressure_arr[N - 1]};</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        <span class="comment">// The LayerIndex excludes the top and bottom for interpolation reasons</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>        <span class="keyword">const</span> <a class="code hl_struct" href="structsharp_1_1LayerIndex.html">LayerIndex</a> dry_idx = <a class="code hl_function" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index</a>(dry_lyr, pressure_arr, N);</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>        <span class="keyword">const</span> <a class="code hl_struct" href="structsharp_1_1LayerIndex.html">LayerIndex</a> sat_idx = <a class="code hl_function" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index</a>(sat_lyr, pressure_arr, N);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span> </div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>        <span class="comment">// zero out any residual buoyancy from</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>        <span class="comment">// other parcels that may have been lifted</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>        <span class="keywordflow">for</span> (std::ptrdiff_t k = 0; k &lt; dry_idx.<a class="code hl_variable" href="structsharp_1_1LayerIndex.html#a29cd85832f403659b88daab19abac1ca">kbot</a>; ++k) {</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>            pcl_vtmpk_arr[k] = 0.0f;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>        }</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span> </div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>        <span class="comment">// Virtual potential temperature (Theta-V)</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>        <span class="comment">// is conserved for a parcels dry ascent to the LCL</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>        <span class="keywordflow">for</span> (std::ptrdiff_t k = dry_idx.<a class="code hl_variable" href="structsharp_1_1LayerIndex.html#a29cd85832f403659b88daab19abac1ca">kbot</a>; k &lt; dry_idx.<a class="code hl_variable" href="structsharp_1_1LayerIndex.html#a849a04de93753261c91c58b590e60ee2">ktop</a> + 1; ++k) {</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> pcl_vtmp =</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>                <a class="code hl_function" href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">theta</a>(<a class="code hl_variable" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">THETA_REF_PRESSURE</a>, thetav_lcl, pressure_arr[k]);</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>            pcl_vtmpk_arr[k] = pcl_vtmp;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        }</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span> </div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        <span class="keywordtype">float</span> pres_bot = pres_lcl;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        <span class="keywordtype">float</span> tmpk_bot = tmpk_lcl;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        liftpcl.setup(pres_lcl, tmpk_lcl);</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        <span class="comment">// fill the array with the moist parcel buoyancy</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        <span class="keywordflow">for</span> (std::ptrdiff_t k = sat_idx.<a class="code hl_variable" href="structsharp_1_1LayerIndex.html#a29cd85832f403659b88daab19abac1ca">kbot</a>; k &lt; N; ++k) {</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>            <span class="comment">// compute above-lcl buoyancy here</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> pcl_pres = pressure_arr[k];</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> pcl_tmpk = liftpcl(pres_bot, tmpk_bot, pcl_pres);</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span> </div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (!Lft::lift_from_lcl) {</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>                pres_bot = pcl_pres;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>                tmpk_bot = pcl_tmpk;</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>            }</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span> </div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> pcl_vtmpk =</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>                liftpcl.parcel_virtual_temperature(pcl_pres, pcl_tmpk);</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>            pcl_vtmpk_arr[k] = pcl_vtmpk;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        }</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    }</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span> </div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="structsharp_1_1Parcel.html#a8a311e09b1d46a829212da94cf181537">find_lfc_el</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> pres_arr[], <span class="keyword">const</span> <span class="keywordtype">float</span> hght_arr[],</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>                     <span class="keyword">const</span> <span class="keywordtype">float</span> buoy_arr[], <span class="keyword">const</span> std::ptrdiff_t N);</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="structsharp_1_1Parcel.html#a0560bd193b2d2d6bc6b08baa7463fba4">cape_cinh</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> pres_arr[], <span class="keyword">const</span> <span class="keywordtype">float</span> hght_arr[],</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>                   <span class="keyword">const</span> <span class="keywordtype">float</span> buoy_arr[], <span class="keyword">const</span> std::ptrdiff_t N);</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#aa1b370d9ea08877cc6438241fd013e3a">  412</a></span>    <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code hl_struct" href="structsharp_1_1Parcel.html">Parcel</a> <a class="code hl_function" href="structsharp_1_1Parcel.html#aa1b370d9ea08877cc6438241fd013e3a">surface_parcel</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>,</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>                                        <span class="keyword">const</span> <span class="keywordtype">float</span> temperature,</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>                                        <span class="keyword">const</span> <span class="keywordtype">float</span> dewpoint) <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="structsharp_1_1Parcel.html#a4141b5aa7889103f11e031be28545f4d">Parcel</a>(<a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, temperature, dewpoint, <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997faf3385210bc009d67471bd739689779de">LPL::SFC</a>);</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    }</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Lyr&gt;</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#a1bf670e79f35a1ce8c904b7ead32ccbe">  438</a></span>    <span class="keyword">static</span> <a class="code hl_struct" href="structsharp_1_1Parcel.html">Parcel</a> <a class="code hl_function" href="structsharp_1_1Parcel.html#a1bf670e79f35a1ce8c904b7ead32ccbe">mixed_layer_parcel</a>(Lyr&amp; mix_layer, <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[],</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>                                     [[maybe_unused]] <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[],</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>                                     <span class="keyword">const</span> <span class="keywordtype">float</span> pot_temperature[],</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>                                     <span class="keyword">const</span> <span class="keywordtype">float</span> wv_mixratio[],</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>                                     <span class="keyword">const</span> std::ptrdiff_t N) <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>        <span class="keywordtype">float</span> mean_mixr, mean_thta, pcl_pres;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (Lyr::coord == <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">LayerCoordinate::pressure</a>) {</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>            mean_mixr = <a class="code hl_function" href="namespacesharp.html#a298e2c96c389f2c5177d3626c908927e">layer_mean</a>(mix_layer, <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, wv_mixratio, N);</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>            mean_thta = <a class="code hl_function" href="namespacesharp.html#a298e2c96c389f2c5177d3626c908927e">layer_mean</a>(mix_layer, <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, pot_temperature, N);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>            pcl_pres = mix_layer.bottom;</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span> </div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>            mean_mixr = <a class="code hl_function" href="namespacesharp.html#a298e2c96c389f2c5177d3626c908927e">layer_mean</a>(mix_layer, <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, wv_mixratio, N);</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>            mean_thta =</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>                <a class="code hl_function" href="namespacesharp.html#a298e2c96c389f2c5177d3626c908927e">layer_mean</a>(mix_layer, <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, pot_temperature, N);</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>            pcl_pres =</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>                <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">sharp::interp_height</a>(mix_layer.bottom, <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, N);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>        }</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#abd477130779ca88ce737770fb7a0b748">tmpk</a> = <a class="code hl_function" href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">theta</a>(<a class="code hl_variable" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">THETA_REF_PRESSURE</a>, mean_thta, pcl_pres);</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#aec26ccd19be00c0c3368b416bee1cd61">dwpk</a> = <a class="code hl_function" href="namespacesharp.html#a90a9ae3f1a154cecbcf65d7dbf19233f">temperature_at_mixratio</a>(mean_mixr, pcl_pres);</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="structsharp_1_1Parcel.html#a4141b5aa7889103f11e031be28545f4d">Parcel</a>(pcl_pres, <a class="code hl_variable" href="structsharp_1_1Parcel.html#abd477130779ca88ce737770fb7a0b748">tmpk</a>, <a class="code hl_variable" href="structsharp_1_1Parcel.html#aec26ccd19be00c0c3368b416bee1cd61">dwpk</a>, <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fad01fd9b01e9dde8bd3dc247afbfb7218">LPL::ML</a>);</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    }</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Lyr, <span class="keyword">typename</span> Lft&gt;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno"><a class="line" href="structsharp_1_1Parcel.html#aa258d27992d22d8b80cb221e6e2a6c19">  486</a></span>    <span class="keyword">static</span> <a class="code hl_struct" href="structsharp_1_1Parcel.html">Parcel</a> <a class="code hl_function" href="structsharp_1_1Parcel.html#aa258d27992d22d8b80cb221e6e2a6c19">most_unstable_parcel</a>(</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>        Lyr&amp; search_layer, Lft&amp; lifter, <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[],</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], <span class="keyword">const</span> <span class="keywordtype">float</span> temperature[], <span class="keyword">const</span> <span class="keywordtype">float</span> virtemp[],</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> dewpoint[], <span class="keywordtype">float</span> pcl_virtemp[], <span class="keywordtype">float</span> buoy_arr[],</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>        <span class="keyword">const</span> std::ptrdiff_t N) <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>        <a class="code hl_struct" href="structsharp_1_1LayerIndex.html">LayerIndex</a> lyr_idx;</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (Lyr::coord == <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">LayerCoordinate::pressure</a>) {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>            lyr_idx = <a class="code hl_function" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index</a>(search_layer, <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, N);</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span> </div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>            lyr_idx = <a class="code hl_function" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index</a>(search_layer, <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, N);</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>        }</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> </div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>        <a class="code hl_struct" href="structsharp_1_1Parcel.html">Parcel</a> max_parcel;</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>        <span class="keywordflow">for</span> (std::ptrdiff_t idx = lyr_idx.<a class="code hl_variable" href="structsharp_1_1LayerIndex.html#a29cd85832f403659b88daab19abac1ca">kbot</a>; idx &lt;= lyr_idx.<a class="code hl_variable" href="structsharp_1_1LayerIndex.html#a849a04de93753261c91c58b590e60ee2">ktop</a>; ++idx) {</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#acdce27acf6bd8a327993f5d4cf240906">pres</a> = <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[idx];</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#abd477130779ca88ce737770fb7a0b748">tmpk</a> = temperature[idx];</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_variable" href="structsharp_1_1Parcel.html#aec26ccd19be00c0c3368b416bee1cd61">dwpk</a> = dewpoint[idx];</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>            <a class="code hl_struct" href="structsharp_1_1Parcel.html">Parcel</a> pcl(<a class="code hl_variable" href="structsharp_1_1Parcel.html#acdce27acf6bd8a327993f5d4cf240906">pres</a>, <a class="code hl_variable" href="structsharp_1_1Parcel.html#abd477130779ca88ce737770fb7a0b748">tmpk</a>, <a class="code hl_variable" href="structsharp_1_1Parcel.html#aec26ccd19be00c0c3368b416bee1cd61">dwpk</a>, <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fae5919ba9cf2e803bdbc98334a7f64daa">LPL::MU</a>);</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span> </div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>            pcl.<a class="code hl_function" href="structsharp_1_1Parcel.html#a9523de2b8b4c28ca49fba3013f94cb06">lift_parcel</a>(lifter, <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, pcl_virtemp, N);</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>            <a class="code hl_function" href="namespacesharp.html#aae31e8a18568ec26222b603e629c5598">buoyancy</a>(pcl_virtemp, virtemp, buoy_arr, N);</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>            pcl.<a class="code hl_function" href="structsharp_1_1Parcel.html#a0560bd193b2d2d6bc6b08baa7463fba4">cape_cinh</a>(<a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, buoy_arr, N);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>            <span class="keywordflow">if</span> (pcl.<a class="code hl_variable" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">cape</a> &gt; max_parcel.<a class="code hl_variable" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">cape</a>) max_parcel = pcl;</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>        }</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>        <span class="keywordflow">return</span> max_parcel;</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>    }</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>};</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span> </div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>}  <span class="comment">// end namespace sharp</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span><span class="preprocessor">#endif  </span><span class="comment">// SHARP_PARCEL_H</span></div>
<div class="ttc" id="aconstants_8h_html"><div class="ttname"><a href="constants_8h.html">constants.h</a></div><div class="ttdoc">Meteorological constants useful for computations with vertical atmospheric sounding profiles.</div></div>
<div class="ttc" id="ainterp_8h_html"><div class="ttname"><a href="interp_8h.html">interp.h</a></div><div class="ttdoc">Routines for linear interpolation of vertical atmospheric profiles.</div></div>
<div class="ttc" id="alayer_8h_html"><div class="ttname"><a href="layer_8h.html">layer.h</a></div><div class="ttdoc">Data structures and functions for performing operations over atmospheric layers.</div></div>
<div class="ttc" id="anamespacesharp_html"><div class="ttname"><a href="namespacesharp.html">sharp</a></div><div class="ttdef"><b>Definition:</b> <a href="algorithms_8h_source.html#l00020">algorithms.h:20</a></div></div>
<div class="ttc" id="anamespacesharp_html_a03664f85e552919899eefba1c4a7997f"><div class="ttname"><a href="namespacesharp.html#a03664f85e552919899eefba1c4a7997f">sharp::LPL</a></div><div class="ttdeci">LPL</div><div class="ttdoc">Enum that defines the lifted parcel level (LPL) of origin.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00195">parcel.h:195</a></div></div>
<div class="ttc" id="anamespacesharp_html_a03664f85e552919899eefba1c4a7997fa0f46ff8d6503905b6b729f2ec851079f"><div class="ttname"><a href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fa0f46ff8d6503905b6b729f2ec851079f">sharp::LPL::FCST</a></div><div class="ttdeci">@ FCST</div><div class="ttdoc">Forecast Surface Parcel.</div></div>
<div class="ttc" id="anamespacesharp_html_a03664f85e552919899eefba1c4a7997fa2b6cc9c30eaad9c109091ea928529cbd"><div class="ttname"><a href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fa2b6cc9c30eaad9c109091ea928529cbd">sharp::LPL::USR</a></div><div class="ttdeci">@ USR</div><div class="ttdoc">User-defined Parcel.</div></div>
<div class="ttc" id="anamespacesharp_html_a03664f85e552919899eefba1c4a7997fad01fd9b01e9dde8bd3dc247afbfb7218"><div class="ttname"><a href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fad01fd9b01e9dde8bd3dc247afbfb7218">sharp::LPL::ML</a></div><div class="ttdeci">@ ML</div><div class="ttdoc">Mixed Layer Parcel.</div></div>
<div class="ttc" id="anamespacesharp_html_a03664f85e552919899eefba1c4a7997fae5919ba9cf2e803bdbc98334a7f64daa"><div class="ttname"><a href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fae5919ba9cf2e803bdbc98334a7f64daa">sharp::LPL::MU</a></div><div class="ttdeci">@ MU</div><div class="ttdoc">Most Unstable Parcel.</div></div>
<div class="ttc" id="anamespacesharp_html_a03664f85e552919899eefba1c4a7997faf3385210bc009d67471bd739689779de"><div class="ttname"><a href="namespacesharp.html#a03664f85e552919899eefba1c4a7997faf3385210bc009d67471bd739689779de">sharp::LPL::SFC</a></div><div class="ttdeci">@ SFC</div><div class="ttdoc">Surface Based Parcel.</div></div>
<div class="ttc" id="anamespacesharp_html_a298e2c96c389f2c5177d3626c908927e"><div class="ttname"><a href="namespacesharp.html#a298e2c96c389f2c5177d3626c908927e">sharp::layer_mean</a></div><div class="ttdeci">float layer_mean(PressureLayer layer, const float pressure[], const float data_arr[], const std::ptrdiff_t N)</div><div class="ttdoc">Computes the mass-weighted mean value of a field over a given pressure layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00132">layer.cpp:132</a></div></div>
<div class="ttc" id="anamespacesharp_html_a46e2f332f68747fee1eb817f7bd3a00b"><div class="ttname"><a href="namespacesharp.html#a46e2f332f68747fee1eb817f7bd3a00b">sharp::virtual_temperature</a></div><div class="ttdeci">float virtual_temperature(float temperature, float rv, float rl=0.0f, float ri=0.0f)</div><div class="ttdoc">Compute the full virtual temperature.</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00171">thermo.cpp:171</a></div></div>
<div class="ttc" id="anamespacesharp_html_a5670844352aa7728286639ae3c43d351ab1a326c06d88bf042f73d70f50197905"><div class="ttname"><a href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab1a326c06d88bf042f73d70f50197905">sharp::LayerCoordinate::END</a></div><div class="ttdeci">@ END</div><div class="ttdoc">End value for range checking parameters.</div></div>
<div class="ttc" id="anamespacesharp_html_a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81"><div class="ttname"><a href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">sharp::LayerCoordinate::height</a></div><div class="ttdeci">@ height</div><div class="ttdoc">Height coordinate.</div></div>
<div class="ttc" id="anamespacesharp_html_a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093"><div class="ttname"><a href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">sharp::LayerCoordinate::pressure</a></div><div class="ttdeci">@ pressure</div><div class="ttdoc">Pressure coordinate.</div></div>
<div class="ttc" id="anamespacesharp_html_a90a9ae3f1a154cecbcf65d7dbf19233f"><div class="ttname"><a href="namespacesharp.html#a90a9ae3f1a154cecbcf65d7dbf19233f">sharp::temperature_at_mixratio</a></div><div class="ttdeci">float temperature_at_mixratio(float wv_mixratio, float pressure)</div><div class="ttdoc">Compute the temperature at a given water vapor mixing ratio and pressure level.</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00087">thermo.cpp:87</a></div></div>
<div class="ttc" id="anamespacesharp_html_aa258841692c25171d3f3b2e8b1f52079"><div class="ttname"><a href="namespacesharp.html#aa258841692c25171d3f3b2e8b1f52079">sharp::moist_adiabat_cm1</a></div><div class="ttdeci">float moist_adiabat_cm1(float pressure, float temperature, float new_pressure, float &amp;rv_total, float &amp;rv, float &amp;rl, float &amp;ri, float pres_incr, float converge, adiabat ma_type)</div><div class="ttdoc">Compute the temperature of a parcel lifted moist adiabatically to a new level.</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00302">thermo.cpp:302</a></div></div>
<div class="ttc" id="anamespacesharp_html_aae31e8a18568ec26222b603e629c5598"><div class="ttname"><a href="namespacesharp.html#aae31e8a18568ec26222b603e629c5598">sharp::buoyancy</a></div><div class="ttdeci">float buoyancy(const float pcl_temperature, const float env_temperature)</div><div class="ttdoc">compute buoyancy given parcel and environment temperatures</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00520">thermo.cpp:520</a></div></div>
<div class="ttc" id="anamespacesharp_html_ab4bb52918c53f75e2175d67840111600"><div class="ttname"><a href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">sharp::THETA_REF_PRESSURE</a></div><div class="ttdeci">static constexpr float THETA_REF_PRESSURE</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00034">constants.h:34</a></div></div>
<div class="ttc" id="anamespacesharp_html_ac38870166f07ac30aadbc46b81340cc4"><div class="ttname"><a href="namespacesharp.html#ac38870166f07ac30aadbc46b81340cc4">sharp::mixratio</a></div><div class="ttdeci">float mixratio(float q)</div><div class="ttdoc">Compute the water vapor mixing ratio from specific humidity.</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00122">thermo.cpp:122</a></div></div>
<div class="ttc" id="anamespacesharp_html_ac93f477dfa774c966b5da7521bd43ee6"><div class="ttname"><a href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">sharp::get_layer_index</a></div><div class="ttdeci">constexpr LayerIndex get_layer_index(L &amp;layer, const float coord[], const std::ptrdiff_t N, const Cb bottom_comp, const Ct top_comp)</div><div class="ttdoc">Returns the array indices corresponding to the given layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00174">layer.h:174</a></div></div>
<div class="ttc" id="anamespacesharp_html_acfd0143ab72871c4aabc95c1140ee8fb"><div class="ttname"><a href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">sharp::theta</a></div><div class="ttdeci">float theta(float pressure, float temperature, float ref_pressure=THETA_REF_PRESSURE)</div><div class="ttdoc">Compute the potential temperature.</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00112">thermo.cpp:112</a></div></div>
<div class="ttc" id="anamespacesharp_html_ad39fcd09ffea548c2aa8468c7d834d81"><div class="ttname"><a href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81">sharp::adiabat</a></div><div class="ttdeci">adiabat</div><div class="ttdoc">Defines the kinds of moist adiabats used by sharp::moist_adiabat_cm1.</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8h_source.html#l00029">thermo.h:29</a></div></div>
<div class="ttc" id="anamespacesharp_html_ad39fcd09ffea548c2aa8468c7d834d81a2950b2ab4ab4c2d385ff16dfae8003c0"><div class="ttname"><a href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81a2950b2ab4ab4c2d385ff16dfae8003c0">sharp::adiabat::pseudo_liq</a></div><div class="ttdeci">@ pseudo_liq</div><div class="ttdoc">Pseudoadiabatic considering only liquid water.</div></div>
<div class="ttc" id="anamespacesharp_html_ad4014313c60a66a321e4050a2a07058e"><div class="ttname"><a href="namespacesharp.html#ad4014313c60a66a321e4050a2a07058e">sharp::wetlift</a></div><div class="ttdeci">float wetlift(float pressure, float temperature, float lifted_pressure)</div><div class="ttdoc">Compute the temperature of a parcel lifted moist adiabatically to a new level.</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00217">thermo.cpp:217</a></div></div>
<div class="ttc" id="anamespacesharp_html_ae4385866921cd7286946d9ffdd65c25e"><div class="ttname"><a href="namespacesharp.html#ae4385866921cd7286946d9ffdd65c25e">sharp::drylift</a></div><div class="ttdeci">void drylift(float pressure, float temperature, float dewpoint, float &amp;pressure_at_lcl, float &amp;temperature_at_lcl)</div><div class="ttdoc">Lift a parcel dry adiabatically to its Lifted Condensation Level (LCL).</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00365">thermo.cpp:365</a></div></div>
<div class="ttc" id="anamespacesharp_html_ae8240f026498ad2775633a8d0dcf100d"><div class="ttname"><a href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">sharp::interp_height</a></div><div class="ttdeci">float interp_height(const float height_val, const float height_arr[], const float data_arr[], const std::ptrdiff_t N)</div><div class="ttdoc">Linearly interpolate a data field to a requested height level.</div><div class="ttdef"><b>Definition:</b> <a href="interp_8cpp_source.html#l00024">interp.cpp:24</a></div></div>
<div class="ttc" id="anamespacesharp_html_af2ffcc858ff03be6e2ae2fe2ee20040d"><div class="ttname"><a href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">sharp::MISSING</a></div><div class="ttdeci">static constexpr float MISSING</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00036">constants.h:36</a></div></div>
<div class="ttc" id="astructsharp_1_1LayerIndex_html"><div class="ttname"><a href="structsharp_1_1LayerIndex.html">sharp::LayerIndex</a></div><div class="ttdoc">A simple structure of two named integer indices for the top and bottom of a layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00131">layer.h:131</a></div></div>
<div class="ttc" id="astructsharp_1_1LayerIndex_html_a29cd85832f403659b88daab19abac1ca"><div class="ttname"><a href="structsharp_1_1LayerIndex.html#a29cd85832f403659b88daab19abac1ca">sharp::LayerIndex::kbot</a></div><div class="ttdeci">std::ptrdiff_t kbot</div><div class="ttdoc">The array index of the bottom of the layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00135">layer.h:135</a></div></div>
<div class="ttc" id="astructsharp_1_1LayerIndex_html_a849a04de93753261c91c58b590e60ee2"><div class="ttname"><a href="structsharp_1_1LayerIndex.html#a849a04de93753261c91c58b590e60ee2">sharp::LayerIndex::ktop</a></div><div class="ttdeci">std::ptrdiff_t ktop</div><div class="ttdoc">The array index of the top of the layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00140">layer.h:140</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html"><div class="ttname"><a href="structsharp_1_1Parcel.html">sharp::Parcel</a></div><div class="ttdoc">Data that defines a Parcel, its attributes, and derived quantities.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00232">parcel.h:232</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_a0560bd193b2d2d6bc6b08baa7463fba4"><div class="ttname"><a href="structsharp_1_1Parcel.html#a0560bd193b2d2d6bc6b08baa7463fba4">sharp::Parcel::cape_cinh</a></div><div class="ttdeci">void cape_cinh(const float pres_arr[], const float hght_arr[], const float buoy_arr[], const std::ptrdiff_t N)</div><div class="ttdoc">Compute CAPE and CINH for a previously lifted sharp::Parcel.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8cpp_source.html#l00148">parcel.cpp:148</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_a1bf670e79f35a1ce8c904b7ead32ccbe"><div class="ttname"><a href="structsharp_1_1Parcel.html#a1bf670e79f35a1ce8c904b7ead32ccbe">sharp::Parcel::mixed_layer_parcel</a></div><div class="ttdeci">static Parcel mixed_layer_parcel(Lyr &amp;mix_layer, const float pressure[], const float height[], const float pot_temperature[], const float wv_mixratio[], const std::ptrdiff_t N) noexcept</div><div class="ttdoc">Construct and return a mixed-layer Parcel.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00438">parcel.h:438</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_a4141b5aa7889103f11e031be28545f4d"><div class="ttname"><a href="structsharp_1_1Parcel.html#a4141b5aa7889103f11e031be28545f4d">sharp::Parcel::Parcel</a></div><div class="ttdeci">Parcel()</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8cpp_source.html#l00021">parcel.cpp:21</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_a43773542f542f0fb4a2c85bd71a39cb8"><div class="ttname"><a href="structsharp_1_1Parcel.html#a43773542f542f0fb4a2c85bd71a39cb8">sharp::Parcel::source</a></div><div class="ttdeci">LPL source</div><div class="ttdoc">The type of parcel this is.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00277">parcel.h:277</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_a55dcb9c777b42c5f35537730c044e004"><div class="ttname"><a href="structsharp_1_1Parcel.html#a55dcb9c777b42c5f35537730c044e004">sharp::Parcel::lfc_pressure</a></div><div class="ttdeci">float lfc_pressure</div><div class="ttdoc">Pressure at the Level of Free Convection (Pa)</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00256">parcel.h:256</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_a8a311e09b1d46a829212da94cf181537"><div class="ttname"><a href="structsharp_1_1Parcel.html#a8a311e09b1d46a829212da94cf181537">sharp::Parcel::find_lfc_el</a></div><div class="ttdeci">void find_lfc_el(const float pres_arr[], const float hght_arr[], const float buoy_arr[], const std::ptrdiff_t N)</div><div class="ttdoc">Find the LFC and EL that bounds the layer with the maximum CAPE.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8cpp_source.html#l00076">parcel.cpp:76</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_a9523de2b8b4c28ca49fba3013f94cb06"><div class="ttname"><a href="structsharp_1_1Parcel.html#a9523de2b8b4c28ca49fba3013f94cb06">sharp::Parcel::lift_parcel</a></div><div class="ttdeci">void lift_parcel(Lft &amp;liftpcl, const float pressure_arr[], float pcl_vtmpk_arr[], const std::ptrdiff_t N)</div><div class="ttdoc">Lifts a sharp::Parcel to compute its virtual temperature.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00300">parcel.h:300</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_aa1b370d9ea08877cc6438241fd013e3a"><div class="ttname"><a href="structsharp_1_1Parcel.html#aa1b370d9ea08877cc6438241fd013e3a">sharp::Parcel::surface_parcel</a></div><div class="ttdeci">static Parcel surface_parcel(const float pressure, const float temperature, const float dewpoint) noexcept</div><div class="ttdoc">Construct and return a surface-based Parcel.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00412">parcel.h:412</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_aa258d27992d22d8b80cb221e6e2a6c19"><div class="ttname"><a href="structsharp_1_1Parcel.html#aa258d27992d22d8b80cb221e6e2a6c19">sharp::Parcel::most_unstable_parcel</a></div><div class="ttdeci">static Parcel most_unstable_parcel(Lyr &amp;search_layer, Lft &amp;lifter, const float pressure[], const float height[], const float temperature[], const float virtemp[], const float dewpoint[], float pcl_virtemp[], float buoy_arr[], const std::ptrdiff_t N) noexcept</div><div class="ttdoc">Construct and return a most-unstable Parcel.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00486">parcel.h:486</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_abd477130779ca88ce737770fb7a0b748"><div class="ttname"><a href="structsharp_1_1Parcel.html#abd477130779ca88ce737770fb7a0b748">sharp::Parcel::tmpk</a></div><div class="ttdeci">float tmpk</div><div class="ttdoc">Parcel starting temperature (K)</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00241">parcel.h:241</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_abe6f9e3ee98fde1d361814a5d6384b1a"><div class="ttname"><a href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">sharp::Parcel::cape</a></div><div class="ttdeci">float cape</div><div class="ttdoc">Parcel Convective Available Potential Energy (J/kg) between the LFC and EL.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00267">parcel.h:267</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_ac76710675fd2f495d52ac35d0d1de246"><div class="ttname"><a href="structsharp_1_1Parcel.html#ac76710675fd2f495d52ac35d0d1de246">sharp::Parcel::eql_pressure</a></div><div class="ttdeci">float eql_pressure</div><div class="ttdoc">Pressure at the parcel Equilibrium Level (Pa)</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00261">parcel.h:261</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_acdce27acf6bd8a327993f5d4cf240906"><div class="ttname"><a href="structsharp_1_1Parcel.html#acdce27acf6bd8a327993f5d4cf240906">sharp::Parcel::pres</a></div><div class="ttdeci">float pres</div><div class="ttdoc">Parcel starting pressure (Pa)</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00236">parcel.h:236</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_ae4798e73dc979eb1bf00d7057ed7eea0"><div class="ttname"><a href="structsharp_1_1Parcel.html#ae4798e73dc979eb1bf00d7057ed7eea0">sharp::Parcel::lcl_pressure</a></div><div class="ttdeci">float lcl_pressure</div><div class="ttdoc">Pressure at the Lifted Condensation Level (Pa)</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00251">parcel.h:251</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_aec26ccd19be00c0c3368b416bee1cd61"><div class="ttname"><a href="structsharp_1_1Parcel.html#aec26ccd19be00c0c3368b416bee1cd61">sharp::Parcel::dwpk</a></div><div class="ttdeci">float dwpk</div><div class="ttdoc">Parcel starting dewpoint (K)</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00246">parcel.h:246</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_af2f4106c560b37ed8d13c3f272fa68a4"><div class="ttname"><a href="structsharp_1_1Parcel.html#af2f4106c560b37ed8d13c3f272fa68a4">sharp::Parcel::cinh</a></div><div class="ttdeci">float cinh</div><div class="ttdoc">Parcel Convective Inhibition (J/kg) between the LFC and EL.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00272">parcel.h:272</a></div></div>
<div class="ttc" id="astructsharp_1_1PressureLayer_html"><div class="ttname"><a href="structsharp_1_1PressureLayer.html">sharp::PressureLayer</a></div><div class="ttdoc">A simple structure of two named floats that represent a pressure layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00093">layer.h:93</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__cm1_html"><div class="ttname"><a href="structsharp_1_1lifter__cm1.html">sharp::lifter_cm1</a></div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00086">parcel.h:86</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__cm1_html_a14991ad94ae6bac4421a2a7f3f9a5e4c"><div class="ttname"><a href="structsharp_1_1lifter__cm1.html#a14991ad94ae6bac4421a2a7f3f9a5e4c">sharp::lifter_cm1::pressure_incr</a></div><div class="ttdeci">float pressure_incr</div><div class="ttdoc">The pressure increment (Pa) to use for the iterative solver.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00119">parcel.h:119</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__cm1_html_a1758f1feeedd42ff248ad6b55cbde000"><div class="ttname"><a href="structsharp_1_1lifter__cm1.html#a1758f1feeedd42ff248ad6b55cbde000">sharp::lifter_cm1::rv_total</a></div><div class="ttdeci">float rv_total</div><div class="ttdoc">Used to keep track of mixing ratio for conserved/adiabatic lifting.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00091">parcel.h:91</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__cm1_html_a2eeb5b118ef40e873c09ac9b3635f7b9"><div class="ttname"><a href="structsharp_1_1lifter__cm1.html#a2eeb5b118ef40e873c09ac9b3635f7b9">sharp::lifter_cm1::operator()</a></div><div class="ttdeci">float operator()(const float pres, const float tmpk, const float new_pres)</div><div class="ttdoc">Overloads operator() to call sharp::moist_adiabat_cm1.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00150">parcel.h:150</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__cm1_html_a2fc203010e232bd969ac0b09f15c4329"><div class="ttname"><a href="structsharp_1_1lifter__cm1.html#a2fc203010e232bd969ac0b09f15c4329">sharp::lifter_cm1::parcel_virtual_temperature</a></div><div class="ttdeci">float parcel_virtual_temperature(const float pres, const float tmpk) const</div><div class="ttdoc">Computes the virtual temperature of the parcel.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00164">parcel.h:164</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__cm1_html_a4750e359411eefdfb6d4970052637750"><div class="ttname"><a href="structsharp_1_1lifter__cm1.html#a4750e359411eefdfb6d4970052637750">sharp::lifter_cm1::setup</a></div><div class="ttdeci">void setup(const float lcl_pres, const float lcl_tmpk)</div><div class="ttdoc">perform the necessary setup for parcel ascent.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00134">parcel.h:134</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__cm1_html_a4ae0d7ec453ae9489643f8ff57cf8139"><div class="ttname"><a href="structsharp_1_1lifter__cm1.html#a4ae0d7ec453ae9489643f8ff57cf8139">sharp::lifter_cm1::rl</a></div><div class="ttdeci">float rl</div><div class="ttdoc">Liquid water mixing ratio variable updated during parcel lifts.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00101">parcel.h:101</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__cm1_html_a4cdf7ebf0718b56fba138b928b559182"><div class="ttname"><a href="structsharp_1_1lifter__cm1.html#a4cdf7ebf0718b56fba138b928b559182">sharp::lifter_cm1::rv</a></div><div class="ttdeci">float rv</div><div class="ttdoc">Water vapor mixing ratio variable updated during parcel lifts.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00096">parcel.h:96</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__cm1_html_a645233f46f93344a4050118a3fcd0c9c"><div class="ttname"><a href="structsharp_1_1lifter__cm1.html#a645233f46f93344a4050118a3fcd0c9c">sharp::lifter_cm1::converge</a></div><div class="ttdeci">float converge</div><div class="ttdoc">The iterative convergence criteria (K)</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00124">parcel.h:124</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__cm1_html_aaa41a6bdf1541d95e19f8a56d39c8865"><div class="ttname"><a href="structsharp_1_1lifter__cm1.html#aaa41a6bdf1541d95e19f8a56d39c8865">sharp::lifter_cm1::ri</a></div><div class="ttdeci">float ri</div><div class="ttdoc">Ice water mixing ratio variable updated during parcel lifts.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00106">parcel.h:106</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__cm1_html_ae46c58cea6eb213e69cefa910b897538"><div class="ttname"><a href="structsharp_1_1lifter__cm1.html#ae46c58cea6eb213e69cefa910b897538">sharp::lifter_cm1::ma_type</a></div><div class="ttdeci">adiabat ma_type</div><div class="ttdoc">The type of moist adiabat to use, as defined by sharp::adiabat.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00114">parcel.h:114</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__cm1_html_ae9db9fdbbb833b32bcae1044a21c9040"><div class="ttname"><a href="structsharp_1_1lifter__cm1.html#ae9db9fdbbb833b32bcae1044a21c9040">sharp::lifter_cm1::lift_from_lcl</a></div><div class="ttdeci">static constexpr bool lift_from_lcl</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00109">parcel.h:109</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__wobus_html"><div class="ttname"><a href="structsharp_1_1lifter__wobus.html">sharp::lifter_wobus</a></div><div class="ttdoc">A functor that calls the Wobus Wetlift funtion.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00046">parcel.h:46</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__wobus_html_a82be5bdfdff54890488bbc1461b5b05e"><div class="ttname"><a href="structsharp_1_1lifter__wobus.html#a82be5bdfdff54890488bbc1461b5b05e">sharp::lifter_wobus::parcel_virtual_temperature</a></div><div class="ttdeci">float parcel_virtual_temperature(const float pres, const float tmpk) const</div><div class="ttdoc">Computes the virtual temperature of the parcel.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00080">parcel.h:80</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__wobus_html_a92ffe04c0425aef07c524759d799066e"><div class="ttname"><a href="structsharp_1_1lifter__wobus.html#a92ffe04c0425aef07c524759d799066e">sharp::lifter_wobus::operator()</a></div><div class="ttdeci">float operator()(const float pres, const float tmpk, const float new_pres) const</div><div class="ttdoc">Overloads operator() to call sharp::wetlift.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00068">parcel.h:68</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__wobus_html_ad3b54dc77d2e28f97155f7522b7972df"><div class="ttname"><a href="structsharp_1_1lifter__wobus.html#ad3b54dc77d2e28f97155f7522b7972df">sharp::lifter_wobus::lift_from_lcl</a></div><div class="ttdeci">static constexpr bool lift_from_lcl</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00047">parcel.h:47</a></div></div>
<div class="ttc" id="astructsharp_1_1lifter__wobus_html_aff7ac3dd393ccac49f491014ffa09f57"><div class="ttname"><a href="structsharp_1_1lifter__wobus.html#aff7ac3dd393ccac49f491014ffa09f57">sharp::lifter_wobus::setup</a></div><div class="ttdeci">void setup(const float lcl_pres, const float lcl_tmpk) const</div><div class="ttdoc">Perform the setup step for the parcel lifter.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00057">parcel.h:57</a></div></div>
<div class="ttc" id="athermo_8h_html"><div class="ttname"><a href="thermo_8h.html">thermo.h</a></div><div class="ttdoc">Routines used to compute thermodynamic attributes of vertical sounding profiles.</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_7ce3d2b4aae460fa2df4568caeccd03d.html">SHARPlib</a></li><li class="navelem"><a class="el" href="parcel_8h.html">parcel.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
