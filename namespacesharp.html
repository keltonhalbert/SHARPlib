<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<title>SPC Sounding and Hodoraph Analysis and Research Program Calculation Library: sharp Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
   DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SPC Sounding and Hodoraph Analysis and Research Program Calculation Library
   &#160;<span id="projectnumber">1.0.0 Preview</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacesharp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">sharp Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacesharp_1_1exper"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp_1_1exper.html">exper</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A simple structure of named floats that represent a height layer.  <a href="structsharp_1_1HeightLayer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsharp_1_1LayerIndex.html">LayerIndex</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A simple structure of two named integer indices for the top and bottom of a layer.  <a href="structsharp_1_1LayerIndex.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsharp_1_1lifter__cm1.html">lifter_cm1</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsharp_1_1lifter__wobus.html">lifter_wobus</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A functor that calls the Wobus Wetlift funtion.  <a href="structsharp_1_1lifter__wobus.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsharp_1_1Parcel.html">Parcel</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data that defines a <a class="el" href="structsharp_1_1Parcel.html" title="Data that defines a Parcel, its attributes, and derived quantities.">Parcel</a>, its attributes, and derived quantities.  <a href="structsharp_1_1Parcel.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A simple structure of two named floats that represent a pressure layer.  <a href="structsharp_1_1PressureLayer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A simple structure of two names floats that represent the components of a wind vector.  <a href="structsharp_1_1WindComponents.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsharp_1_1WindVector.html">WindVector</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A simple structure of two named floats that represent a wind vector.  <a href="structsharp_1_1WindVector.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a5670844352aa7728286639ae3c43d351"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351">LayerCoordinate</a> { <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a> = 0
, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a> = 1
, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab1a326c06d88bf042f73d70f50197905">END</a>
 }</td></tr>
<tr class="memdesc:a5670844352aa7728286639ae3c43d351"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enum defining the coordinate system of a layer.  <a href="namespacesharp.html#a5670844352aa7728286639ae3c43d351">More...</a><br /></td></tr>
<tr class="separator:a5670844352aa7728286639ae3c43d351"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03664f85e552919899eefba1c4a7997f"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997f">LPL</a> : int { <br />
&#160;&#160;<a class="el" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997faf3385210bc009d67471bd739689779de">SFC</a> = 1
, <a class="el" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fa0f46ff8d6503905b6b729f2ec851079f">FCST</a> = 2
, <a class="el" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fae5919ba9cf2e803bdbc98334a7f64daa">MU</a> = 3
, <a class="el" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fad01fd9b01e9dde8bd3dc247afbfb7218">ML</a> = 4
, <br />
&#160;&#160;<a class="el" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fa2b6cc9c30eaad9c109091ea928529cbd">USR</a> = 5
, <a class="el" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fab1a326c06d88bf042f73d70f50197905">END</a>
<br />
 }</td></tr>
<tr class="memdesc:a03664f85e552919899eefba1c4a7997f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enum that defines the lifted parcel level (LPL) of origin.  <a href="namespacesharp.html#a03664f85e552919899eefba1c4a7997f">More...</a><br /></td></tr>
<tr class="separator:a03664f85e552919899eefba1c4a7997f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad39fcd09ffea548c2aa8468c7d834d81"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81">adiabat</a> : int { <br />
&#160;&#160;<a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81a2950b2ab4ab4c2d385ff16dfae8003c0">pseudo_liq</a> = 1
, <a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81ab7604476f4061e16c1a5abd1bf70bcb4">adiab_liq</a> = 2
, <a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81ad4a63946bf6f9aa1165238e71094024a">pseudo_ice</a> = 3
, <a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81a8c43e5a2312127e6576ccd8030da6692">adiab_ice</a> = 4
, <br />
&#160;&#160;<a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81ab1a326c06d88bf042f73d70f50197905">END</a>
<br />
 }</td></tr>
<tr class="memdesc:ad39fcd09ffea548c2aa8468c7d834d81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the kinds of moist adiabats used by <a class="el" href="namespacesharp.html#aa258841692c25171d3f3b2e8b1f52079" title="Compute the temperature of a parcel lifted moist adiabatically to a new level.">sharp::moist_adiabat_cm1</a>.  <a href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81">More...</a><br /></td></tr>
<tr class="separator:ad39fcd09ffea548c2aa8468c7d834d81"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1edcf8bff9a13429bcbff7c1129024b3"><td class="memTemplParams" colspan="2">template&lt;typename T , typename C  = std::less&lt;&gt;&gt; </td></tr>
<tr class="memitem:a1edcf8bff9a13429bcbff7c1129024b3"><td class="memTemplItemLeft" align="right" valign="top">constexpr std::ptrdiff_t&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a1edcf8bff9a13429bcbff7c1129024b3">lower_bound</a> (const T array[], const std::ptrdiff_t N, const T value, const C cmp=C{})</td></tr>
<tr class="memdesc:a1edcf8bff9a13429bcbff7c1129024b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the index of the lower bound that does not satisfy element &lt; value.  <br /></td></tr>
<tr class="separator:a1edcf8bff9a13429bcbff7c1129024b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a772686549a5111c1152b778731119aa6"><td class="memTemplParams" colspan="2">template&lt;typename T , typename C  = std::less&lt;&gt;&gt; </td></tr>
<tr class="memitem:a772686549a5111c1152b778731119aa6"><td class="memTemplItemLeft" align="right" valign="top">constexpr std::ptrdiff_t&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a772686549a5111c1152b778731119aa6">upper_bound</a> (const T array[], const std::ptrdiff_t N, const T value, const C cmp=C{})</td></tr>
<tr class="memdesc:a772686549a5111c1152b778731119aa6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the first index that satisfies value &lt; element.  <br /></td></tr>
<tr class="separator:a772686549a5111c1152b778731119aa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3558a68454edd4679ef97335e3a9f1fb"><td class="memTemplParams" colspan="2">template&lt;typename _T &gt; </td></tr>
<tr class="memitem:a3558a68454edd4679ef97335e3a9f1fb"><td class="memTemplItemLeft" align="right" valign="top">constexpr _T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a3558a68454edd4679ef97335e3a9f1fb">_integ_trapz</a> (_T var_top, _T var_bottom, _T coord_top, _T coord_bottom, _T &amp;weights, const bool weighted=false)</td></tr>
<tr class="memdesc:a3558a68454edd4679ef97335e3a9f1fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">A kernel that computes the area under a curve using the trapezoidal rule.  <br /></td></tr>
<tr class="separator:a3558a68454edd4679ef97335e3a9f1fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4464059524ff56c7974141bb4cc7375"><td class="memTemplParams" colspan="2">template&lt;typename _Fp &gt; </td></tr>
<tr class="memitem:ac4464059524ff56c7974141bb4cc7375"><td class="memTemplItemLeft" align="right" valign="top">constexpr _Fp&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ac4464059524ff56c7974141bb4cc7375">__lerp</a> (const _Fp __a, const _Fp __b, const _Fp __t)</td></tr>
<tr class="memdesc:ac4464059524ff56c7974141bb4cc7375"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linearly interpolates between a and b with distance t.  <br /></td></tr>
<tr class="separator:ac4464059524ff56c7974141bb4cc7375"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bf533560780fdb77bc3656db8d89208"><td class="memItemLeft" align="right" valign="top">constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a0bf533560780fdb77bc3656db8d89208">lerp</a> (const float __a, const float __b, const float __t)</td></tr>
<tr class="memdesc:a0bf533560780fdb77bc3656db8d89208"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linearly interpolates between a and b with distance t.  <br /></td></tr>
<tr class="separator:a0bf533560780fdb77bc3656db8d89208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8240f026498ad2775633a8d0dcf100d"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a> (const float height_val, const float height_arr[], const float data_arr[], const std::ptrdiff_t N)</td></tr>
<tr class="memdesc:ae8240f026498ad2775633a8d0dcf100d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linearly interpolate a data field to a requested height level.  <br /></td></tr>
<tr class="separator:ae8240f026498ad2775633a8d0dcf100d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55e4f8ee4ff8a4a30d7b3f3d92a41c75"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure</a> (const float pressure_val, const float pressure_arr[], const float data_arr[], const std::ptrdiff_t N)</td></tr>
<tr class="memdesc:a55e4f8ee4ff8a4a30d7b3f3d92a41c75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linearly interpolate a data field to a requested pressure level.  <br /></td></tr>
<tr class="separator:a55e4f8ee4ff8a4a30d7b3f3d92a41c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac93f477dfa774c966b5da7521bd43ee6"><td class="memTemplParams" colspan="2">template&lt;typename L , typename Cb , typename Ct &gt; </td></tr>
<tr class="memitem:ac93f477dfa774c966b5da7521bd43ee6"><td class="memTemplItemLeft" align="right" valign="top">constexpr <a class="el" href="structsharp_1_1LayerIndex.html">LayerIndex</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index</a> (L &amp;layer, const float coord[], const std::ptrdiff_t N, const Cb bottom_comp, const Ct top_comp)</td></tr>
<tr class="memdesc:ac93f477dfa774c966b5da7521bd43ee6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the array indices corresponding to the given layer.  <br /></td></tr>
<tr class="separator:ac93f477dfa774c966b5da7521bd43ee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2f381378ac4ec13ad83d2ec92b2abcc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1LayerIndex.html">LayerIndex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ac2f381378ac4ec13ad83d2ec92b2abcc">get_layer_index</a> (<a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> &amp;layer, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const std::ptrdiff_t N)</td></tr>
<tr class="memdesc:ac2f381378ac4ec13ad83d2ec92b2abcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the array indices corresponding to the given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>.  <br /></td></tr>
<tr class="separator:ac2f381378ac4ec13ad83d2ec92b2abcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a8e42ed2ba834a1436242e320492bbc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1LayerIndex.html">LayerIndex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a4a8e42ed2ba834a1436242e320492bbc">get_layer_index</a> (<a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a> &amp;layer, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const std::ptrdiff_t N)</td></tr>
<tr class="memdesc:a4a8e42ed2ba834a1436242e320492bbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the array indices corresponding to the given <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>.  <br /></td></tr>
<tr class="separator:a4a8e42ed2ba834a1436242e320492bbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab77e344c7462c9615b0ddac228bc2193"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ab77e344c7462c9615b0ddac228bc2193">height_layer_to_pressure</a> (<a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a> layer, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const std::ptrdiff_t N, const bool isAGL=false)</td></tr>
<tr class="memdesc:ab77e344c7462c9615b0ddac228bc2193"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a> to a <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>.  <br /></td></tr>
<tr class="separator:ab77e344c7462c9615b0ddac228bc2193"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31da980f398c9f6a5960ddf868101a94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a31da980f398c9f6a5960ddf868101a94">pressure_layer_to_height</a> (<a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> layer, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const std::ptrdiff_t N, const bool toAGL=false)</td></tr>
<tr class="memdesc:a31da980f398c9f6a5960ddf868101a94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> to a <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>.  <br /></td></tr>
<tr class="separator:a31da980f398c9f6a5960ddf868101a94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a646b65095b84511b75f6a4a81e545e80"><td class="memTemplParams" colspan="2">template&lt;typename L , typename C &gt; </td></tr>
<tr class="memitem:a646b65095b84511b75f6a4a81e545e80"><td class="memTemplItemLeft" align="right" valign="top">constexpr float&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a646b65095b84511b75f6a4a81e545e80">layer_minmax</a> (L layer, const float coord_arr[], const float data_arr[], const std::ptrdiff_t N, float *lvl_min_or_max, const C comp)</td></tr>
<tr class="memdesc:a646b65095b84511b75f6a4a81e545e80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Template for min/max value over <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> or <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>.  <br /></td></tr>
<tr class="separator:a646b65095b84511b75f6a4a81e545e80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01a9880c937f63e551893797253da4f7"><td class="memTemplParams" colspan="2">template&lt;typename L &gt; </td></tr>
<tr class="memitem:a01a9880c937f63e551893797253da4f7"><td class="memTemplItemLeft" align="right" valign="top">constexpr float&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a01a9880c937f63e551893797253da4f7">layer_min</a> (L layer, const float coord_arr[], const float data_arr[], const std::ptrdiff_t N, float *lvl_of_min=nullptr)</td></tr>
<tr class="memdesc:a01a9880c937f63e551893797253da4f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the minimum value in the given layer.  <br /></td></tr>
<tr class="separator:a01a9880c937f63e551893797253da4f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6170e3f412ab95b3ba8d9a93ae55dc67"><td class="memTemplParams" colspan="2">template&lt;typename L &gt; </td></tr>
<tr class="memitem:a6170e3f412ab95b3ba8d9a93ae55dc67"><td class="memTemplItemLeft" align="right" valign="top">constexpr float&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a6170e3f412ab95b3ba8d9a93ae55dc67">layer_max</a> (L layer, const float coord_arr[], const float data_arr[], const std::ptrdiff_t N, float *lvl_of_max=nullptr)</td></tr>
<tr class="memdesc:a6170e3f412ab95b3ba8d9a93ae55dc67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the maximim value in the given layer.  <br /></td></tr>
<tr class="separator:a6170e3f412ab95b3ba8d9a93ae55dc67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7acec1642f27591dc988bf9e48b4612d"><td class="memTemplParams" colspan="2">template&lt;typename L &gt; </td></tr>
<tr class="memitem:a7acec1642f27591dc988bf9e48b4612d"><td class="memTemplItemLeft" align="right" valign="top">float&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">integrate_layer_trapz</a> (L layer, const float var_array[], const float coord_array[], const std::ptrdiff_t N, const int integ_sign=0, const bool weighted=false)</td></tr>
<tr class="memdesc:a7acec1642f27591dc988bf9e48b4612d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a trapezoidal integration of the given layer.  <br /></td></tr>
<tr class="separator:a7acec1642f27591dc988bf9e48b4612d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a298e2c96c389f2c5177d3626c908927e"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a298e2c96c389f2c5177d3626c908927e">layer_mean</a> (<a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> layer, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const float data_arr[], const std::ptrdiff_t N)</td></tr>
<tr class="memdesc:a298e2c96c389f2c5177d3626c908927e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the mass-weighted mean value of a field over a given pressure layer.  <br /></td></tr>
<tr class="separator:a298e2c96c389f2c5177d3626c908927e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0726266b4777806bae4e8054e01684c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#aa0726266b4777806bae4e8054e01684c">layer_mean</a> (<a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a> layer, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const float data_arr[], const std::ptrdiff_t N, const bool isAGL=false)</td></tr>
<tr class="memdesc:aa0726266b4777806bae4e8054e01684c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the mass-weighted mean value of a field over a given height layer.  <br /></td></tr>
<tr class="separator:aa0726266b4777806bae4e8054e01684c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e6b7cd4a3594a8f2c2050b0e4784cce"><td class="memTemplParams" colspan="2">template&lt;typename Lifter &gt; </td></tr>
<tr class="memitem:a2e6b7cd4a3594a8f2c2050b0e4784cce"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a2e6b7cd4a3594a8f2c2050b0e4784cce">effective_inflow_layer</a> (Lifter &amp;lifter, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const float temperature[], const float dewpoint[], const float virtemp_arr[], float pcl_vtmpk_arr[], float buoy_arr[], const std::ptrdiff_t N, const float cape_thresh=100.0, const float cinh_thresh=-250.0, <a class="el" href="structsharp_1_1Parcel.html">Parcel</a> *mupcl=nullptr)</td></tr>
<tr class="memdesc:a2e6b7cd4a3594a8f2c2050b0e4784cce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the Effective Inflow Layer for a given atmospheric sounding.  <br /></td></tr>
<tr class="separator:a2e6b7cd4a3594a8f2c2050b0e4784cce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74a735636c932467b4d2ced544e0cb51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">storm_motion_bunkers</a> (const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const float u_wind[], const float v_wind[], const std::ptrdiff_t N, <a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a> mean_wind_layer_agl, <a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a> wind_shear_layer_agl, const bool leftMover=false, const bool pressureWeighted=false)</td></tr>
<tr class="memdesc:a74a735636c932467b4d2ced544e0cb51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates supercell storm motion using the Bunkers et al. 2000 method.  <br /></td></tr>
<tr class="separator:a74a735636c932467b4d2ced544e0cb51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab31d383a3231f8fef873e5a16c0db856"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ab31d383a3231f8fef873e5a16c0db856">storm_motion_bunkers</a> (const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const float u_wind[], const float v_wind[], const std::ptrdiff_t N, <a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> eff_infl_lyr, const <a class="el" href="structsharp_1_1Parcel.html">Parcel</a> *mupcl, const bool leftMover=false)</td></tr>
<tr class="memdesc:ab31d383a3231f8fef873e5a16c0db856"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates supercell storm motion by using the Bunkers et al. 2014 method.  <br /></td></tr>
<tr class="separator:ab31d383a3231f8fef873e5a16c0db856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72bbdc4cfe7895dd51981902ac9fc822"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape</a> (const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const float temperature[], const float mse_arr[], const float u_wind[], const float v_wind[], const std::ptrdiff_t N, <a class="el" href="structsharp_1_1Parcel.html">Parcel</a> *pcl)</td></tr>
<tr class="memdesc:a72bbdc4cfe7895dd51981902ac9fc822"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes Entrainment CAPE using a previously lifted parcel.  <br /></td></tr>
<tr class="separator:a72bbdc4cfe7895dd51981902ac9fc822"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab89a7e3555a52f0fd9f4086d5aba7037"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ab89a7e3555a52f0fd9f4086d5aba7037">energy_helicity_index</a> (float cape, float <a class="el" href="namespacesharp.html#a80858337a63be77bafadbb343d6e4931">helicity</a>)</td></tr>
<tr class="separator:ab89a7e3555a52f0fd9f4086d5aba7037"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d1cb8e1918ad656aceef6a512151483"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a7d1cb8e1918ad656aceef6a512151483">supercell_composite_parameter</a> (float mu_cape, float eff_srh, float eff_shear)</td></tr>
<tr class="separator:a7d1cb8e1918ad656aceef6a512151483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eeef5c5c9f1cbe1736996eaf8fe9ae5"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a6eeef5c5c9f1cbe1736996eaf8fe9ae5">significant_tornado_parameter</a> (<a class="el" href="structsharp_1_1Parcel.html">Parcel</a> pcl, float lcl_hght_agl, float storm_relative_helicity, float bulk_wind_difference)</td></tr>
<tr class="separator:a6eeef5c5c9f1cbe1736996eaf8fe9ae5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab535b8214969a50771219a275ebb7f4d"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ab535b8214969a50771219a275ebb7f4d">wobf</a> (float temperature)</td></tr>
<tr class="memdesc:ab535b8214969a50771219a275ebb7f4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the difference between the wet-bulb potential temperatures for saturated and dry air given the temperature.  <br /></td></tr>
<tr class="separator:ab535b8214969a50771219a275ebb7f4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e31a1a145fc25f07d6326481993b2c2"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a3e31a1a145fc25f07d6326481993b2c2">vapor_pressure</a> (float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature)</td></tr>
<tr class="memdesc:a3e31a1a145fc25f07d6326481993b2c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the vapor pressure over liquid water.  <br /></td></tr>
<tr class="separator:a3e31a1a145fc25f07d6326481993b2c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf448e4ec9a4f7ac7edc9b960f656fd8"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#aaf448e4ec9a4f7ac7edc9b960f656fd8">vapor_pressure_ice</a> (float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature)</td></tr>
<tr class="memdesc:aaf448e4ec9a4f7ac7edc9b960f656fd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the vapor pressure over ice.  <br /></td></tr>
<tr class="separator:aaf448e4ec9a4f7ac7edc9b960f656fd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af016701e4a46d5c04d26c0a09c0aad38"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#af016701e4a46d5c04d26c0a09c0aad38">lcl_temperature</a> (float temperature, float dewpoint)</td></tr>
<tr class="memdesc:af016701e4a46d5c04d26c0a09c0aad38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the temperature of the LCL.  <br /></td></tr>
<tr class="separator:af016701e4a46d5c04d26c0a09c0aad38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90a9ae3f1a154cecbcf65d7dbf19233f"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a90a9ae3f1a154cecbcf65d7dbf19233f">temperature_at_mixratio</a> (float wv_mixratio, float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>)</td></tr>
<tr class="memdesc:a90a9ae3f1a154cecbcf65d7dbf19233f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the temperature at a given water vapor mixing ratio and pressure level.  <br /></td></tr>
<tr class="separator:a90a9ae3f1a154cecbcf65d7dbf19233f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab50b565bcba73d207dc1433dee5b03c9"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ab50b565bcba73d207dc1433dee5b03c9">theta_level</a> (float potential_temperature, float temperature)</td></tr>
<tr class="memdesc:ab50b565bcba73d207dc1433dee5b03c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Comute the pressure level given potential temperature and temperature.  <br /></td></tr>
<tr class="separator:ab50b565bcba73d207dc1433dee5b03c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfd0143ab72871c4aabc95c1140ee8fb"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">theta</a> (float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature, float ref_pressure=<a class="el" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">THETA_REF_PRESSURE</a>)</td></tr>
<tr class="memdesc:acfd0143ab72871c4aabc95c1140ee8fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the potential temperature.  <br /></td></tr>
<tr class="separator:acfd0143ab72871c4aabc95c1140ee8fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac38870166f07ac30aadbc46b81340cc4"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ac38870166f07ac30aadbc46b81340cc4">mixratio</a> (float q)</td></tr>
<tr class="memdesc:ac38870166f07ac30aadbc46b81340cc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the water vapor mixing ratio from specific humidity.  <br /></td></tr>
<tr class="separator:ac38870166f07ac30aadbc46b81340cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9edcf0847c46e877689081848c58e3f4"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a9edcf0847c46e877689081848c58e3f4">mixratio</a> (float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature)</td></tr>
<tr class="memdesc:a9edcf0847c46e877689081848c58e3f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the water vapor mixing ratio.  <br /></td></tr>
<tr class="separator:a9edcf0847c46e877689081848c58e3f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ebcad18ef9939ff56f23d49c35dd04c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a0ebcad18ef9939ff56f23d49c35dd04c">mixratio_ice</a> (float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature)</td></tr>
<tr class="memdesc:a0ebcad18ef9939ff56f23d49c35dd04c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the ice water mixing ratio.  <br /></td></tr>
<tr class="separator:a0ebcad18ef9939ff56f23d49c35dd04c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a792a4a2a9f9243a82fb44cb77c2ee561"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a792a4a2a9f9243a82fb44cb77c2ee561">specific_humidity</a> (float rv)</td></tr>
<tr class="memdesc:a792a4a2a9f9243a82fb44cb77c2ee561"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute specific humidity from a mixing ratio.  <br /></td></tr>
<tr class="separator:a792a4a2a9f9243a82fb44cb77c2ee561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46e2f332f68747fee1eb817f7bd3a00b"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a46e2f332f68747fee1eb817f7bd3a00b">virtual_temperature</a> (float temperature, float rv, float rl=0.0f, float ri=0.0f)</td></tr>
<tr class="memdesc:a46e2f332f68747fee1eb817f7bd3a00b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the full virtual temperature.  <br /></td></tr>
<tr class="separator:a46e2f332f68747fee1eb817f7bd3a00b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8a75ed92a2c2062162264a54f3a5338"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ab8a75ed92a2c2062162264a54f3a5338">saturated_lift</a> (float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float theta_sat, float converge=0.001f)</td></tr>
<tr class="memdesc:ab8a75ed92a2c2062162264a54f3a5338"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the temperature along a moist adiabat (wet-bulb potential temperature) at a given pressure.  <br /></td></tr>
<tr class="separator:ab8a75ed92a2c2062162264a54f3a5338"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4014313c60a66a321e4050a2a07058e"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ad4014313c60a66a321e4050a2a07058e">wetlift</a> (float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature, float lifted_pressure)</td></tr>
<tr class="memdesc:ad4014313c60a66a321e4050a2a07058e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the temperature of a parcel lifted moist adiabatically to a new level.  <br /></td></tr>
<tr class="separator:ad4014313c60a66a321e4050a2a07058e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa258841692c25171d3f3b2e8b1f52079"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#aa258841692c25171d3f3b2e8b1f52079">moist_adiabat_cm1</a> (float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature, float new_pressure, float &amp;rv_total, float &amp;rv, float &amp;rl, float &amp;ri, float pres_incr, float converge, <a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81">adiabat</a> ma_type)</td></tr>
<tr class="memdesc:aa258841692c25171d3f3b2e8b1f52079"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the temperature of a parcel lifted moist adiabatically to a new level.  <br /></td></tr>
<tr class="separator:aa258841692c25171d3f3b2e8b1f52079"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4385866921cd7286946d9ffdd65c25e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ae4385866921cd7286946d9ffdd65c25e">drylift</a> (float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature, float dewpoint, float &amp;pressure_at_lcl, float &amp;temperature_at_lcl)</td></tr>
<tr class="memdesc:ae4385866921cd7286946d9ffdd65c25e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lift a parcel dry adiabatically to its Lifted Condensation Level (LCL).  <br /></td></tr>
<tr class="separator:ae4385866921cd7286946d9ffdd65c25e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accda9c75278f1a32978bbfd662492822"><td class="memTemplParams" colspan="2">template&lt;typename Lft &gt; </td></tr>
<tr class="memitem:accda9c75278f1a32978bbfd662492822"><td class="memTemplItemLeft" align="right" valign="top">float&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#accda9c75278f1a32978bbfd662492822">wetbulb</a> (Lft lifter, float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature, float dewpoint)</td></tr>
<tr class="memdesc:accda9c75278f1a32978bbfd662492822"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the wetbulb temperature.  <br /></td></tr>
<tr class="separator:accda9c75278f1a32978bbfd662492822"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3156aa7f5bafbd908184c7f51927ee"><td class="memTemplParams" colspan="2">template&lt;typename Lft &gt; </td></tr>
<tr class="memitem:a5e3156aa7f5bafbd908184c7f51927ee"><td class="memTemplItemLeft" align="right" valign="top">float&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a5e3156aa7f5bafbd908184c7f51927ee">theta_wetbulb</a> (Lft lifter, float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature, float dewpoint)</td></tr>
<tr class="memdesc:a5e3156aa7f5bafbd908184c7f51927ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the wetbulb potential temperature.  <br /></td></tr>
<tr class="separator:a5e3156aa7f5bafbd908184c7f51927ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab06f16aa1caac3136e863db8cd61e2e9"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ab06f16aa1caac3136e863db8cd61e2e9">thetae</a> (float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature, float dewpoint)</td></tr>
<tr class="memdesc:ab06f16aa1caac3136e863db8cd61e2e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the equivalent potential temperature.  <br /></td></tr>
<tr class="separator:ab06f16aa1caac3136e863db8cd61e2e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43a01274768ee388a983046651a230d3"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a43a01274768ee388a983046651a230d3">lapse_rate</a> (<a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a> layer_agl, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const float temperature[], const std::ptrdiff_t N)</td></tr>
<tr class="memdesc:a43a01274768ee388a983046651a230d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute the lapse rate over the given <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a> (AGL)  <br /></td></tr>
<tr class="separator:a43a01274768ee388a983046651a230d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4e86da659bfca2eae1f0baddb84a303"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#aa4e86da659bfca2eae1f0baddb84a303">lapse_rate</a> (<a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> layer, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const float temperature[], const std::ptrdiff_t N)</td></tr>
<tr class="memdesc:aa4e86da659bfca2eae1f0baddb84a303"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute the lapse rate over the given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>  <br /></td></tr>
<tr class="separator:aa4e86da659bfca2eae1f0baddb84a303"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd0d1a28608e145c455ace03e787e33b"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#abd0d1a28608e145c455ace03e787e33b">lapse_rate_max</a> (<a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a> layer_agl, const float depth, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const float temperature[], const std::ptrdiff_t N, <a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a> *max_lyr=nullptr)</td></tr>
<tr class="memdesc:abd0d1a28608e145c455ace03e787e33b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the maximum lapse rate within a specified layer/depth (AGL).  <br /></td></tr>
<tr class="separator:abd0d1a28608e145c455ace03e787e33b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6c026b54a5c0c2e1bd24d35cb20b11a"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#af6c026b54a5c0c2e1bd24d35cb20b11a">lapse_rate_max</a> (<a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> layer, const float depth, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const float temperature[], const std::ptrdiff_t N, <a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> *max_lyr=nullptr)</td></tr>
<tr class="memdesc:af6c026b54a5c0c2e1bd24d35cb20b11a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the maximum lapse rate within a specified layer/depth (Pres)  <br /></td></tr>
<tr class="separator:af6c026b54a5c0c2e1bd24d35cb20b11a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae31e8a18568ec26222b603e629c5598"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#aae31e8a18568ec26222b603e629c5598">buoyancy</a> (const float pcl_temperature, const float env_temperature)</td></tr>
<tr class="memdesc:aae31e8a18568ec26222b603e629c5598"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute buoyancy given parcel and environment temperatures  <br /></td></tr>
<tr class="separator:aae31e8a18568ec26222b603e629c5598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02c8d90f07b87e0051b2d117da66d11c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a02c8d90f07b87e0051b2d117da66d11c">buoyancy</a> (const float pcl_temperature[], const float env_temperature[], float buoy_arr[], std::ptrdiff_t N)</td></tr>
<tr class="memdesc:a02c8d90f07b87e0051b2d117da66d11c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute buoyancy given arrays of parcel &amp; environment temperatures.  <br /></td></tr>
<tr class="separator:a02c8d90f07b87e0051b2d117da66d11c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5fed65fe0cdf797961047fb9cde3295"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ab5fed65fe0cdf797961047fb9cde3295">moist_static_energy</a> (float height_agl, float temperature, float <a class="el" href="namespacesharp.html#a792a4a2a9f9243a82fb44cb77c2ee561">specific_humidity</a>)</td></tr>
<tr class="memdesc:ab5fed65fe0cdf797961047fb9cde3295"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute moist static energy.  <br /></td></tr>
<tr class="separator:ab5fed65fe0cdf797961047fb9cde3295"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cc6e590243b248f4fb44d9b0e1a6400"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a0cc6e590243b248f4fb44d9b0e1a6400">buoyancy_dilution_potential</a> (const float temperature, const float mse_bar, const float saturation_mse)</td></tr>
<tr class="separator:a0cc6e590243b248f4fb44d9b0e1a6400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac17d8171de07c7a610de63da30ed4f6c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ac17d8171de07c7a610de63da30ed4f6c">u_component</a> (float wind_speed, float wind_direction)</td></tr>
<tr class="memdesc:ac17d8171de07c7a610de63da30ed4f6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the zonal (U) wind component from a wind vector.  <br /></td></tr>
<tr class="separator:ac17d8171de07c7a610de63da30ed4f6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2232af9f4649a0701f64d2d7770f5ea"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#af2232af9f4649a0701f64d2d7770f5ea">v_component</a> (float wind_speed, float wind_direction)</td></tr>
<tr class="memdesc:af2232af9f4649a0701f64d2d7770f5ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the meridional (V) wind component from a wind vector.  <br /></td></tr>
<tr class="separator:af2232af9f4649a0701f64d2d7770f5ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24ba1a17b591165e527fa9bf6156eed2"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a24ba1a17b591165e527fa9bf6156eed2">vector_angle</a> (float u_comp, float v_comp)</td></tr>
<tr class="memdesc:a24ba1a17b591165e527fa9bf6156eed2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the direction (degrees from North) a vector points to.  <br /></td></tr>
<tr class="separator:a24ba1a17b591165e527fa9bf6156eed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af887f27accb1a1d656a35abec65cab5f"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#af887f27accb1a1d656a35abec65cab5f">vector_magnitude</a> (float u_comp, float v_comp)</td></tr>
<tr class="memdesc:af887f27accb1a1d656a35abec65cab5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the magnitude of a vector given its components.  <br /></td></tr>
<tr class="separator:af887f27accb1a1d656a35abec65cab5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace465acac91184c91987bb085a81777a"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ace465acac91184c91987bb085a81777a">vector_magnitude_precise</a> (float u_comp, float v_comp)</td></tr>
<tr class="memdesc:ace465acac91184c91987bb085a81777a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Precisely computes the magnitude of a vector given its components.  <br /></td></tr>
<tr class="separator:ace465acac91184c91987bb085a81777a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc84f46d1ec5872b1777857983bdb4be"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1WindVector.html">WindVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#adc84f46d1ec5872b1777857983bdb4be">components_to_vector</a> (float u_comp, float v_comp)</td></tr>
<tr class="memdesc:adc84f46d1ec5872b1777857983bdb4be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conveniance function to compute wind speed and direction from components.  <br /></td></tr>
<tr class="separator:adc84f46d1ec5872b1777857983bdb4be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2ceb7b2c34f95d4333e24bd2b824b6a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1WindVector.html">WindVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ad2ceb7b2c34f95d4333e24bd2b824b6a">components_to_vector</a> (<a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a> comp)</td></tr>
<tr class="memdesc:ad2ceb7b2c34f95d4333e24bd2b824b6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conveniance function to compute wind speed and direction from components.  <br /></td></tr>
<tr class="separator:ad2ceb7b2c34f95d4333e24bd2b824b6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a4cb8e554c04774503b004939f27f54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a1a4cb8e554c04774503b004939f27f54">vector_to_components</a> (float wind_speed, float wind_direction)</td></tr>
<tr class="memdesc:a1a4cb8e554c04774503b004939f27f54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conveniance function to compute the U and V components of a wind vector.  <br /></td></tr>
<tr class="separator:a1a4cb8e554c04774503b004939f27f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae211cc70dd043a0e2fe7e92ab9dd34a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ae211cc70dd043a0e2fe7e92ab9dd34a2">vector_to_components</a> (<a class="el" href="structsharp_1_1WindVector.html">WindVector</a> vect)</td></tr>
<tr class="memdesc:ae211cc70dd043a0e2fe7e92ab9dd34a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conveniance function to compute the U and V components of a wind vector.  <br /></td></tr>
<tr class="separator:ae211cc70dd043a0e2fe7e92ab9dd34a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c8b9022103d067f30281d68fa81cbda"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a3c8b9022103d067f30281d68fa81cbda">mean_wind</a> (<a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> layer, const float pres[], const float u_wind[], const float v_wind[], const std::ptrdiff_t N, const bool weighted)</td></tr>
<tr class="memdesc:a3c8b9022103d067f30281d68fa81cbda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the mean wind over the given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>.  <br /></td></tr>
<tr class="separator:a3c8b9022103d067f30281d68fa81cbda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a099a4575acc27d6e10f9dfb69bc315a1"><td class="memTemplParams" colspan="2">template&lt;typename L &gt; </td></tr>
<tr class="memitem:a099a4575acc27d6e10f9dfb69bc315a1"><td class="memTemplItemLeft" align="right" valign="top">constexpr <a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a099a4575acc27d6e10f9dfb69bc315a1">wind_shear</a> (L layer, const float coord[], const float u_wind[], const float v_wind[], const std::ptrdiff_t N)</td></tr>
<tr class="memdesc:a099a4575acc27d6e10f9dfb69bc315a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compue the wind shear for a given layer.  <br /></td></tr>
<tr class="separator:a099a4575acc27d6e10f9dfb69bc315a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80858337a63be77bafadbb343d6e4931"><td class="memTemplParams" colspan="2">template&lt;typename L &gt; </td></tr>
<tr class="memitem:a80858337a63be77bafadbb343d6e4931"><td class="memTemplItemLeft" align="right" valign="top">float&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a80858337a63be77bafadbb343d6e4931">helicity</a> (L layer, <a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a> storm_motion, const float coord[], const float u_wind[], const float v_wind[], const std::ptrdiff_t N)</td></tr>
<tr class="memdesc:a80858337a63be77bafadbb343d6e4931"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the Storm Relative Helicity (SRH) over a given layer.  <br /></td></tr>
<tr class="separator:a80858337a63be77bafadbb343d6e4931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4acd4077bc73279a9af0011f3f09954"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ad4acd4077bc73279a9af0011f3f09954">effective_inflow_layer</a> (<a class="el" href="structsharp_1_1lifter__wobus.html">sharp::lifter_wobus</a> &amp;lifter, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const float temperature[], const float dewpoint[], const float virtemp_arr[], float pcl_vtmpk_arr[], float buoy_arr[], const std::ptrdiff_t N, const float cape_thresh, const float cinh_thresh, <a class="el" href="structsharp_1_1Parcel.html">Parcel</a> *mupcl)</td></tr>
<tr class="separator:ad4acd4077bc73279a9af0011f3f09954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa95eb7a4955df00fcb68b2cd624de2fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#aa95eb7a4955df00fcb68b2cd624de2fc">effective_inflow_layer</a> (<a class="el" href="structsharp_1_1lifter__cm1.html">sharp::lifter_cm1</a> &amp;lifter, const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[], const float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[], const float temperature[], const float dewpoint[], const float virtemp_arr[], float pcl_vtmpk_arr[], float buoy_arr[], const std::ptrdiff_t N, const float cape_thresh, const float cinh_thresh, <a class="el" href="structsharp_1_1Parcel.html">Parcel</a> *mupcl)</td></tr>
<tr class="separator:aa95eb7a4955df00fcb68b2cd624de2fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7494c22424745a8847092b64195fb9ae"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1</a> (float &amp;pcl_pres_next, float &amp;pcl_pi_next, float &amp;pcl_t_next, float &amp;pcl_rv_next, float &amp;pcl_rl_next, float &amp;pcl_ri_next, float pcl_pres_prev, float pcl_t_prev, float pcl_theta_prev, float pcl_rv_prev, float pcl_rl_prev, float pcl_ri_prev, float rv_total, bool ascending, bool ice=false, float converge=0.0002f)</td></tr>
<tr class="separator:a7494c22424745a8847092b64195fb9ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5301da4223bbde718f7e5b2e8f14e420"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a5301da4223bbde718f7e5b2e8f14e420">wetbulb</a> (<a class="el" href="structsharp_1_1lifter__wobus.html">lifter_wobus</a> lifter, float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature, float dewpoint)</td></tr>
<tr class="separator:a5301da4223bbde718f7e5b2e8f14e420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb48d1954c4d2cd29e2575bff749a34e"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#abb48d1954c4d2cd29e2575bff749a34e">wetbulb</a> (<a class="el" href="structsharp_1_1lifter__cm1.html">lifter_cm1</a> lifter, float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature, float dewpoint)</td></tr>
<tr class="separator:abb48d1954c4d2cd29e2575bff749a34e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a24e90b43358dfbdac50c9008de657c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a4a24e90b43358dfbdac50c9008de657c">theta_wetbulb</a> (<a class="el" href="structsharp_1_1lifter__wobus.html">lifter_wobus</a> lifter, float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature, float dewpoint)</td></tr>
<tr class="separator:a4a24e90b43358dfbdac50c9008de657c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a514db8e8d5e4925dd56fd773fdd9ef55"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a514db8e8d5e4925dd56fd773fdd9ef55">theta_wetbulb</a> (<a class="el" href="structsharp_1_1lifter__cm1.html">lifter_cm1</a> lifter, float <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, float temperature, float dewpoint)</td></tr>
<tr class="separator:a514db8e8d5e4925dd56fd773fdd9ef55"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4718012c47a66f5229433dd785fc753f"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a4718012c47a66f5229433dd785fc753f">RGAS</a> = 8.314462618f</td></tr>
<tr class="separator:a4718012c47a66f5229433dd785fc753f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a741f56d59b05fd970ec5f84382c444af"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a741f56d59b05fd970ec5f84382c444af">MDRY</a> = 28.96546e-3f</td></tr>
<tr class="separator:a741f56d59b05fd970ec5f84382c444af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d349d4863e1a955abac2ba65f264a55"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a5d349d4863e1a955abac2ba65f264a55">MWATER</a> = 18.015268e-3f</td></tr>
<tr class="separator:a5d349d4863e1a955abac2ba65f264a55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76aec25e3cffb5ba454e762e63aafbf3"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a76aec25e3cffb5ba454e762e63aafbf3">DRYAIR_SPEC_HEAT_RATIO</a> = 1.4f</td></tr>
<tr class="separator:a76aec25e3cffb5ba454e762e63aafbf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8d73d01806950def2c52b818f90cb6c"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#aa8d73d01806950def2c52b818f90cb6c">ZEROCNK</a> = 273.15f</td></tr>
<tr class="separator:aa8d73d01806950def2c52b818f90cb6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e158bdc0b7370e0fb83a4aaa4dd6757"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a4e158bdc0b7370e0fb83a4aaa4dd6757">HPA_TO_PA</a> = 100.0f</td></tr>
<tr class="separator:a4e158bdc0b7370e0fb83a4aaa4dd6757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ed9189675cbc084cdba640eac37a0c4"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a6ed9189675cbc084cdba640eac37a0c4">PA_TO_HPA</a> = 0.01f</td></tr>
<tr class="separator:a6ed9189675cbc084cdba640eac37a0c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4bb52918c53f75e2175d67840111600"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">THETA_REF_PRESSURE</a> = 100000.0f</td></tr>
<tr class="separator:ab4bb52918c53f75e2175d67840111600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2ffcc858ff03be6e2ae2fe2ee20040d"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a> = -9999.0f</td></tr>
<tr class="separator:af2ffcc858ff03be6e2ae2fe2ee20040d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e49daafd469b40abf4197bf26af2097"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a6e49daafd469b40abf4197bf26af2097">GRAVITY</a> = 9.80665f</td></tr>
<tr class="separator:a6e49daafd469b40abf4197bf26af2097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97ce2ca879d02b75bc90aa0f33da4ecb"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a97ce2ca879d02b75bc90aa0f33da4ecb">TOL</a> = 1e-10f</td></tr>
<tr class="separator:a97ce2ca879d02b75bc90aa0f33da4ecb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36f9a81a6f5f2f96e2e34b5607b8a3da"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a36f9a81a6f5f2f96e2e34b5607b8a3da">PI</a> = 3.14159265f</td></tr>
<tr class="separator:a36f9a81a6f5f2f96e2e34b5607b8a3da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95fe38384587dd0ca0f08eafa30c0597"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a95fe38384587dd0ca0f08eafa30c0597">RDGAS</a> = <a class="el" href="namespacesharp.html#a4718012c47a66f5229433dd785fc753f">RGAS</a> / <a class="el" href="namespacesharp.html#a741f56d59b05fd970ec5f84382c444af">MDRY</a></td></tr>
<tr class="separator:a95fe38384587dd0ca0f08eafa30c0597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a230af88716879ad2bc5cbafef0570e8f"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a230af88716879ad2bc5cbafef0570e8f">RVGAS</a> = <a class="el" href="namespacesharp.html#a4718012c47a66f5229433dd785fc753f">RGAS</a> / <a class="el" href="namespacesharp.html#a5d349d4863e1a955abac2ba65f264a55">MWATER</a></td></tr>
<tr class="separator:a230af88716879ad2bc5cbafef0570e8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83dfda911c84f0dda42368d0c1b63ef1"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a83dfda911c84f0dda42368d0c1b63ef1">EPSILON</a> = <a class="el" href="namespacesharp.html#a95fe38384587dd0ca0f08eafa30c0597">RDGAS</a> / <a class="el" href="namespacesharp.html#a230af88716879ad2bc5cbafef0570e8f">RVGAS</a></td></tr>
<tr class="separator:a83dfda911c84f0dda42368d0c1b63ef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afda77fe7a6cefaab1ecb404167ed90b4"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#afda77fe7a6cefaab1ecb404167ed90b4">CP_DRYAIR</a></td></tr>
<tr class="separator:afda77fe7a6cefaab1ecb404167ed90b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7b120df294d5b7f6fb85dbed074d52d"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#ac7b120df294d5b7f6fb85dbed074d52d">CP_VAPOR</a> = 1875.0f</td></tr>
<tr class="separator:ac7b120df294d5b7f6fb85dbed074d52d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e3e641b9148566d1f4fc1bd06494ec2"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a2e3e641b9148566d1f4fc1bd06494ec2">CP_LIQUID</a> = 4190.0f</td></tr>
<tr class="separator:a2e3e641b9148566d1f4fc1bd06494ec2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e0154c5bf801be652400fa05934af6c"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a5e0154c5bf801be652400fa05934af6c">CP_ICE</a> = 2118.636f</td></tr>
<tr class="separator:a5e0154c5bf801be652400fa05934af6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addc30683489f1fc452c739aeba758985"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#addc30683489f1fc452c739aeba758985">EXP_LV</a> = 2.501e6f</td></tr>
<tr class="separator:addc30683489f1fc452c739aeba758985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf7769c64b4673b190d07f0b5d294269"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#adf7769c64b4673b190d07f0b5d294269">EXP_LS</a> = 2.836017e6f</td></tr>
<tr class="separator:adf7769c64b4673b190d07f0b5d294269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44c890aa9dcb1317ac2e1ad0eeb5ea9c"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a44c890aa9dcb1317ac2e1ad0eeb5ea9c">LV1</a> = <a class="el" href="namespacesharp.html#addc30683489f1fc452c739aeba758985">EXP_LV</a> + (<a class="el" href="namespacesharp.html#a2e3e641b9148566d1f4fc1bd06494ec2">CP_LIQUID</a> - <a class="el" href="namespacesharp.html#ac7b120df294d5b7f6fb85dbed074d52d">CP_VAPOR</a>) * <a class="el" href="namespacesharp.html#aa8d73d01806950def2c52b818f90cb6c">ZEROCNK</a></td></tr>
<tr class="separator:a44c890aa9dcb1317ac2e1ad0eeb5ea9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa60aa56bd4c3247725da749cfa87ade6"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#aa60aa56bd4c3247725da749cfa87ade6">LV2</a> = <a class="el" href="namespacesharp.html#a2e3e641b9148566d1f4fc1bd06494ec2">CP_LIQUID</a> - <a class="el" href="namespacesharp.html#ac7b120df294d5b7f6fb85dbed074d52d">CP_VAPOR</a></td></tr>
<tr class="separator:aa60aa56bd4c3247725da749cfa87ade6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6adf296a3a61023be86b275deeb25924"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a6adf296a3a61023be86b275deeb25924">LS1</a> = <a class="el" href="namespacesharp.html#adf7769c64b4673b190d07f0b5d294269">EXP_LS</a> + (<a class="el" href="namespacesharp.html#a5e0154c5bf801be652400fa05934af6c">CP_ICE</a> - <a class="el" href="namespacesharp.html#ac7b120df294d5b7f6fb85dbed074d52d">CP_VAPOR</a>) * <a class="el" href="namespacesharp.html#aa8d73d01806950def2c52b818f90cb6c">ZEROCNK</a></td></tr>
<tr class="separator:a6adf296a3a61023be86b275deeb25924"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fd1765db902cdc4872bc01af9b619e5"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a2fd1765db902cdc4872bc01af9b619e5">LS2</a> = <a class="el" href="namespacesharp.html#a5e0154c5bf801be652400fa05934af6c">CP_ICE</a> - <a class="el" href="namespacesharp.html#ac7b120df294d5b7f6fb85dbed074d52d">CP_VAPOR</a></td></tr>
<tr class="separator:a2fd1765db902cdc4872bc01af9b619e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21aa81ae76506b5845830b588cbfb993"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a21aa81ae76506b5845830b588cbfb993">ROCP</a> = <a class="el" href="namespacesharp.html#a95fe38384587dd0ca0f08eafa30c0597">RDGAS</a> / <a class="el" href="namespacesharp.html#afda77fe7a6cefaab1ecb404167ed90b4">CP_DRYAIR</a></td></tr>
<tr class="separator:a21aa81ae76506b5845830b588cbfb993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35757d2935b734ce153186ef51c2692c"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a35757d2935b734ce153186ef51c2692c">GAMMA_D</a> = <a class="el" href="namespacesharp.html#a6e49daafd469b40abf4197bf26af2097">GRAVITY</a> / <a class="el" href="namespacesharp.html#afda77fe7a6cefaab1ecb404167ed90b4">CP_DRYAIR</a></td></tr>
<tr class="separator:a35757d2935b734ce153186ef51c2692c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9390aa610ba3e66b2e8f84c4261c49af"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a9390aa610ba3e66b2e8f84c4261c49af">PRANDTL</a> = 1.f / 3.f</td></tr>
<tr class="separator:a9390aa610ba3e66b2e8f84c4261c49af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee70f2aa7bfda20363d82e6eef5b1a21"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#aee70f2aa7bfda20363d82e6eef5b1a21">VKSQ</a> = 0.18f</td></tr>
<tr class="separator:aee70f2aa7bfda20363d82e6eef5b1a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a834f494fab1d9ccc18699ad11a51bc"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesharp.html#a2a834f494fab1d9ccc18699ad11a51bc">VAPPRES_REF</a> = 611.65f</td></tr>
<tr class="separator:a2a834f494fab1d9ccc18699ad11a51bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ad39fcd09ffea548c2aa8468c7d834d81" name="ad39fcd09ffea548c2aa8468c7d834d81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad39fcd09ffea548c2aa8468c7d834d81">&#9670;&#160;</a></span>adiabat</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81">sharp::adiabat</a> : int</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Defines the kinds of moist adiabats used by <a class="el" href="namespacesharp.html#aa258841692c25171d3f3b2e8b1f52079" title="Compute the temperature of a parcel lifted moist adiabatically to a new level.">sharp::moist_adiabat_cm1</a>. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ad39fcd09ffea548c2aa8468c7d834d81a2950b2ab4ab4c2d385ff16dfae8003c0" name="ad39fcd09ffea548c2aa8468c7d834d81a2950b2ab4ab4c2d385ff16dfae8003c0"></a>pseudo_liq&#160;</td><td class="fielddoc"><p>Pseudoadiabatic considering only liquid water. </p>
</td></tr>
<tr><td class="fieldname"><a id="ad39fcd09ffea548c2aa8468c7d834d81ab7604476f4061e16c1a5abd1bf70bcb4" name="ad39fcd09ffea548c2aa8468c7d834d81ab7604476f4061e16c1a5abd1bf70bcb4"></a>adiab_liq&#160;</td><td class="fielddoc"><p>Adiabatic considering only liquid water. </p>
</td></tr>
<tr><td class="fieldname"><a id="ad39fcd09ffea548c2aa8468c7d834d81ad4a63946bf6f9aa1165238e71094024a" name="ad39fcd09ffea548c2aa8468c7d834d81ad4a63946bf6f9aa1165238e71094024a"></a>pseudo_ice&#160;</td><td class="fielddoc"><p>Pseudoadiabatic considering liquid water + ice. </p>
</td></tr>
<tr><td class="fieldname"><a id="ad39fcd09ffea548c2aa8468c7d834d81a8c43e5a2312127e6576ccd8030da6692" name="ad39fcd09ffea548c2aa8468c7d834d81a8c43e5a2312127e6576ccd8030da6692"></a>adiab_ice&#160;</td><td class="fielddoc"><p>Adiabatic considering liquid water + ice. </p>
</td></tr>
<tr><td class="fieldname"><a id="ad39fcd09ffea548c2aa8468c7d834d81ab1a326c06d88bf042f73d70f50197905" name="ad39fcd09ffea548c2aa8468c7d834d81ab1a326c06d88bf042f73d70f50197905"></a>END&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="thermo_8h_source.html#l00029">29</a> of file <a class="el" href="thermo_8h_source.html">thermo.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   29</span>                   : <span class="keywordtype">int</span> {</div>
<div class="line"><span class="lineno">   33</span>    <a class="code hl_enumvalue" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81a2950b2ab4ab4c2d385ff16dfae8003c0">pseudo_liq</a> = 1,</div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   38</span>    <a class="code hl_enumvalue" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81ab7604476f4061e16c1a5abd1bf70bcb4">adiab_liq</a> = 2,</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   43</span>    <a class="code hl_enumvalue" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81ad4a63946bf6f9aa1165238e71094024a">pseudo_ice</a> = 3,</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   48</span>    <a class="code hl_enumvalue" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81a8c43e5a2312127e6576ccd8030da6692">adiab_ice</a> = 4,</div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab1a326c06d88bf042f73d70f50197905">END</a>,</div>
<div class="line"><span class="lineno">   50</span>};</div>
<div class="ttc" id="anamespacesharp_html_a5670844352aa7728286639ae3c43d351ab1a326c06d88bf042f73d70f50197905"><div class="ttname"><a href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab1a326c06d88bf042f73d70f50197905">sharp::LayerCoordinate::END</a></div><div class="ttdeci">@ END</div><div class="ttdoc">End value for range checking parameters.</div></div>
<div class="ttc" id="anamespacesharp_html_ad39fcd09ffea548c2aa8468c7d834d81a2950b2ab4ab4c2d385ff16dfae8003c0"><div class="ttname"><a href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81a2950b2ab4ab4c2d385ff16dfae8003c0">sharp::adiabat::pseudo_liq</a></div><div class="ttdeci">@ pseudo_liq</div><div class="ttdoc">Pseudoadiabatic considering only liquid water.</div></div>
<div class="ttc" id="anamespacesharp_html_ad39fcd09ffea548c2aa8468c7d834d81a8c43e5a2312127e6576ccd8030da6692"><div class="ttname"><a href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81a8c43e5a2312127e6576ccd8030da6692">sharp::adiabat::adiab_ice</a></div><div class="ttdeci">@ adiab_ice</div><div class="ttdoc">Adiabatic considering liquid water + ice.</div></div>
<div class="ttc" id="anamespacesharp_html_ad39fcd09ffea548c2aa8468c7d834d81ab7604476f4061e16c1a5abd1bf70bcb4"><div class="ttname"><a href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81ab7604476f4061e16c1a5abd1bf70bcb4">sharp::adiabat::adiab_liq</a></div><div class="ttdeci">@ adiab_liq</div><div class="ttdoc">Adiabatic considering only liquid water.</div></div>
<div class="ttc" id="anamespacesharp_html_ad39fcd09ffea548c2aa8468c7d834d81ad4a63946bf6f9aa1165238e71094024a"><div class="ttname"><a href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81ad4a63946bf6f9aa1165238e71094024a">sharp::adiabat::pseudo_ice</a></div><div class="ttdeci">@ pseudo_ice</div><div class="ttdoc">Pseudoadiabatic considering liquid water + ice.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5670844352aa7728286639ae3c43d351" name="a5670844352aa7728286639ae3c43d351"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5670844352aa7728286639ae3c43d351">&#9670;&#160;</a></span>LayerCoordinate</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351">sharp::LayerCoordinate</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enum defining the coordinate system of a layer. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81" name="a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81"></a>height&#160;</td><td class="fielddoc"><p>Height coordinate. </p>
</td></tr>
<tr><td class="fieldname"><a id="a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093" name="a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093"></a>pressure&#160;</td><td class="fielddoc"><p>Pressure coordinate. </p>
</td></tr>
<tr><td class="fieldname"><a id="a5670844352aa7728286639ae3c43d351ab1a326c06d88bf042f73d70f50197905" name="a5670844352aa7728286639ae3c43d351ab1a326c06d88bf042f73d70f50197905"></a>END&#160;</td><td class="fielddoc"><p>End value for range checking parameters. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="layer_8h_source.html#l00033">33</a> of file <a class="el" href="layer_8h_source.html">layer.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   33</span>                           {</div>
<div class="line"><span class="lineno">   37</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a> = 0,</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   42</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a> = 1,</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   47</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab1a326c06d88bf042f73d70f50197905">END</a>,</div>
<div class="line"><span class="lineno">   48</span>};</div>
<div class="ttc" id="anamespacesharp_html_a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81"><div class="ttname"><a href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">sharp::LayerCoordinate::height</a></div><div class="ttdeci">@ height</div><div class="ttdoc">Height coordinate.</div></div>
<div class="ttc" id="anamespacesharp_html_a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093"><div class="ttname"><a href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">sharp::LayerCoordinate::pressure</a></div><div class="ttdeci">@ pressure</div><div class="ttdoc">Pressure coordinate.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a03664f85e552919899eefba1c4a7997f" name="a03664f85e552919899eefba1c4a7997f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03664f85e552919899eefba1c4a7997f">&#9670;&#160;</a></span>LPL</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997f">sharp::LPL</a> : int</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enum that defines the lifted parcel level (LPL) of origin. </p>
<p>The SFC parcel is a surface-based parcel, where the parcel initial attributes are set to the surface pressure, temperature, and dewpoint.</p>
<p>The FCST parcel is a forecast-surface-based parcel, in which the afternoon surface temperature and dewpoint are estimated and set as the parcel starting values.</p>
<p>The MU parcel is the most unstable parcel, in which the parcel attributes are set to the pressure, temperature, and dewpoint of the maximum Theta-E level within the bottom 400 hPa of the profile.</p>
<p>The ML parcel is the mixed-layer parcel, in which the mean theta and water vapor mixing ratio within the lowest 100 hPa are used to estimate a boundary layer mean, and lifted from the surface.</p>
<p>The USR parcel means that the parcel initial lifting attributes have already been set by the programmer or user, and there is no need for them to be set or modified. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a03664f85e552919899eefba1c4a7997faf3385210bc009d67471bd739689779de" name="a03664f85e552919899eefba1c4a7997faf3385210bc009d67471bd739689779de"></a>SFC&#160;</td><td class="fielddoc"><p>Surface Based <a class="el" href="structsharp_1_1Parcel.html" title="Data that defines a Parcel, its attributes, and derived quantities.">Parcel</a>. </p>
</td></tr>
<tr><td class="fieldname"><a id="a03664f85e552919899eefba1c4a7997fa0f46ff8d6503905b6b729f2ec851079f" name="a03664f85e552919899eefba1c4a7997fa0f46ff8d6503905b6b729f2ec851079f"></a>FCST&#160;</td><td class="fielddoc"><p>Forecast Surface <a class="el" href="structsharp_1_1Parcel.html" title="Data that defines a Parcel, its attributes, and derived quantities.">Parcel</a>. </p>
</td></tr>
<tr><td class="fieldname"><a id="a03664f85e552919899eefba1c4a7997fae5919ba9cf2e803bdbc98334a7f64daa" name="a03664f85e552919899eefba1c4a7997fae5919ba9cf2e803bdbc98334a7f64daa"></a>MU&#160;</td><td class="fielddoc"><p>Most Unstable <a class="el" href="structsharp_1_1Parcel.html" title="Data that defines a Parcel, its attributes, and derived quantities.">Parcel</a>. </p>
</td></tr>
<tr><td class="fieldname"><a id="a03664f85e552919899eefba1c4a7997fad01fd9b01e9dde8bd3dc247afbfb7218" name="a03664f85e552919899eefba1c4a7997fad01fd9b01e9dde8bd3dc247afbfb7218"></a>ML&#160;</td><td class="fielddoc"><p>Mixed Layer <a class="el" href="structsharp_1_1Parcel.html" title="Data that defines a Parcel, its attributes, and derived quantities.">Parcel</a>. </p>
</td></tr>
<tr><td class="fieldname"><a id="a03664f85e552919899eefba1c4a7997fa2b6cc9c30eaad9c109091ea928529cbd" name="a03664f85e552919899eefba1c4a7997fa2b6cc9c30eaad9c109091ea928529cbd"></a>USR&#160;</td><td class="fielddoc"><p>User-defined <a class="el" href="structsharp_1_1Parcel.html" title="Data that defines a Parcel, its attributes, and derived quantities.">Parcel</a>. </p>
</td></tr>
<tr><td class="fieldname"><a id="a03664f85e552919899eefba1c4a7997fab1a326c06d88bf042f73d70f50197905" name="a03664f85e552919899eefba1c4a7997fab1a326c06d88bf042f73d70f50197905"></a>END&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="parcel_8h_source.html#l00195">195</a> of file <a class="el" href="parcel_8h_source.html">parcel.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  195</span>               : <span class="keywordtype">int</span> {</div>
<div class="line"><span class="lineno">  199</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997faf3385210bc009d67471bd739689779de">SFC</a> = 1,</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  204</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fa0f46ff8d6503905b6b729f2ec851079f">FCST</a> = 2,</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  209</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fae5919ba9cf2e803bdbc98334a7f64daa">MU</a> = 3,  <span class="comment">// most unstable</span></div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  214</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fad01fd9b01e9dde8bd3dc247afbfb7218">ML</a> = 4,  <span class="comment">// Mixed layer</span></div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  219</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fa2b6cc9c30eaad9c109091ea928529cbd">USR</a> = 5,  <span class="comment">// user-defined</span></div>
<div class="line"><span class="lineno">  220</span>    <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab1a326c06d88bf042f73d70f50197905">END</a>,</div>
<div class="line"><span class="lineno">  221</span>};</div>
<div class="ttc" id="anamespacesharp_html_a03664f85e552919899eefba1c4a7997fa0f46ff8d6503905b6b729f2ec851079f"><div class="ttname"><a href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fa0f46ff8d6503905b6b729f2ec851079f">sharp::LPL::FCST</a></div><div class="ttdeci">@ FCST</div><div class="ttdoc">Forecast Surface Parcel.</div></div>
<div class="ttc" id="anamespacesharp_html_a03664f85e552919899eefba1c4a7997fa2b6cc9c30eaad9c109091ea928529cbd"><div class="ttname"><a href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fa2b6cc9c30eaad9c109091ea928529cbd">sharp::LPL::USR</a></div><div class="ttdeci">@ USR</div><div class="ttdoc">User-defined Parcel.</div></div>
<div class="ttc" id="anamespacesharp_html_a03664f85e552919899eefba1c4a7997fad01fd9b01e9dde8bd3dc247afbfb7218"><div class="ttname"><a href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fad01fd9b01e9dde8bd3dc247afbfb7218">sharp::LPL::ML</a></div><div class="ttdeci">@ ML</div><div class="ttdoc">Mixed Layer Parcel.</div></div>
<div class="ttc" id="anamespacesharp_html_a03664f85e552919899eefba1c4a7997fae5919ba9cf2e803bdbc98334a7f64daa"><div class="ttname"><a href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fae5919ba9cf2e803bdbc98334a7f64daa">sharp::LPL::MU</a></div><div class="ttdeci">@ MU</div><div class="ttdoc">Most Unstable Parcel.</div></div>
<div class="ttc" id="anamespacesharp_html_a03664f85e552919899eefba1c4a7997faf3385210bc009d67471bd739689779de"><div class="ttname"><a href="namespacesharp.html#a03664f85e552919899eefba1c4a7997faf3385210bc009d67471bd739689779de">sharp::LPL::SFC</a></div><div class="ttdeci">@ SFC</div><div class="ttdoc">Surface Based Parcel.</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac4464059524ff56c7974141bb4cc7375" name="ac4464059524ff56c7974141bb4cc7375"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4464059524ff56c7974141bb4cc7375">&#9670;&#160;</a></span>__lerp()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Fp &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr _Fp sharp::__lerp </td>
          <td>(</td>
          <td class="paramtype">const _Fp&#160;</td>
          <td class="paramname"><em>__a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _Fp&#160;</td>
          <td class="paramname"><em>__b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _Fp&#160;</td>
          <td class="paramname"><em>__t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Linearly interpolates between a and b with distance t. </p>
<dl class="section author"><dt>Author</dt><dd>C++20 Standard Template Library</dd></dl>
<p>This routine was copied from the C++20 standard template library. It is used to linearly interpolate between A and B over a normalized distance T, where 0 &lt;= T &lt;= 1. Full documentation and details can be found in the paper located here: <a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p0811r3.html">https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p0811r3.html</a></p>
<p>This linear interpolation guarantees the following:</p>
<ol type="1">
<li>Exactness: lerp(a,b,0)==a &amp; lerp(a,b,1)==b</li>
<li>Monotonicity: cmp(lerp(a,b,t2), lerp(a,b,t1)) * cmp(t2, t1)</li>
</ol>
<ul>
<li>cmp(b,a) &gt;= 0, where cmp is an arithmetic three-way comparison function</li>
</ul>
<ol type="1">
<li>Determinacy: result of NaN only for lerp(a,a,INFINITY)</li>
<li>Boundedness: t&lt;0 || t&gt;1 || isfinite(lerp(a,b,t))</li>
<li>Consistency: lerp(a,a,t) == a</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">__a</td><td>left value </td></tr>
    <tr><td class="paramname">__b</td><td>right value </td></tr>
    <tr><td class="paramname">__t</td><td>where 0 &lt;= __t &lt;= 1.0</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value between __a and __b at distance __t between them. </dd></dl>

<p class="definition">Definition at line <a class="el" href="interp_8h_source.html#l00051">51</a> of file <a class="el" href="interp_8h_source.html">interp.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span>                                                  {</div>
<div class="line"><span class="lineno">   53</span>    <span class="keywordflow">if</span> ((__a &lt;= 0 &amp;&amp; __b &gt;= 0) || (__a &gt;= 0 &amp;&amp; __b &lt;= 0))</div>
<div class="line"><span class="lineno">   54</span>        <span class="keywordflow">return</span> __t * __b + (1 - __t) * __a;</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordflow">if</span> (__t == 1) <span class="keywordflow">return</span> __b;  <span class="comment">// exact</span></div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>    <span class="comment">// Exact at __t=0, monotonic except near __t=1,</span></div>
<div class="line"><span class="lineno">   59</span>    <span class="comment">// bounded, determinate, and consistent:</span></div>
<div class="line"><span class="lineno">   60</span>    <span class="keyword">const</span> _Fp __x = __a + __t * (__b - __a);</div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordflow">return</span> (__t &gt; 1) == (__b &gt; __a)</div>
<div class="line"><span class="lineno">   62</span>               ? (__b &lt; __x ? __x : __b)</div>
<div class="line"><span class="lineno">   63</span>               : (__b &gt; __x ? __x : __b);  <span class="comment">// monotonic near __t=1</span></div>
<div class="line"><span class="lineno">   64</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a0bf533560780fdb77bc3656db8d89208">lerp()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ac4464059524ff56c7974141bb4cc7375_icgraph.svg" width="1431" height="1510"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a3558a68454edd4679ef97335e3a9f1fb" name="a3558a68454edd4679ef97335e3a9f1fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3558a68454edd4679ef97335e3a9f1fb">&#9670;&#160;</a></span>_integ_trapz()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr _T sharp::_integ_trapz </td>
          <td>(</td>
          <td class="paramtype">_T&#160;</td>
          <td class="paramname"><em>var_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_T&#160;</td>
          <td class="paramname"><em>var_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_T&#160;</td>
          <td class="paramname"><em>coord_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_T&#160;</td>
          <td class="paramname"><em>coord_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_T &amp;&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>weighted</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A kernel that computes the area under a curve using the trapezoidal rule. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>This is a function kernel that integrates an area using the trapezoidal rule. This function does not do the actual integration over an array, but is meant to be wrapped by any function that does so.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">var_top</td><td>The top value of the variable to integrate </td></tr>
    <tr><td class="paramname">var_bottom</td><td>The bottom value of the variable to integrate </td></tr>
    <tr><td class="paramname">coord_top</td><td>The top value of the coordinate to integrate </td></tr>
    <tr><td class="paramname">coord_bottom</td><td>The bottom value of the coordinate to integrate </td></tr>
    <tr><td class="paramname">weights</td><td>The weights to accumulate </td></tr>
    <tr><td class="paramname">weighted</td><td>Whether or not to accumulate weights</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The area under the curve </dd></dl>

<p class="definition">Definition at line <a class="el" href="algorithms_8h_source.html#l00125">125</a> of file <a class="el" href="algorithms_8h_source.html">algorithms.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  128</span>                                                                            {</div>
<div class="line"><span class="lineno">  129</span>    weights += (weighted) * (coord_top - coord_bottom);</div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordflow">return</span> ((var_top + var_bottom) / 2.0f) * (coord_top - coord_bottom);</div>
<div class="line"><span class="lineno">  131</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">integrate_layer_trapz()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a3558a68454edd4679ef97335e3a9f1fb_icgraph.svg" width="1110" height="335"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a7494c22424745a8847092b64195fb9ae" name="a7494c22424745a8847092b64195fb9ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7494c22424745a8847092b64195fb9ae">&#9670;&#160;</a></span>_solve_cm1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::_solve_cm1 </td>
          <td>(</td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>pcl_pres_next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>pcl_pi_next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>pcl_t_next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>pcl_rv_next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>pcl_rl_next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>pcl_ri_next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pcl_pres_prev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pcl_t_prev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pcl_theta_prev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pcl_rv_prev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pcl_rl_prev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pcl_ri_prev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>rv_total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ascending</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ice</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>converge</em> = <code>0.0002f</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00223">223</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  228</span>                                           {</div>
<div class="line"><span class="lineno">  229</span>    <span class="comment">// first guess - use the theta of the parcel</span></div>
<div class="line"><span class="lineno">  230</span>    <span class="comment">// before lifting, and update the first guess</span></div>
<div class="line"><span class="lineno">  231</span>    <span class="comment">// accordingly</span></div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordtype">float</span> pcl_theta_last = pcl_theta_prev;</div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordtype">float</span> pcl_theta_next = pcl_theta_prev;</div>
<div class="line"><span class="lineno">  234</span>    <span class="keywordtype">bool</span> not_converged = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordflow">while</span> (not_converged) {</div>
<div class="line"><span class="lineno">  237</span>        pcl_t_next = pcl_theta_last * pcl_pi_next;</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>        <span class="keywordtype">float</span> fliq = 1.0;</div>
<div class="line"><span class="lineno">  240</span>        <span class="keywordtype">float</span> fice = 0.0;</div>
<div class="line"><span class="lineno">  241</span>        <span class="keywordflow">if</span> (ice) {</div>
<div class="line"><span class="lineno">  242</span>            fliq = std::max(</div>
<div class="line"><span class="lineno">  243</span>                std::min((pcl_t_next - 233.15f) / (ZEROCNK - 233.15f), 1.0f),</div>
<div class="line"><span class="lineno">  244</span>                0.0f);</div>
<div class="line"><span class="lineno">  245</span>            fice = 1.0f - fliq;</div>
<div class="line"><span class="lineno">  246</span>        }</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> rv_term = fliq * mixratio(pcl_pres_next, pcl_t_next) +</div>
<div class="line"><span class="lineno">  249</span>                              fice * mixratio_ice(pcl_pres_next, pcl_t_next);</div>
<div class="line"><span class="lineno">  250</span>        <span class="keywordflow">if</span> (ascending) {</div>
<div class="line"><span class="lineno">  251</span>            pcl_rv_next = std::min(rv_total, rv_term);</div>
<div class="line"><span class="lineno">  252</span>            pcl_ri_next = std::max(fice * (rv_total - pcl_rv_next), 0.0f);</div>
<div class="line"><span class="lineno">  253</span>            pcl_rl_next = std::max(rv_total - pcl_rv_next - pcl_ri_next, 0.0f);</div>
<div class="line"><span class="lineno">  254</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  255</span>            pcl_rv_next = rv_term;</div>
<div class="line"><span class="lineno">  256</span>            pcl_rl_next = fliq * (rv_total - pcl_rv_next);</div>
<div class="line"><span class="lineno">  257</span>            pcl_ri_next = fice * (rv_total - pcl_rv_next);</div>
<div class="line"><span class="lineno">  258</span>        }</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> tbar = 0.5f * (pcl_t_prev + pcl_t_next);</div>
<div class="line"><span class="lineno">  261</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> rvbar = 0.5f * (pcl_rv_prev + pcl_rv_next);</div>
<div class="line"><span class="lineno">  262</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> rlbar = 0.5f * (pcl_rl_prev + pcl_rl_next);</div>
<div class="line"><span class="lineno">  263</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> ribar = 0.5f * (pcl_ri_prev + pcl_ri_next);</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> LHV = LV1 - LV2 * tbar;</div>
<div class="line"><span class="lineno">  266</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> LHS = LS1 - LS2 * tbar;</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> RM = RDGAS + RVGAS * rvbar;</div>
<div class="line"><span class="lineno">  269</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> CPM =</div>
<div class="line"><span class="lineno">  270</span>            CP_DRYAIR + CP_VAPOR * rvbar + CP_LIQUID * rlbar + CP_ICE * ribar;</div>
<div class="line"><span class="lineno">  271</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> term =</div>
<div class="line"><span class="lineno">  272</span>            LHV * (pcl_rl_next - pcl_rl_prev) / (CPM * tbar) +</div>
<div class="line"><span class="lineno">  273</span>            LHS * (pcl_ri_next - pcl_ri_prev) / (CPM * tbar) +</div>
<div class="line"><span class="lineno">  274</span>            (RM / CPM - ROCP) * std::log(pcl_pres_next / pcl_pres_prev);</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>        pcl_theta_next = pcl_theta_prev * std::exp(term);</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>        <span class="keywordflow">if</span> (std::abs(pcl_theta_next - pcl_theta_last) &gt; converge) {</div>
<div class="line"><span class="lineno">  279</span>            pcl_theta_last =</div>
<div class="line"><span class="lineno">  280</span>                pcl_theta_last + 0.3 * (pcl_theta_next - pcl_theta_last);</div>
<div class="line"><span class="lineno">  281</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  282</span>            not_converged = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  283</span>        }</div>
<div class="line"><span class="lineno">  284</span>    }</div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">return</span> pcl_theta_next;</div>
<div class="line"><span class="lineno">  286</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#afda77fe7a6cefaab1ecb404167ed90b4">CP_DRYAIR</a>, <a class="el" href="namespacesharp.html#a5e0154c5bf801be652400fa05934af6c">CP_ICE</a>, <a class="el" href="namespacesharp.html#a2e3e641b9148566d1f4fc1bd06494ec2">CP_LIQUID</a>, <a class="el" href="namespacesharp.html#ac7b120df294d5b7f6fb85dbed074d52d">CP_VAPOR</a>, <a class="el" href="namespacesharp.html#a6adf296a3a61023be86b275deeb25924">LS1</a>, <a class="el" href="namespacesharp.html#a2fd1765db902cdc4872bc01af9b619e5">LS2</a>, <a class="el" href="namespacesharp.html#a44c890aa9dcb1317ac2e1ad0eeb5ea9c">LV1</a>, <a class="el" href="namespacesharp.html#aa60aa56bd4c3247725da749cfa87ade6">LV2</a>, <a class="el" href="namespacesharp.html#ac38870166f07ac30aadbc46b81340cc4">mixratio()</a>, <a class="el" href="namespacesharp.html#a0ebcad18ef9939ff56f23d49c35dd04c">mixratio_ice()</a>, <a class="el" href="namespacesharp.html#a95fe38384587dd0ca0f08eafa30c0597">RDGAS</a>, <a class="el" href="namespacesharp.html#a21aa81ae76506b5845830b588cbfb993">ROCP</a>, <a class="el" href="namespacesharp.html#a230af88716879ad2bc5cbafef0570e8f">RVGAS</a>, and <a class="el" href="namespacesharp.html#aa8d73d01806950def2c52b818f90cb6c">ZEROCNK</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#aa258841692c25171d3f3b2e8b1f52079">moist_adiabat_cm1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a7494c22424745a8847092b64195fb9ae_cgraph.svg" width="588" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a7494c22424745a8847092b64195fb9ae_icgraph.svg" width="638" height="102"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aae31e8a18568ec26222b603e629c5598" name="aae31e8a18568ec26222b603e629c5598"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae31e8a18568ec26222b603e629c5598">&#9670;&#160;</a></span>buoyancy() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::buoyancy </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pcl_temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>env_temperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compute buoyancy given parcel and environment temperatures </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pcl_temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">env_temperature</td><td>(K)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>buoyancy (m/s^2) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00499">499</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  499</span>                                                             {</div>
<div class="line"><span class="lineno">  500</span>    <span class="keywordflow">return</span> GRAVITY * (pcl_temperature - env_temperature) / (env_temperature);</div>
<div class="line"><span class="lineno">  501</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a6e49daafd469b40abf4197bf26af2097">GRAVITY</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a02c8d90f07b87e0051b2d117da66d11c">buoyancy()</a>, <a class="el" href="namespacesharp.html#a2e6b7cd4a3594a8f2c2050b0e4784cce">effective_inflow_layer()</a>, <a class="el" href="structsharp_1_1Parcel.html#aa258d27992d22d8b80cb221e6e2a6c19">sharp::Parcel::most_unstable_parcel()</a>, and <a class="el" href="thermo__wrap_8h.html#a0773efaf4b0c3b69bc8349f1eee0292b">sharp_buoyancy()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_aae31e8a18568ec26222b603e629c5598_icgraph.svg" width="574" height="215"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a02c8d90f07b87e0051b2d117da66d11c" name="a02c8d90f07b87e0051b2d117da66d11c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02c8d90f07b87e0051b2d117da66d11c">&#9670;&#160;</a></span>buoyancy() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sharp::buoyancy </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pcl_temperature</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>env_temperature</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>buoy_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute buoyancy given arrays of parcel &amp; environment temperatures. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pcl_temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">env_temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">buoy_arr</td><td>Output array to fill with buoyancy </td></tr>
    <tr><td class="paramname">N</td><td>Length of arrays </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00503">503</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  504</span>                                                {</div>
<div class="line"><span class="lineno">  505</span>    <span class="keywordflow">for</span> (std::ptrdiff_t k = 0; k &lt; N; ++k) {</div>
<div class="line"><span class="lineno">  506</span>        buoy_arr[k] = <a class="code hl_function" href="namespacesharp.html#aae31e8a18568ec26222b603e629c5598">buoyancy</a>(pcl_temperature[k], env_temperature[k]);</div>
<div class="line"><span class="lineno">  507</span>    }</div>
<div class="line"><span class="lineno">  508</span>}</div>
<div class="ttc" id="anamespacesharp_html_aae31e8a18568ec26222b603e629c5598"><div class="ttname"><a href="namespacesharp.html#aae31e8a18568ec26222b603e629c5598">sharp::buoyancy</a></div><div class="ttdeci">float buoyancy(const float pcl_temperature, const float env_temperature)</div><div class="ttdoc">compute buoyancy given parcel and environment temperatures</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00499">thermo.cpp:499</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#aae31e8a18568ec26222b603e629c5598">buoyancy()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a02c8d90f07b87e0051b2d117da66d11c_cgraph.svg" width="318" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a0cc6e590243b248f4fb44d9b0e1a6400" name="a0cc6e590243b248f4fb44d9b0e1a6400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cc6e590243b248f4fb44d9b0e1a6400">&#9670;&#160;</a></span>buoyancy_dilution_potential()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::buoyancy_dilution_potential </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>mse_bar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>saturation_mse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00523">523</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  524</span>                                                        {</div>
<div class="line"><span class="lineno">  525</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordflow">if</span> ((temperature == MISSING) || (mse_bar == MISSING) ||</div>
<div class="line"><span class="lineno">  527</span>        (saturation_mse == MISSING)) {</div>
<div class="line"><span class="lineno">  528</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  529</span>    }</div>
<div class="line"><span class="lineno">  530</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordflow">return</span> -1.0f * (GRAVITY / (CP_DRYAIR * temperature)) *</div>
<div class="line"><span class="lineno">  532</span>           (mse_bar - saturation_mse);</div>
<div class="line"><span class="lineno">  533</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#afda77fe7a6cefaab1ecb404167ed90b4">CP_DRYAIR</a>, <a class="el" href="namespacesharp.html#a6e49daafd469b40abf4197bf26af2097">GRAVITY</a>, and <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, and <a class="el" href="thermo__wrap_8h.html#a4e1c678b7a2b984c0d980d7322cfc2aa">sharp_buoyancy_dilution_potential()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a0cc6e590243b248f4fb44d9b0e1a6400_icgraph.svg" width="659" height="102"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="adc84f46d1ec5872b1777857983bdb4be" name="adc84f46d1ec5872b1777857983bdb4be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc84f46d1ec5872b1777857983bdb4be">&#9670;&#160;</a></span>components_to_vector() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1WindVector.html">WindVector</a> sharp::components_to_vector </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>u_comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>v_comp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Conveniance function to compute wind speed and direction from components. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Given the zonal (U) and meridional (V) components of a vector, compute and return the wind speed (m/s) and direction (degrees from North) from the components as a struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u_comp</td><td>(m/s) </td></tr>
    <tr><td class="paramname">v_comp</td><td>(m/s)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{wind_speed, wind_direction} </dd></dl>

<p class="definition">Definition at line <a class="el" href="winds_8cpp_source.html#l00066">66</a> of file <a class="el" href="winds_8cpp_source.html">winds.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   66</span>                                                            {</div>
<div class="line"><span class="lineno">   67</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> wind_speed = <a class="code hl_function" href="namespacesharp.html#af887f27accb1a1d656a35abec65cab5f">vector_magnitude</a>(u_comp, v_comp);</div>
<div class="line"><span class="lineno">   68</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> wind_direction = <a class="code hl_function" href="namespacesharp.html#a24ba1a17b591165e527fa9bf6156eed2">vector_angle</a>(u_comp, v_comp);</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordflow">return</span> {wind_speed, wind_direction};</div>
<div class="line"><span class="lineno">   71</span>}</div>
<div class="ttc" id="anamespacesharp_html_a24ba1a17b591165e527fa9bf6156eed2"><div class="ttname"><a href="namespacesharp.html#a24ba1a17b591165e527fa9bf6156eed2">sharp::vector_angle</a></div><div class="ttdeci">float vector_angle(float u_comp, float v_comp)</div><div class="ttdoc">Computes the direction (degrees from North) a vector points to.</div><div class="ttdef"><b>Definition:</b> <a href="winds_8cpp_source.html#l00039">winds.cpp:39</a></div></div>
<div class="ttc" id="anamespacesharp_html_af887f27accb1a1d656a35abec65cab5f"><div class="ttname"><a href="namespacesharp.html#af887f27accb1a1d656a35abec65cab5f">sharp::vector_magnitude</a></div><div class="ttdeci">float vector_magnitude(float u_comp, float v_comp)</div><div class="ttdoc">Computes the magnitude of a vector given its components.</div><div class="ttdef"><b>Definition:</b> <a href="winds_8cpp_source.html#l00052">winds.cpp:52</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a24ba1a17b591165e527fa9bf6156eed2">vector_angle()</a>, and <a class="el" href="namespacesharp.html#af887f27accb1a1d656a35abec65cab5f">vector_magnitude()</a>.</p>

<p class="reference">Referenced by <a class="el" href="winds__wrap_8h.html#a231e607727d73e68fe9ec62d7d3c45f1">sharp_components_to_vector()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_adc84f46d1ec5872b1777857983bdb4be_cgraph.svg" width="410" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_adc84f46d1ec5872b1777857983bdb4be_icgraph.svg" width="391" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad2ceb7b2c34f95d4333e24bd2b824b6a" name="ad2ceb7b2c34f95d4333e24bd2b824b6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2ceb7b2c34f95d4333e24bd2b824b6a">&#9670;&#160;</a></span>components_to_vector() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1WindVector.html">WindVector</a> sharp::components_to_vector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a>&#160;</td>
          <td class="paramname"><em>comp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Conveniance function to compute wind speed and direction from components. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Given the components of a vector via <a class="el" href="structsharp_1_1WindComponents.html" title="A simple structure of two names floats that represent the components of a wind vector.">sharp::WindComponents</a>, compute and return the wind speed (m/s) and direction (degrees from North) and return them as <a class="el" href="structsharp_1_1WindVector.html" title="A simple structure of two named floats that represent a wind vector.">sharp::WindVector</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comp</td><td>{u_comp, v_comp}</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{wind_speed, wind_direction} </dd></dl>

<p class="definition">Definition at line <a class="el" href="winds_8cpp_source.html#l00073">73</a> of file <a class="el" href="winds_8cpp_source.html">winds.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>                                                     {</div>
<div class="line"><span class="lineno">   74</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> wind_speed = <a class="code hl_function" href="namespacesharp.html#af887f27accb1a1d656a35abec65cab5f">vector_magnitude</a>(comp.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">u</a>, comp.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">v</a>);</div>
<div class="line"><span class="lineno">   75</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> wind_direction = <a class="code hl_function" href="namespacesharp.html#a24ba1a17b591165e527fa9bf6156eed2">vector_angle</a>(comp.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">u</a>, comp.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">v</a>);</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">return</span> {wind_speed, wind_direction};</div>
<div class="line"><span class="lineno">   78</span>}</div>
<div class="ttc" id="astructsharp_1_1WindComponents_html_a22a9ed9c3191bd7ff6b9235b3adb846e"><div class="ttname"><a href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">sharp::WindComponents::u</a></div><div class="ttdeci">float u</div><div class="ttdoc">The zonal (U) component of a wind vector.</div><div class="ttdef"><b>Definition:</b> <a href="winds_8h_source.html#l00052">winds.h:52</a></div></div>
<div class="ttc" id="astructsharp_1_1WindComponents_html_aff73fe4ca73b059b4b655358aa782b45"><div class="ttname"><a href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">sharp::WindComponents::v</a></div><div class="ttdeci">float v</div><div class="ttdoc">The meridional (V) component of a wind vector.</div><div class="ttdef"><b>Definition:</b> <a href="winds_8h_source.html#l00056">winds.h:56</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">sharp::WindComponents::u</a>, <a class="el" href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">sharp::WindComponents::v</a>, <a class="el" href="namespacesharp.html#a24ba1a17b591165e527fa9bf6156eed2">vector_angle()</a>, and <a class="el" href="namespacesharp.html#af887f27accb1a1d656a35abec65cab5f">vector_magnitude()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ad2ceb7b2c34f95d4333e24bd2b824b6a_cgraph.svg" width="410" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ae4385866921cd7286946d9ffdd65c25e" name="ae4385866921cd7286946d9ffdd65c25e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4385866921cd7286946d9ffdd65c25e">&#9670;&#160;</a></span>drylift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sharp::drylift </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dewpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>pressure_at_lcl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>temperature_at_lcl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lift a parcel dry adiabatically to its Lifted Condensation Level (LCL). </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>Given a parcel's initial pressure (Pa), temperature (K), and dewpoint temperature (K), lift the parcel dry adiabatically to its Lifted Condensation Level and store the resulting LCL pressure (Pa) and LCL temperature (K) in the variables passed by reference to the routine.</p>
<p>The LCL temperature is computed using an approximation. See the <a class="el" href="namespacesharp.html#af016701e4a46d5c04d26c0a09c0aad38" title="Compute the temperature of the LCL.">sharp::lcl_temperature</a> documentation for more information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">dewpoint</td><td>(K) </td></tr>
    <tr><td class="paramname">pressure_at_lcl</td><td>(Pa)</td></tr>
    <tr><td class="paramname">temperature_at_lcl</td><td>(K) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00344">344</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  345</span>                                                                {</div>
<div class="line"><span class="lineno">  346</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  347</span>    <span class="keywordflow">if</span> ((pressure == MISSING) || (temperature == MISSING) ||</div>
<div class="line"><span class="lineno">  348</span>        (dewpoint == MISSING)) {</div>
<div class="line"><span class="lineno">  349</span>        pressure_at_lcl = MISSING;</div>
<div class="line"><span class="lineno">  350</span>        temperature_at_lcl = MISSING;</div>
<div class="line"><span class="lineno">  351</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  352</span>    }</div>
<div class="line"><span class="lineno">  353</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>    <span class="comment">// theta is constant from parcel level to LCL</span></div>
<div class="line"><span class="lineno">  356</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> pcl_theta = theta(pressure, temperature, THETA_REF_PRESSURE);</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>    temperature_at_lcl = lcl_temperature(temperature, dewpoint);</div>
<div class="line"><span class="lineno">  359</span>    pressure_at_lcl = theta_level(pcl_theta, temperature_at_lcl);</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">if</span> (pressure_at_lcl &gt; pressure) pressure_at_lcl = pressure;</div>
<div class="line"><span class="lineno">  362</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  363</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af016701e4a46d5c04d26c0a09c0aad38">lcl_temperature()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, <a class="el" href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">theta()</a>, <a class="el" href="namespacesharp.html#ab50b565bcba73d207dc1433dee5b03c9">theta_level()</a>, and <a class="el" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">THETA_REF_PRESSURE</a>.</p>

<p class="reference">Referenced by <a class="el" href="structsharp_1_1Parcel.html#a9523de2b8b4c28ca49fba3013f94cb06">sharp::Parcel::lift_parcel()</a>, <a class="el" href="thermo__wrap_8h.html#a977ee5735b66a0a0b9d74f3325a0041e">sharp_drylift()</a>, <a class="el" href="namespacesharp.html#a5e3156aa7f5bafbd908184c7f51927ee">theta_wetbulb()</a>, <a class="el" href="namespacesharp.html#ab06f16aa1caac3136e863db8cd61e2e9">thetae()</a>, and <a class="el" href="namespacesharp.html#accda9c75278f1a32978bbfd662492822">wetbulb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ae4385866921cd7286946d9ffdd65c25e_cgraph.svg" width="332" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ae4385866921cd7286946d9ffdd65c25e_icgraph.svg" width="755" height="312"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2e6b7cd4a3594a8f2c2050b0e4784cce" name="a2e6b7cd4a3594a8f2c2050b0e4784cce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e6b7cd4a3594a8f2c2050b0e4784cce">&#9670;&#160;</a></span>effective_inflow_layer() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Lifter &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> sharp::effective_inflow_layer </td>
          <td>(</td>
          <td class="paramtype">Lifter &amp;&#160;</td>
          <td class="paramname"><em>lifter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>temperature</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>dewpoint</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>virtemp_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pcl_vtmpk_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>buoy_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>cape_thresh</em> = <code>100.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>cinh_thresh</em> = <code>-250.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsharp_1_1Parcel.html">Parcel</a> *&#160;</td>
          <td class="paramname"><em>mupcl</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the Effective Inflow Layer for a given atmospheric sounding. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes the Effective Inflow Layer, or the layer of the atmosphere believed to be the primary source of inflow for supercell thunderstorms. The Effective Inflow Layer, and its use in computing shear and storm relative helicity, is described by Thompson et al. 2007: <a href="https://www.spc.noaa.gov/publications/thompson/effective.pdf">https://www.spc.noaa.gov/publications/thompson/effective.pdf</a></p>
<p>Standard/default values for cape_thresh and cinh_thresh have been experimentally determined to be cape_thresh = 100 J/kg and cinh_thresh = -250 J/kg. If a pointer to a parcel object is passed as the last arguments, the most ustanble parcel found during the EIL search will be returned to that pointer.</p>
<p>All arrays are treated as inputs (and expected to be precomputed) except for the buoyancy array. It is more accurately meant to be an empty buffer array that can be used to hold buoyancy values during parcel lifting and integration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lifter</td><td>(parcel lifting functor) </td></tr>
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">height</td><td>(meters) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">dewpoint</td><td>(K) </td></tr>
    <tr><td class="paramname">virtemp_arr</td><td>(K) </td></tr>
    <tr><td class="paramname">pcl_vtmpk_arr</td><td>(K) </td></tr>
    <tr><td class="paramname">buoy_arr</td><td>(m/s^2) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays) </td></tr>
    <tr><td class="paramname">cape_thresh</td><td>(J/kg; default=100.0) </td></tr>
    <tr><td class="paramname">cinh_thresh</td><td>(J/kg; default=-250.0) </td></tr>
    <tr><td class="paramname">mupcl</td><td>(store the most unstable parcel; defualt=nullptr)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{bottom, top} </dd></dl>

<p class="definition">Definition at line <a class="el" href="convective_8h_source.html#l00063">63</a> of file <a class="el" href="convective_8h_source.html">convective.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   68</span>                                                               {</div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordtype">int</span> eff_kbot = 0;</div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordtype">float</span> eff_pbot = MISSING;</div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordtype">float</span> eff_ptop = MISSING;</div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordtype">float</span> sfc_hght = <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[0];</div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_struct" href="structsharp_1_1Parcel.html">Parcel</a> maxpcl;</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>    <span class="comment">// search for the effective inflow bottom</span></div>
<div class="line"><span class="lineno">   76</span>    <span class="keywordflow">for</span> (std::ptrdiff_t k = 0; k &lt; N; ++k) {</div>
<div class="line"><span class="lineno">   77</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   78</span>        <span class="keywordflow">if</span> ((temperature[k] == MISSING) || (dewpoint[k] == MISSING)) {</div>
<div class="line"><span class="lineno">   79</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   80</span>        }</div>
<div class="line"><span class="lineno">   81</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   82</span>        Parcel effpcl(pressure[k], temperature[k], dewpoint[k], LPL::MU);</div>
<div class="line"><span class="lineno">   83</span>        <span class="comment">// We don&#39;t want to lift every single profile...</span></div>
<div class="line"><span class="lineno">   84</span>        <span class="keywordflow">if</span> (height[k] - sfc_hght &gt; 4000.0) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>        effpcl.lift_parcel(lifter, pressure, pcl_vtmpk_arr, N);</div>
<div class="line"><span class="lineno">   87</span>        buoyancy(pcl_vtmpk_arr, virtemp_arr, buoy_arr, N);</div>
<div class="line"><span class="lineno">   88</span>        effpcl.cape_cinh(pressure, height, buoy_arr, N);</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>        <span class="keywordflow">if</span> (effpcl.cape &gt; maxpcl.<a class="code hl_variable" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">cape</a>) maxpcl = effpcl;</div>
<div class="line"><span class="lineno">   91</span>        <span class="keywordflow">if</span> ((effpcl.cape &gt;= cape_thresh) &amp;&amp; (effpcl.cinh &gt;= cinh_thresh)) {</div>
<div class="line"><span class="lineno">   92</span>            eff_pbot = effpcl.<a class="code hl_variable" href="structsharp_1_1Parcel.html#acdce27acf6bd8a327993f5d4cf240906">pres</a>;</div>
<div class="line"><span class="lineno">   93</span>            eff_kbot = k;</div>
<div class="line"><span class="lineno">   94</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   95</span>        }</div>
<div class="line"><span class="lineno">   96</span>    }</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">if</span> (eff_pbot == MISSING) <span class="keywordflow">return</span> {MISSING, MISSING};</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">for</span> (std::ptrdiff_t k = eff_kbot + 1; k &lt; N; ++k) {</div>
<div class="line"><span class="lineno">  101</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  102</span>        <span class="keywordflow">if</span> ((temperature[k] == MISSING) || (dewpoint[k] == MISSING)) {</div>
<div class="line"><span class="lineno">  103</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  104</span>        }</div>
<div class="line"><span class="lineno">  105</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  106</span>        Parcel effpcl(pressure[k], temperature[k], dewpoint[k], LPL::MU);</div>
<div class="line"><span class="lineno">  107</span>        effpcl.lift_parcel(lifter, pressure, pcl_vtmpk_arr, N);</div>
<div class="line"><span class="lineno">  108</span>        <a class="code hl_function" href="namespacesharp.html#aae31e8a18568ec26222b603e629c5598">buoyancy</a>(pcl_vtmpk_arr, virtemp_arr, buoy_arr, N);</div>
<div class="line"><span class="lineno">  109</span>        effpcl.cape_cinh(pressure, height, buoy_arr, N);</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>        <span class="keywordflow">if</span> (effpcl.cape &gt; maxpcl.<a class="code hl_variable" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">cape</a>) maxpcl = effpcl;</div>
<div class="line"><span class="lineno">  112</span>        <span class="keywordflow">if</span> ((effpcl.cape &lt; cape_thresh) || (effpcl.cinh &lt; cinh_thresh)) {</div>
<div class="line"><span class="lineno">  113</span>            eff_ptop = effpcl.<a class="code hl_variable" href="structsharp_1_1Parcel.html#acdce27acf6bd8a327993f5d4cf240906">pres</a>;</div>
<div class="line"><span class="lineno">  114</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  115</span>        }</div>
<div class="line"><span class="lineno">  116</span>    }</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">if</span> (eff_ptop == MISSING) <span class="keywordflow">return</span> {MISSING, MISSING};</div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordflow">if</span> (mupcl) *mupcl = maxpcl;</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">return</span> {eff_pbot, eff_ptop};</div>
<div class="line"><span class="lineno">  121</span>}</div>
<div class="ttc" id="astructsharp_1_1Parcel_html"><div class="ttname"><a href="structsharp_1_1Parcel.html">sharp::Parcel</a></div><div class="ttdoc">Data that defines a Parcel, its attributes, and derived quantities.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00232">parcel.h:232</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_abe6f9e3ee98fde1d361814a5d6384b1a"><div class="ttname"><a href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">sharp::Parcel::cape</a></div><div class="ttdeci">float cape</div><div class="ttdoc">Parcel Convective Available Potential Energy (J/kg) between the LFC and EL.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00267">parcel.h:267</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_acdce27acf6bd8a327993f5d4cf240906"><div class="ttname"><a href="structsharp_1_1Parcel.html#acdce27acf6bd8a327993f5d4cf240906">sharp::Parcel::pres</a></div><div class="ttdeci">float pres</div><div class="ttdoc">Parcel starting pressure (Pa)</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00236">parcel.h:236</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#aae31e8a18568ec26222b603e629c5598">buoyancy()</a>, <a class="el" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">sharp::Parcel::cape</a>, <a class="el" href="structsharp_1_1Parcel.html#a0560bd193b2d2d6bc6b08baa7463fba4">sharp::Parcel::cape_cinh()</a>, <a class="el" href="structsharp_1_1Parcel.html#af2f4106c560b37ed8d13c3f272fa68a4">sharp::Parcel::cinh</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="structsharp_1_1Parcel.html#a9523de2b8b4c28ca49fba3013f94cb06">sharp::Parcel::lift_parcel()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997fae5919ba9cf2e803bdbc98334a7f64daa">MU</a>, <a class="el" href="structsharp_1_1Parcel.html#acdce27acf6bd8a327993f5d4cf240906">sharp::Parcel::pres</a>, and <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>.</p>

<p class="reference">Referenced by <a class="el" href="convective__wrap_8h.html#af214bab6c6ba14dc06fe7df4f6abcdf8">sharp_effective_inflow_layer()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a2e6b7cd4a3594a8f2c2050b0e4784cce_cgraph.svg" width="1222" height="454"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a2e6b7cd4a3594a8f2c2050b0e4784cce_icgraph.svg" width="396" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aa95eb7a4955df00fcb68b2cd624de2fc" name="aa95eb7a4955df00fcb68b2cd624de2fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa95eb7a4955df00fcb68b2cd624de2fc">&#9670;&#160;</a></span>effective_inflow_layer() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> sharp::effective_inflow_layer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1lifter__cm1.html">sharp::lifter_cm1</a> &amp;&#160;</td>
          <td class="paramname"><em>lifter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>temperature</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>dewpoint</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>virtemp_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pcl_vtmpk_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>buoy_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>cape_thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>cinh_thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsharp_1_1Parcel.html">Parcel</a> *&#160;</td>
          <td class="paramname"><em>mupcl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad4acd4077bc73279a9af0011f3f09954" name="ad4acd4077bc73279a9af0011f3f09954"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4acd4077bc73279a9af0011f3f09954">&#9670;&#160;</a></span>effective_inflow_layer() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> sharp::effective_inflow_layer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1lifter__wobus.html">sharp::lifter_wobus</a> &amp;&#160;</td>
          <td class="paramname"><em>lifter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>temperature</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>dewpoint</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>virtemp_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pcl_vtmpk_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>buoy_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>cape_thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>cinh_thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsharp_1_1Parcel.html">Parcel</a> *&#160;</td>
          <td class="paramname"><em>mupcl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab89a7e3555a52f0fd9f4086d5aba7037" name="ab89a7e3555a52f0fd9f4086d5aba7037"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab89a7e3555a52f0fd9f4086d5aba7037">&#9670;&#160;</a></span>energy_helicity_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::energy_helicity_index </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>cape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>helicity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="convective_8cpp_source.html#l00223">223</a> of file <a class="el" href="convective_8cpp_source.html">convective.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  223</span>                                                        {</div>
<div class="line"><span class="lineno">  224</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">if</span> ((cape == MISSING) || (helicity == MISSING)) {</div>
<div class="line"><span class="lineno">  226</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  227</span>    }</div>
<div class="line"><span class="lineno">  228</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  229</span>    <span class="keywordflow">return</span> (cape * helicity) / 160000.0f;</div>
<div class="line"><span class="lineno">  230</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a80858337a63be77bafadbb343d6e4931">helicity()</a>, and <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>.</p>

<p class="reference">Referenced by <a class="el" href="convective__wrap_8h.html#a8fa4a371ff32e44fd39e0703eab33a74">sharp_energy_helicity_index()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab89a7e3555a52f0fd9f4086d5aba7037_cgraph.svg" width="911" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab89a7e3555a52f0fd9f4086d5aba7037_icgraph.svg" width="391" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a72bbdc4cfe7895dd51981902ac9fc822" name="a72bbdc4cfe7895dd51981902ac9fc822"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72bbdc4cfe7895dd51981902ac9fc822">&#9670;&#160;</a></span>entrainment_cape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::entrainment_cape </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>temperature</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>mse_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>u_wind</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>v_wind</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsharp_1_1Parcel.html">Parcel</a> *&#160;</td>
          <td class="paramname"><em>pcl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes Entrainment CAPE using a previously lifted parcel. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes Entrainment CAPE, or ECAPE, as described by Peters et al. 2023, "An analytic formula for entraining CAPE in mid-latitude storm environments".</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">height</td><td>(meters) </td></tr>
    <tr><td class="paramname">temperature</td><td>(degK) </td></tr>
    <tr><td class="paramname">mse_arr</td><td>() </td></tr>
    <tr><td class="paramname">u_wind</td><td>(m/s) </td></tr>
    <tr><td class="paramname">v_wind</td><td>(m/s) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays) </td></tr>
    <tr><td class="paramname">pcl</td><td>(Precomputed parcel)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ECAPE </dd></dl>

<p class="definition">Definition at line <a class="el" href="convective_8cpp_source.html#l00123">123</a> of file <a class="el" href="convective_8cpp_source.html">convective.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  126</span>                                                          {</div>
<div class="line"><span class="lineno">  127</span>    <span class="comment">// if cape is zero, we get a divide by zero issue later.</span></div>
<div class="line"><span class="lineno">  128</span>    <span class="comment">// there can &quot;technically&quot; be LFC/EL without CAPE because of very,</span></div>
<div class="line"><span class="lineno">  129</span>    <span class="comment">// very shallow buoyancy near zero when searching for LFC/EL.</span></div>
<div class="line"><span class="lineno">  130</span>    <span class="comment">// To-Do: maybe refactor LFC/EL search?</span></div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">if</span> ((pcl-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#a55dcb9c777b42c5f35537730c044e004">lfc_pressure</a> == MISSING) || (pcl-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#a55dcb9c777b42c5f35537730c044e004">lfc_pressure</a> == MISSING) ||</div>
<div class="line"><span class="lineno">  132</span>        (pcl-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">cape</a> == 0)) {</div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><span class="lineno">  134</span>    }</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>    <span class="keywordtype">float</span> *mse_diff = <span class="keyword">new</span> <span class="keywordtype">float</span>[N];</div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordtype">float</span> *mse_bar = <span class="keyword">new</span> <span class="keywordtype">float</span>[N];</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>    <span class="comment">// compute MSE_bar</span></div>
<div class="line"><span class="lineno">  140</span>    mse_bar[0] = mse_arr[0];</div>
<div class="line"><span class="lineno">  141</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> psfc = pressure[0];</div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">for</span> (std::ptrdiff_t k = 1; k &lt; N; ++k) {</div>
<div class="line"><span class="lineno">  143</span>        PressureLayer mn_lyr = {psfc, pressure[k]};</div>
<div class="line"><span class="lineno">  144</span>        mse_bar[k] = <a class="code hl_function" href="namespacesharp.html#a298e2c96c389f2c5177d3626c908927e">layer_mean</a>(mn_lyr, pressure, mse_arr, N);</div>
<div class="line"><span class="lineno">  145</span>    }</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    <span class="comment">// compute MSE_star</span></div>
<div class="line"><span class="lineno">  148</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> hsfc = <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[0];</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">for</span> (std::ptrdiff_t k = 0; k &lt; N; ++k) {</div>
<div class="line"><span class="lineno">  150</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> tmpk = temperature[k];</div>
<div class="line"><span class="lineno">  151</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> rsat = <a class="code hl_function" href="namespacesharp.html#ac38870166f07ac30aadbc46b81340cc4">mixratio</a>(pressure[k], tmpk);</div>
<div class="line"><span class="lineno">  152</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> qsat = <a class="code hl_function" href="namespacesharp.html#a792a4a2a9f9243a82fb44cb77c2ee561">specific_humidity</a>(rsat);</div>
<div class="line"><span class="lineno">  153</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> height_agl = <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[k] - hsfc;</div>
<div class="line"><span class="lineno">  154</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> mse_star = <a class="code hl_function" href="namespacesharp.html#ab5fed65fe0cdf797961047fb9cde3295">moist_static_energy</a>(height_agl, tmpk, qsat);</div>
<div class="line"><span class="lineno">  155</span>        mse_diff[k] = <a class="code hl_function" href="namespacesharp.html#a0cc6e590243b248f4fb44d9b0e1a6400">buoyancy_dilution_potential</a>(tmpk, mse_bar[k], mse_star);</div>
<div class="line"><span class="lineno">  156</span>    }</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    <span class="comment">// compute NCAPE</span></div>
<div class="line"><span class="lineno">  159</span>    PressureLayer plyr = {pcl-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#a55dcb9c777b42c5f35537730c044e004">lfc_pressure</a>, pcl-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#ac76710675fd2f495d52ac35d0d1de246">eql_pressure</a>};</div>
<div class="line"><span class="lineno">  160</span>    HeightLayer hlyr = <a class="code hl_function" href="namespacesharp.html#a31da980f398c9f6a5960ddf868101a94">pressure_layer_to_height</a>(plyr, pressure, height, N);</div>
<div class="line"><span class="lineno">  161</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> NCAPE = <a class="code hl_function" href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">integrate_layer_trapz</a>(hlyr, mse_diff, height, N);</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    <span class="comment">// Compute the Bunkers non-parcel based storm motion</span></div>
<div class="line"><span class="lineno">  164</span>    WindComponents strm_mtn =</div>
<div class="line"><span class="lineno">  165</span>        <a class="code hl_function" href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">storm_motion_bunkers</a>(pressure, height, u_wind, v_wind, N, {0.0, 6000.0},</div>
<div class="line"><span class="lineno">  166</span>                             {0.0, 6000.0}, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    <span class="comment">// get the mean 0-1km storm relative wind</span></div>
<div class="line"><span class="lineno">  169</span>    HeightLayer layer = {hsfc + 0.0f, hsfc + 1000.0f};</div>
<div class="line"><span class="lineno">  170</span>    LayerIndex layer_idx = <a class="code hl_function" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index</a>(layer, height, N);</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    <span class="comment">// loop from the surface to the last level before 1km AGL.</span></div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordtype">float</span> V_sr_mean = 0.0;</div>
<div class="line"><span class="lineno">  174</span>    <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordflow">for</span> (std::ptrdiff_t k = 0; k &lt; layer_idx.ktop + 1; ++k) {</div>
<div class="line"><span class="lineno">  176</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  177</span>        <span class="keywordflow">if</span> ((u_wind[k] == MISSING) || (v_wind[k] == MISSING)) {</div>
<div class="line"><span class="lineno">  178</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  179</span>        }</div>
<div class="line"><span class="lineno">  180</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  181</span>        V_sr_mean +=</div>
<div class="line"><span class="lineno">  182</span>            <a class="code hl_function" href="namespacesharp.html#af887f27accb1a1d656a35abec65cab5f">vector_magnitude</a>(u_wind[k] - strm_mtn.u, v_wind[k] - strm_mtn.v);</div>
<div class="line"><span class="lineno">  183</span>        count += 1;</div>
<div class="line"><span class="lineno">  184</span>    }</div>
<div class="line"><span class="lineno">  185</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> u_1km = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.top, height, u_wind, N);</div>
<div class="line"><span class="lineno">  186</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> v_1km = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.top, height, v_wind, N);</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>    V_sr_mean += <a class="code hl_function" href="namespacesharp.html#af887f27accb1a1d656a35abec65cab5f">vector_magnitude</a>(u_1km - strm_mtn.u, v_1km - strm_mtn.v);</div>
<div class="line"><span class="lineno">  189</span>    V_sr_mean = V_sr_mean / (count + 1);</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>    <span class="comment">// now for all of the ECAPE nonsense</span></div>
<div class="line"><span class="lineno">  192</span>    <span class="keyword">constexpr</span> <span class="keywordtype">float</span> L = 120.0;</div>
<div class="line"><span class="lineno">  193</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> H =</div>
<div class="line"><span class="lineno">  194</span>        <a class="code hl_function" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure</a>(pcl-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#ac76710675fd2f495d52ac35d0d1de246">eql_pressure</a>, pressure, height, N) - hsfc;</div>
<div class="line"><span class="lineno">  195</span>    <span class="keyword">constexpr</span> <span class="keywordtype">float</span> sigma = 1.6;</div>
<div class="line"><span class="lineno">  196</span>    <span class="keyword">constexpr</span> <span class="keywordtype">float</span> alpha = 0.8;</div>
<div class="line"><span class="lineno">  197</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> pitchfork = (VKSQ * (alpha * alpha) * (PI * PI) * L) /</div>
<div class="line"><span class="lineno">  198</span>                            (PRANDTL * (sigma * sigma) * H);</div>
<div class="line"><span class="lineno">  199</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> V_sr_tilde = V_sr_mean / std::sqrt(2.0f * pcl-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">cape</a>);</div>
<div class="line"><span class="lineno">  200</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> V_sr_tilde_sq = V_sr_tilde * V_sr_tilde;</div>
<div class="line"><span class="lineno">  201</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> N_tilde = NCAPE / pcl-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">cape</a>;</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> term1 = pitchfork / V_sr_tilde_sq;</div>
<div class="line"><span class="lineno">  204</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> term2 = 1.0f + pitchfork + term1 * N_tilde;</div>
<div class="line"><span class="lineno">  205</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> term3 = 4.0f * term1 * (1.0f - pitchfork * N_tilde);</div>
<div class="line"><span class="lineno">  206</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> sqrt_term = term2 * term2 + term3;</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>    <span class="comment">// in the case of a negative solution,</span></div>
<div class="line"><span class="lineno">  209</span>    <span class="comment">// set ECAPE to 0;</span></div>
<div class="line"><span class="lineno">  210</span>    <span class="keywordflow">if</span> (sqrt_term &lt; 0) {</div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  212</span>    }</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> E_tilde = V_sr_tilde_sq + (-1.0f - pitchfork - (term1)*N_tilde +</div>
<div class="line"><span class="lineno">  215</span>                                           std::sqrt(sqrt_term)) /</div>
<div class="line"><span class="lineno">  216</span>                                              (2.0f * term1);</div>
<div class="line"><span class="lineno">  217</span>    <span class="keyword">delete</span>[] mse_diff;</div>
<div class="line"><span class="lineno">  218</span>    <span class="keyword">delete</span>[] mse_bar;</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">return</span> E_tilde * pcl-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">cape</a>;</div>
<div class="line"><span class="lineno">  221</span>}</div>
<div class="ttc" id="anamespacesharp_html_a0cc6e590243b248f4fb44d9b0e1a6400"><div class="ttname"><a href="namespacesharp.html#a0cc6e590243b248f4fb44d9b0e1a6400">sharp::buoyancy_dilution_potential</a></div><div class="ttdeci">float buoyancy_dilution_potential(const float temperature, const float mse_bar, const float saturation_mse)</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00523">thermo.cpp:523</a></div></div>
<div class="ttc" id="anamespacesharp_html_a298e2c96c389f2c5177d3626c908927e"><div class="ttname"><a href="namespacesharp.html#a298e2c96c389f2c5177d3626c908927e">sharp::layer_mean</a></div><div class="ttdeci">float layer_mean(PressureLayer layer, const float pressure[], const float data_arr[], const std::ptrdiff_t N)</div><div class="ttdoc">Computes the mass-weighted mean value of a field over a given pressure layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00132">layer.cpp:132</a></div></div>
<div class="ttc" id="anamespacesharp_html_a31da980f398c9f6a5960ddf868101a94"><div class="ttname"><a href="namespacesharp.html#a31da980f398c9f6a5960ddf868101a94">sharp::pressure_layer_to_height</a></div><div class="ttdeci">HeightLayer pressure_layer_to_height(PressureLayer layer, const float pressure[], const float height[], const std::ptrdiff_t N, const bool toAGL=false)</div><div class="ttdoc">Converts a sharp::PressureLayer to a sharp::HeightLayer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00113">layer.cpp:113</a></div></div>
<div class="ttc" id="anamespacesharp_html_a55e4f8ee4ff8a4a30d7b3f3d92a41c75"><div class="ttname"><a href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">sharp::interp_pressure</a></div><div class="ttdeci">float interp_pressure(const float pressure_val, const float pressure_arr[], const float data_arr[], const std::ptrdiff_t N)</div><div class="ttdoc">Linearly interpolate a data field to a requested pressure level.</div><div class="ttdef"><b>Definition:</b> <a href="interp_8cpp_source.html#l00066">interp.cpp:66</a></div></div>
<div class="ttc" id="anamespacesharp_html_a74a735636c932467b4d2ced544e0cb51"><div class="ttname"><a href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">sharp::storm_motion_bunkers</a></div><div class="ttdeci">WindComponents storm_motion_bunkers(const float pressure[], const float height[], const float u_wind[], const float v_wind[], const std::ptrdiff_t N, HeightLayer mean_wind_layer_agl, HeightLayer wind_shear_layer_agl, const bool leftMover=false, const bool pressureWeighted=false)</div><div class="ttdoc">Estimates supercell storm motion using the Bunkers et al. 2000 method.</div><div class="ttdef"><b>Definition:</b> <a href="convective_8cpp_source.html#l00037">convective.cpp:37</a></div></div>
<div class="ttc" id="anamespacesharp_html_a792a4a2a9f9243a82fb44cb77c2ee561"><div class="ttname"><a href="namespacesharp.html#a792a4a2a9f9243a82fb44cb77c2ee561">sharp::specific_humidity</a></div><div class="ttdeci">float specific_humidity(float rv)</div><div class="ttdoc">Compute specific humidity from a mixing ratio.</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00150">thermo.cpp:150</a></div></div>
<div class="ttc" id="anamespacesharp_html_a7acec1642f27591dc988bf9e48b4612d"><div class="ttname"><a href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">sharp::integrate_layer_trapz</a></div><div class="ttdeci">float integrate_layer_trapz(L layer, const float var_array[], const float coord_array[], const std::ptrdiff_t N, const int integ_sign=0, const bool weighted=false)</div><div class="ttdoc">Returns a trapezoidal integration of the given layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00455">layer.h:455</a></div></div>
<div class="ttc" id="anamespacesharp_html_ab5fed65fe0cdf797961047fb9cde3295"><div class="ttname"><a href="namespacesharp.html#ab5fed65fe0cdf797961047fb9cde3295">sharp::moist_static_energy</a></div><div class="ttdeci">float moist_static_energy(float height_agl, float temperature, float specific_humidity)</div><div class="ttdoc">Compute moist static energy.</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00510">thermo.cpp:510</a></div></div>
<div class="ttc" id="anamespacesharp_html_ac38870166f07ac30aadbc46b81340cc4"><div class="ttname"><a href="namespacesharp.html#ac38870166f07ac30aadbc46b81340cc4">sharp::mixratio</a></div><div class="ttdeci">float mixratio(float q)</div><div class="ttdoc">Compute the water vapor mixing ratio from specific humidity.</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00122">thermo.cpp:122</a></div></div>
<div class="ttc" id="anamespacesharp_html_ac93f477dfa774c966b5da7521bd43ee6"><div class="ttname"><a href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">sharp::get_layer_index</a></div><div class="ttdeci">constexpr LayerIndex get_layer_index(L &amp;layer, const float coord[], const std::ptrdiff_t N, const Cb bottom_comp, const Ct top_comp)</div><div class="ttdoc">Returns the array indices corresponding to the given layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00174">layer.h:174</a></div></div>
<div class="ttc" id="anamespacesharp_html_ae8240f026498ad2775633a8d0dcf100d"><div class="ttname"><a href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">sharp::interp_height</a></div><div class="ttdeci">float interp_height(const float height_val, const float height_arr[], const float data_arr[], const std::ptrdiff_t N)</div><div class="ttdoc">Linearly interpolate a data field to a requested height level.</div><div class="ttdef"><b>Definition:</b> <a href="interp_8cpp_source.html#l00023">interp.cpp:23</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_a55dcb9c777b42c5f35537730c044e004"><div class="ttname"><a href="structsharp_1_1Parcel.html#a55dcb9c777b42c5f35537730c044e004">sharp::Parcel::lfc_pressure</a></div><div class="ttdeci">float lfc_pressure</div><div class="ttdoc">Pressure at the Level of Free Convection (Pa)</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00256">parcel.h:256</a></div></div>
<div class="ttc" id="astructsharp_1_1Parcel_html_ac76710675fd2f495d52ac35d0d1de246"><div class="ttname"><a href="structsharp_1_1Parcel.html#ac76710675fd2f495d52ac35d0d1de246">sharp::Parcel::eql_pressure</a></div><div class="ttdeci">float eql_pressure</div><div class="ttdoc">Pressure at the parcel Equilibrium Level (Pa)</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00261">parcel.h:261</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a0cc6e590243b248f4fb44d9b0e1a6400">buoyancy_dilution_potential()</a>, <a class="el" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">sharp::Parcel::cape</a>, <a class="el" href="structsharp_1_1Parcel.html#ac76710675fd2f495d52ac35d0d1de246">sharp::Parcel::eql_pressure</a>, <a class="el" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index()</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">integrate_layer_trapz()</a>, <a class="el" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height()</a>, <a class="el" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure()</a>, <a class="el" href="structsharp_1_1LayerIndex.html#a849a04de93753261c91c58b590e60ee2">sharp::LayerIndex::ktop</a>, <a class="el" href="namespacesharp.html#a298e2c96c389f2c5177d3626c908927e">layer_mean()</a>, <a class="el" href="structsharp_1_1Parcel.html#a55dcb9c777b42c5f35537730c044e004">sharp::Parcel::lfc_pressure</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#ac38870166f07ac30aadbc46b81340cc4">mixratio()</a>, <a class="el" href="namespacesharp.html#ab5fed65fe0cdf797961047fb9cde3295">moist_static_energy()</a>, <a class="el" href="namespacesharp.html#a36f9a81a6f5f2f96e2e34b5607b8a3da">PI</a>, <a class="el" href="namespacesharp.html#a9390aa610ba3e66b2e8f84c4261c49af">PRANDTL</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, <a class="el" href="namespacesharp.html#a31da980f398c9f6a5960ddf868101a94">pressure_layer_to_height()</a>, <a class="el" href="namespacesharp.html#a792a4a2a9f9243a82fb44cb77c2ee561">specific_humidity()</a>, <a class="el" href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">storm_motion_bunkers()</a>, <a class="el" href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">sharp::WindComponents::u</a>, <a class="el" href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">sharp::WindComponents::v</a>, <a class="el" href="namespacesharp.html#af887f27accb1a1d656a35abec65cab5f">vector_magnitude()</a>, and <a class="el" href="namespacesharp.html#aee70f2aa7bfda20363d82e6eef5b1a21">VKSQ</a>.</p>

<p class="reference">Referenced by <a class="el" href="convective__wrap_8h.html#ab0bfb728bbbf3a731c330b61a5c415ad">sharp_entrainment_cape()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a72bbdc4cfe7895dd51981902ac9fc822_cgraph.svg" width="1231" height="658"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a72bbdc4cfe7895dd51981902ac9fc822_icgraph.svg" width="426" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4a8e42ed2ba834a1436242e320492bbc" name="a4a8e42ed2ba834a1436242e320492bbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a8e42ed2ba834a1436242e320492bbc">&#9670;&#160;</a></span>get_layer_index() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1LayerIndex.html">LayerIndex</a> sharp::get_layer_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a> &amp;&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the array indices corresponding to the given <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Returns the array indices corresponding to the given <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>, and performs bounds checking on the layer. As part of the bounds checking, the <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a> is modified if the bottom or top of the layer is out of bounds, which is why it gets passed as a reference.</p>
<p>If the exact values of the top and bottom of the layer are present, their indices are ignored. The default behavior is that the bottom and top of a layer is computed by interpolation by default, since it may or may not be present in the native data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>{bottom, top} </td></tr>
    <tr><td class="paramname">height</td><td>(meters) </td></tr>
    <tr><td class="paramname">N</td><td>(length of array)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{kbot, ktop} </dd></dl>

<p class="definition">Definition at line <a class="el" href="layer_8cpp_source.html#l00085">85</a> of file <a class="el" href="layer_8cpp_source.html">layer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   86</span>                                                 {</div>
<div class="line"><span class="lineno">   87</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">auto</span> bottom_comp = std::less&lt;float&gt;();</div>
<div class="line"><span class="lineno">   88</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">auto</span> top_comp = std::greater&lt;float&gt;();</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index</a>(layer, height, N, bottom_comp, top_comp);</div>
<div class="line"><span class="lineno">   91</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index()</a>, and <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a4a8e42ed2ba834a1436242e320492bbc_cgraph.svg" width="599" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ac93f477dfa774c966b5da7521bd43ee6" name="ac93f477dfa774c966b5da7521bd43ee6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac93f477dfa774c966b5da7521bd43ee6">&#9670;&#160;</a></span>get_layer_index() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename L , typename Cb , typename Ct &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="structsharp_1_1LayerIndex.html">LayerIndex</a> sharp::get_layer_index </td>
          <td>(</td>
          <td class="paramtype">L &amp;&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>coord</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Cb&#160;</td>
          <td class="paramname"><em>bottom_comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ct&#160;</td>
          <td class="paramname"><em>top_comp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the array indices corresponding to the given layer. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>This template function encapsulates the algorithm that both bounds checks layer operations and returns the array indices to the corresponding coordinate array, excluding the top and bottom of the layer. Specifically, the <a class="el" href="structsharp_1_1LayerIndex.html" title="A simple structure of two named integer indices for the top and bottom of a layer.">LayerIndex</a> is [bottom, top] exclusive, and can be interpreted as the interior range the layer bounds. This behaviour is due to the fact many algorithms used will get the interpolated top and bottom values of the layer, meaning for looping purposes we only want the inner range of indices.</p>
<p>NOTE: If layer.bottom or layer.top are out of bounds, this function will truncate the layer to the coordinate range of data provided by coord[] in an attempt to gracefully continue and produce a result. This will modify the layer and is why it is passed as a reference. If you do not wish to have this behavior, it is up to the user to ensure they assign meaningful values to the layers and not request data out of bounds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>{bottom, top} </td></tr>
    <tr><td class="paramname">coord</td><td>(height or pressure) </td></tr>
    <tr><td class="paramname">N</td><td>(length of array) </td></tr>
    <tr><td class="paramname">bottom_comp</td><td>(function comparing the layer bottom to coord array) </td></tr>
    <tr><td class="paramname">top_comp</td><td>(function comparing the layer top to coord array)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{kbot, ktop} </dd></dl>

<p class="definition">Definition at line <a class="el" href="layer_8h_source.html#l00174">174</a> of file <a class="el" href="layer_8h_source.html">layer.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  178</span>                                                                      {</div>
<div class="line"><span class="lineno">  179</span>    <span class="comment">// bounds check out search!</span></div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">if</span> (bottom_comp(layer.bottom, coord[0])) {</div>
<div class="line"><span class="lineno">  181</span>        layer.bottom = coord[0];</div>
<div class="line"><span class="lineno">  182</span>    }</div>
<div class="line"><span class="lineno">  183</span>    <span class="keywordflow">if</span> (top_comp(layer.top, coord[N - 1])) {</div>
<div class="line"><span class="lineno">  184</span>        layer.top = coord[N - 1];</div>
<div class="line"><span class="lineno">  185</span>    }</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>    <span class="comment">// whether pressure or height coordiantes, the bottom</span></div>
<div class="line"><span class="lineno">  188</span>    <span class="comment">// comparitor passed to the function will determine</span></div>
<div class="line"><span class="lineno">  189</span>    <span class="comment">// how to search</span></div>
<div class="line"><span class="lineno">  190</span>    std::ptrdiff_t lower_idx = <a class="code hl_function" href="namespacesharp.html#a1edcf8bff9a13429bcbff7c1129024b3">lower_bound</a>(coord, N, layer.bottom, bottom_comp);</div>
<div class="line"><span class="lineno">  191</span>    std::ptrdiff_t upper_idx = <a class="code hl_function" href="namespacesharp.html#a772686549a5111c1152b778731119aa6">upper_bound</a>(coord, N, layer.top, bottom_comp);</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>    <span class="comment">// If the layer top is in between two levels, this check ensures</span></div>
<div class="line"><span class="lineno">  194</span>    <span class="comment">// that our index is below the top for interpolation reasons</span></div>
<div class="line"><span class="lineno">  195</span>    upper_idx -= ((top_comp(coord[upper_idx], layer.top)) &amp; (upper_idx &gt; 0));</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>    <span class="keywordflow">return</span> {lower_idx, upper_idx};</div>
<div class="line"><span class="lineno">  198</span>}</div>
<div class="ttc" id="anamespacesharp_html_a1edcf8bff9a13429bcbff7c1129024b3"><div class="ttname"><a href="namespacesharp.html#a1edcf8bff9a13429bcbff7c1129024b3">sharp::lower_bound</a></div><div class="ttdeci">constexpr std::ptrdiff_t lower_bound(const T array[], const std::ptrdiff_t N, const T value, const C cmp=C{})</div><div class="ttdoc">Finds the index of the lower bound that does not satisfy element &lt; value.</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_8h_source.html#l00050">algorithms.h:50</a></div></div>
<div class="ttc" id="anamespacesharp_html_a772686549a5111c1152b778731119aa6"><div class="ttname"><a href="namespacesharp.html#a772686549a5111c1152b778731119aa6">sharp::upper_bound</a></div><div class="ttdeci">constexpr std::ptrdiff_t upper_bound(const T array[], const std::ptrdiff_t N, const T value, const C cmp=C{})</div><div class="ttdoc">Finds the first index that satisfies value &lt; element.</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_8h_source.html#l00091">algorithms.h:91</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a1edcf8bff9a13429bcbff7c1129024b3">lower_bound()</a>, and <a class="el" href="namespacesharp.html#a772686549a5111c1152b778731119aa6">upper_bound()</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, <a class="el" href="structsharp_1_1Parcel.html#a8a311e09b1d46a829212da94cf181537">sharp::Parcel::find_lfc_el()</a>, <a class="el" href="namespacesharp.html#ac2f381378ac4ec13ad83d2ec92b2abcc">get_layer_index()</a>, <a class="el" href="namespacesharp.html#a80858337a63be77bafadbb343d6e4931">helicity()</a>, <a class="el" href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">integrate_layer_trapz()</a>, <a class="el" href="namespacesharp.html#a646b65095b84511b75f6a4a81e545e80">layer_minmax()</a>, <a class="el" href="structsharp_1_1Parcel.html#a9523de2b8b4c28ca49fba3013f94cb06">sharp::Parcel::lift_parcel()</a>, <a class="el" href="structsharp_1_1Parcel.html#aa258d27992d22d8b80cb221e6e2a6c19">sharp::Parcel::most_unstable_parcel()</a>, <a class="el" href="layer__wrap_8h.html#acf8af4f5e6a076c89e360b63fe2eef35">sharp_get_HeightLayer_index()</a>, and <a class="el" href="layer__wrap_8h.html#a49613289ae250448f602b6a4332a8ac4">sharp_get_PressureLayer_index()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ac93f477dfa774c966b5da7521bd43ee6_cgraph.svg" width="380" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ac93f477dfa774c966b5da7521bd43ee6_icgraph.svg" width="1154" height="720"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ac2f381378ac4ec13ad83d2ec92b2abcc" name="ac2f381378ac4ec13ad83d2ec92b2abcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2f381378ac4ec13ad83d2ec92b2abcc">&#9670;&#160;</a></span>get_layer_index() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1LayerIndex.html">LayerIndex</a> sharp::get_layer_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> &amp;&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the array indices corresponding to the given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Returns the array indices corresponding to the given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>, and performs bounds checking on the layer. As part of the bounds checking, the <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> is modified if the bottom or top of the layer is out of bounds, which is why it gets passed as a reference.</p>
<p>If the exact values of the top and bottom of the layer are present, their indices are ignored. The default behavior is that the bottom and top of a layer is computed by interpolation by default, since it may or may not be present in the native data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>{bottom, top} </td></tr>
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">N</td><td>(length of array)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{kbot, ktop} </dd></dl>

<p class="definition">Definition at line <a class="el" href="layer_8cpp_source.html#l00077">77</a> of file <a class="el" href="layer_8cpp_source.html">layer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   78</span>                                                 {</div>
<div class="line"><span class="lineno">   79</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">auto</span> bottom_comp = std::greater&lt;float&gt;();</div>
<div class="line"><span class="lineno">   80</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">auto</span> top_comp = std::less&lt;float&gt;();</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index</a>(layer, pressure, N, bottom_comp, top_comp);</div>
<div class="line"><span class="lineno">   83</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index()</a>, and <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ac2f381378ac4ec13ad83d2ec92b2abcc_cgraph.svg" width="599" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab77e344c7462c9615b0ddac228bc2193" name="ab77e344c7462c9615b0ddac228bc2193"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab77e344c7462c9615b0ddac228bc2193">&#9670;&#160;</a></span>height_layer_to_pressure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> sharp::height_layer_to_pressure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a>&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>isAGL</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a> to a <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Converts a <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a> to a <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> via interpolation, with a flag to signal whether the input layer is in meters AGL or meters MSL. If for some strange reason you provide a <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">HeightLayer</a> that is out of the bounds of height[], then the bottom and top of the output layer will be set to <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">sharp::MISSING</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>(meters) </td></tr>
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">height</td><td>(meters) </td></tr>
    <tr><td class="paramname">N</td><td>(Length of arrays) </td></tr>
    <tr><td class="paramname">isAGL</td><td>Whether the input layer is AGL / MSL (default: false)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{bottom, top} </dd></dl>

<p class="definition">Definition at line <a class="el" href="layer_8cpp_source.html#l00093">93</a> of file <a class="el" href="layer_8cpp_source.html">layer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   97</span>                                                         {</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">if</span> (isAGL) {</div>
<div class="line"><span class="lineno">   99</span>        layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a> += <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[0];</div>
<div class="line"><span class="lineno">  100</span>        layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> += <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[0];</div>
<div class="line"><span class="lineno">  101</span>    }</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordflow">if</span> ((layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a> &lt; height[0]) || (layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> &gt; height[N - 1])) {</div>
<div class="line"><span class="lineno">  104</span>        <span class="keywordflow">return</span> {MISSING, MISSING};</div>
<div class="line"><span class="lineno">  105</span>    }</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> pbot = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a>, height, pressure, N);</div>
<div class="line"><span class="lineno">  108</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> ptop = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a>, height, pressure, N);</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">return</span> {pbot, ptop};</div>
<div class="line"><span class="lineno">  111</span>}</div>
<div class="ttc" id="astructsharp_1_1HeightLayer_html_a0e1207130406a14e4362a933a72e6588"><div class="ttname"><a href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">sharp::HeightLayer::bottom</a></div><div class="ttdeci">float bottom</div><div class="ttdoc">The bottom of the height layer (meters)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00059">layer.h:59</a></div></div>
<div class="ttc" id="astructsharp_1_1HeightLayer_html_a482aa23d807be5d28d98ac96dc6434d0"><div class="ttname"><a href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">sharp::HeightLayer::top</a></div><div class="ttdeci">float top</div><div class="ttdoc">The top of the height layer (meters)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00064">layer.h:64</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">sharp::HeightLayer::bottom</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">sharp::HeightLayer::top</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#aa0726266b4777806bae4e8054e01684c">layer_mean()</a>, <a class="el" href="layer__wrap_8cpp.html#a0e34d4e0b8a26f17698d3151d128fb5d">sharp_HeightLayer_to_PressureLayer()</a>, and <a class="el" href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">storm_motion_bunkers()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab77e344c7462c9615b0ddac228bc2193_cgraph.svg" width="710" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab77e344c7462c9615b0ddac228bc2193_icgraph.svg" width="832" height="262"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a80858337a63be77bafadbb343d6e4931" name="a80858337a63be77bafadbb343d6e4931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80858337a63be77bafadbb343d6e4931">&#9670;&#160;</a></span>helicity()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename L &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">float sharp::helicity </td>
          <td>(</td>
          <td class="paramtype">L&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a>&#160;</td>
          <td class="paramname"><em>storm_motion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>coord</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>u_wind</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>v_wind</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the Storm Relative Helicity (SRH) over a given layer. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes the Storm Relative Helicity (SRH) over a given layer using storm motion vector components stored in <a class="el" href="structsharp_1_1WindComponents.html" title="A simple structure of two names floats that represent the components of a wind vector.">sharp::WindComponents</a>. This tempalte is the generalized form that will fill in the appropriate interpolation calls and coordinate arrays depending on whether a <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> or <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a> gets passed to this template. The other API instances are just static instantiations of this template.</p>
<p>This integration occurs over the given arrays of coord, u_wind, and v_wind, with N elements in each. The integration only uses interpolation for the top and bottom of the specified layer.</p>
<p>If using a <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>, units are expected in above-ground-level (AGL), and gets converted to above-mean-sea-level (MSL) during the computation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>{bottom, top} </td></tr>
    <tr><td class="paramname">storm_motion</td><td>{storm_u, storm_v} </td></tr>
    <tr><td class="paramname">coord</td><td>(meters or Pa) </td></tr>
    <tr><td class="paramname">u_wind</td><td>(m/s) </td></tr>
    <tr><td class="paramname">v_wind</td><td>(m/s) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>storm_relative_helicity </dd></dl>

<p class="definition">Definition at line <a class="el" href="winds_8h_source.html#l00342">342</a> of file <a class="el" href="winds_8h_source.html">winds.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  344</span>                                                                         {</div>
<div class="line"><span class="lineno">  345</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">if</span> ((storm_motion.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">u</a> == MISSING) || (storm_motion.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">v</a> == MISSING)) {</div>
<div class="line"><span class="lineno">  347</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  348</span>    }</div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">if</span> ((layer.bottom == MISSING) || (layer.top == MISSING)) {</div>
<div class="line"><span class="lineno">  350</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  351</span>    }</div>
<div class="line"><span class="lineno">  352</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordtype">float</span> sru_bot;</div>
<div class="line"><span class="lineno">  355</span>    <span class="keywordtype">float</span> srv_bot;</div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (layer.coord == LayerCoordinate::height) {</div>
<div class="line"><span class="lineno">  357</span>        <span class="comment">// get the height in MSL by adding the surface height</span></div>
<div class="line"><span class="lineno">  358</span>        layer.bottom += coord[0];</div>
<div class="line"><span class="lineno">  359</span>        layer.top += coord[0];</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>        <span class="comment">// Get the interpolated bottom of the layer to integrate</span></div>
<div class="line"><span class="lineno">  362</span>        <span class="comment">// and convert to storm-relative winds</span></div>
<div class="line"><span class="lineno">  363</span>        sru_bot = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.bottom, coord, u_wind, N);</div>
<div class="line"><span class="lineno">  364</span>        srv_bot = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.bottom, coord, v_wind, N);</div>
<div class="line"><span class="lineno">  365</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  366</span>        <span class="comment">// Get the interpolated bottom of the layer to integrate</span></div>
<div class="line"><span class="lineno">  367</span>        <span class="comment">// and convert to storm-relative winds</span></div>
<div class="line"><span class="lineno">  368</span>        sru_bot = <a class="code hl_function" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure</a>(layer.bottom, coord, u_wind, N);</div>
<div class="line"><span class="lineno">  369</span>        srv_bot = <a class="code hl_function" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure</a>(layer.bottom, coord, v_wind, N);</div>
<div class="line"><span class="lineno">  370</span>    }</div>
<div class="line"><span class="lineno">  371</span>    sru_bot -= storm_motion.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">u</a>;</div>
<div class="line"><span class="lineno">  372</span>    srv_bot -= storm_motion.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">v</a>;</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>    <span class="comment">// Get the vertical array indices corresponding to our layer,</span></div>
<div class="line"><span class="lineno">  375</span>    <span class="comment">// while also bounds checking our search. Indices exclude the</span></div>
<div class="line"><span class="lineno">  376</span>    <span class="comment">// top and bottom layers that will be interpolated.</span></div>
<div class="line"><span class="lineno">  377</span>    LayerIndex layer_idx = <a class="code hl_function" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index</a>(layer, coord, N);</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>    <span class="comment">// will get set in first loop iter</span></div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordtype">float</span> sru_top;</div>
<div class="line"><span class="lineno">  381</span>    <span class="keywordtype">float</span> srv_top;</div>
<div class="line"><span class="lineno">  382</span>    <span class="keywordtype">float</span> layer_helicity = 0.0;</div>
<div class="line"><span class="lineno">  383</span>    <span class="keywordflow">for</span> (std::ptrdiff_t k = layer_idx.kbot; k &lt;= layer_idx.ktop; ++k) {</div>
<div class="line"><span class="lineno">  384</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  385</span>        <span class="keywordflow">if</span> ((u_wind[k] == MISSING) || (v_wind[k] == MISSING)) {</div>
<div class="line"><span class="lineno">  386</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  387</span>        }</div>
<div class="line"><span class="lineno">  388</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  389</span>        <span class="comment">// top of layer storm relative winds</span></div>
<div class="line"><span class="lineno">  390</span>        sru_top = u_wind[k] - storm_motion.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">u</a>;</div>
<div class="line"><span class="lineno">  391</span>        srv_top = v_wind[k] - storm_motion.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">v</a>;</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>        <span class="comment">// integrate layer</span></div>
<div class="line"><span class="lineno">  394</span>        layer_helicity += (sru_top * srv_bot) - (sru_bot * srv_top);</div>
<div class="line"><span class="lineno">  395</span>        <span class="comment">// set the top to be the bottom</span></div>
<div class="line"><span class="lineno">  396</span>        <span class="comment">// of the next layer</span></div>
<div class="line"><span class="lineno">  397</span>        sru_bot = sru_top;</div>
<div class="line"><span class="lineno">  398</span>        srv_bot = srv_top;</div>
<div class="line"><span class="lineno">  399</span>    }</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    <span class="comment">// Get the interpolated top of the layer to integrate</span></div>
<div class="line"><span class="lineno">  402</span>    <span class="comment">// and convert to storm-relative winds</span></div>
<div class="line"><span class="lineno">  403</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (layer.coord == LayerCoordinate::height) {</div>
<div class="line"><span class="lineno">  404</span>        sru_top = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.top, coord, u_wind, N);</div>
<div class="line"><span class="lineno">  405</span>        srv_top = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.top, coord, v_wind, N);</div>
<div class="line"><span class="lineno">  406</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  407</span>        sru_top = <a class="code hl_function" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure</a>(layer.top, coord, u_wind, N);</div>
<div class="line"><span class="lineno">  408</span>        srv_top = <a class="code hl_function" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure</a>(layer.top, coord, v_wind, N);</div>
<div class="line"><span class="lineno">  409</span>    }</div>
<div class="line"><span class="lineno">  410</span>    sru_top -= storm_motion.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">u</a>;</div>
<div class="line"><span class="lineno">  411</span>    srv_top -= storm_motion.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">v</a>;</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>    <span class="comment">// integrate the final layer</span></div>
<div class="line"><span class="lineno">  414</span>    layer_helicity += (sru_top * srv_bot) - (sru_bot * srv_top);</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>    <span class="keywordflow">return</span> layer_helicity;</div>
<div class="line"><span class="lineno">  417</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index()</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height()</a>, <a class="el" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure()</a>, <a class="el" href="structsharp_1_1LayerIndex.html#a29cd85832f403659b88daab19abac1ca">sharp::LayerIndex::kbot</a>, <a class="el" href="structsharp_1_1LayerIndex.html#a849a04de93753261c91c58b590e60ee2">sharp::LayerIndex::ktop</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">sharp::WindComponents::u</a>, and <a class="el" href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">sharp::WindComponents::v</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#ab89a7e3555a52f0fd9f4086d5aba7037">energy_helicity_index()</a>, <a class="el" href="winds__wrap_8h.html#a2275eb46450351ce583c7aef971a0507">sharp_HeightLayer_helicity()</a>, and <a class="el" href="winds__wrap_8h.html#a111ef482a9bae9f405ccb271e0816769">sharp_PressureLayer_helicity()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a80858337a63be77bafadbb343d6e4931_cgraph.svg" width="696" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a80858337a63be77bafadbb343d6e4931_icgraph.svg" width="586" height="166"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a7acec1642f27591dc988bf9e48b4612d" name="a7acec1642f27591dc988bf9e48b4612d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7acec1642f27591dc988bf9e48b4612d">&#9670;&#160;</a></span>integrate_layer_trapz()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename L &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">float sharp::integrate_layer_trapz </td>
          <td>(</td>
          <td class="paramtype">L&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>var_array</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>coord_array</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>integ_sign</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>weighted</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a trapezoidal integration of the given layer. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Returns a trapezoidal integration of the given data array over the given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> or <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>. There is an additional default argument that determines whether this is a weighted average or not. The sign of the integration may be passed as well, i.e. integrating only positive or negative values, by passing a 1 or -1 to integ_sign.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>(<a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> or <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>) </td></tr>
    <tr><td class="paramname">var_array</td><td>(data array to integrate) </td></tr>
    <tr><td class="paramname">coord_array</td><td>(coordinate array to integrate over) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays) </td></tr>
    <tr><td class="paramname">weighted</td><td>(bool; default=false) </td></tr>
    <tr><td class="paramname">integ_sign</td><td>(int; default=0)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>integrated_value </dd></dl>

<p class="definition">Definition at line <a class="el" href="layer_8h_source.html#l00455">455</a> of file <a class="el" href="layer_8h_source.html">layer.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  459</span>                                                                       {</div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordtype">float</span> var_lyr_bottom;</div>
<div class="line"><span class="lineno">  461</span>    <span class="keywordtype">float</span> coord_lyr_bottom = layer.bottom;</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    <span class="keywordtype">float</span> var_lyr_top;</div>
<div class="line"><span class="lineno">  464</span>    <span class="keywordtype">float</span> coord_lyr_top = layer.top;</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>    <span class="keywordtype">float</span> integrated = 0.0;</div>
<div class="line"><span class="lineno">  467</span>    <span class="keywordtype">float</span> weights = 0.0;</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> isign = std::signbit(integ_sign);</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>    <span class="comment">// using constexpr means that this if statement optimizes</span></div>
<div class="line"><span class="lineno">  472</span>    <span class="comment">// away at compile time since the layer coordinate is known</span></div>
<div class="line"><span class="lineno">  473</span>    <a class="code hl_struct" href="structsharp_1_1LayerIndex.html">LayerIndex</a> idx = <a class="code hl_function" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index</a>(layer, coord_array, N);</div>
<div class="line"><span class="lineno">  474</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (layer.coord == LayerCoordinate::height) {</div>
<div class="line"><span class="lineno">  475</span>        var_lyr_bottom = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.bottom, coord_array, var_array, N);</div>
<div class="line"><span class="lineno">  476</span>        var_lyr_top = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.top, coord_array, var_array, N);</div>
<div class="line"><span class="lineno">  477</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  478</span>        var_lyr_bottom =</div>
<div class="line"><span class="lineno">  479</span>            interp_pressure(layer.bottom, coord_array, var_array, N);</div>
<div class="line"><span class="lineno">  480</span>        var_lyr_top = interp_pressure(layer.top, coord_array, var_array, N);</div>
<div class="line"><span class="lineno">  481</span>    }</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">for</span> (std::ptrdiff_t k = idx.<a class="code hl_variable" href="structsharp_1_1LayerIndex.html#a29cd85832f403659b88daab19abac1ca">kbot</a>; k &lt; idx.<a class="code hl_variable" href="structsharp_1_1LayerIndex.html#a849a04de93753261c91c58b590e60ee2">ktop</a>; ++k) {</div>
<div class="line"><span class="lineno">  484</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  485</span>        <span class="keywordflow">if</span> (var_array[k] == MISSING) {</div>
<div class="line"><span class="lineno">  486</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  487</span>        }</div>
<div class="line"><span class="lineno">  488</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>        <span class="keywordtype">float</span> coord_bottom = coord_array[k];</div>
<div class="line"><span class="lineno">  491</span>        <span class="keywordtype">float</span> var_bottom = var_array[k];</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span>        <span class="keywordtype">float</span> coord_top = coord_array[k + 1];</div>
<div class="line"><span class="lineno">  494</span>        <span class="keywordtype">float</span> var_top = var_array[k + 1];</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>        <span class="keywordtype">float</span> layer_avg = <a class="code hl_function" href="namespacesharp.html#a3558a68454edd4679ef97335e3a9f1fb">_integ_trapz</a>(var_top, var_bottom, coord_top,</div>
<div class="line"><span class="lineno">  497</span>                                       coord_bottom, weights, weighted);</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>        <span class="keywordtype">float</span> cond =</div>
<div class="line"><span class="lineno">  500</span>            (float)((!integ_sign) | (isign == std::signbit(layer_avg)));</div>
<div class="line"><span class="lineno">  501</span>        integrated += cond * layer_avg;</div>
<div class="line"><span class="lineno">  502</span>    }</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>    <span class="comment">// interpolated bottom of layer</span></div>
<div class="line"><span class="lineno">  505</span>    <span class="keywordtype">float</span> layer_avg =</div>
<div class="line"><span class="lineno">  506</span>        <a class="code hl_function" href="namespacesharp.html#a3558a68454edd4679ef97335e3a9f1fb">_integ_trapz</a>(var_array[idx.<a class="code hl_variable" href="structsharp_1_1LayerIndex.html#a29cd85832f403659b88daab19abac1ca">kbot</a>], var_lyr_bottom, coord_array[idx.<a class="code hl_variable" href="structsharp_1_1LayerIndex.html#a29cd85832f403659b88daab19abac1ca">kbot</a>],</div>
<div class="line"><span class="lineno">  507</span>                     coord_lyr_bottom, weights, weighted);</div>
<div class="line"><span class="lineno">  508</span>    <span class="keywordtype">float</span> cond = ((!integ_sign) | (isign == std::signbit(layer_avg)));</div>
<div class="line"><span class="lineno">  509</span>    integrated += cond * layer_avg;</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span>    <span class="comment">// interpolated top of layer</span></div>
<div class="line"><span class="lineno">  512</span>    layer_avg = <a class="code hl_function" href="namespacesharp.html#a3558a68454edd4679ef97335e3a9f1fb">_integ_trapz</a>(var_lyr_top, var_array[idx.<a class="code hl_variable" href="structsharp_1_1LayerIndex.html#a849a04de93753261c91c58b590e60ee2">ktop</a>], coord_lyr_top,</div>
<div class="line"><span class="lineno">  513</span>                             coord_array[idx.<a class="code hl_variable" href="structsharp_1_1LayerIndex.html#a849a04de93753261c91c58b590e60ee2">ktop</a>], weights, weighted);</div>
<div class="line"><span class="lineno">  514</span>    cond = ((!integ_sign) | (isign == std::signbit(layer_avg)));</div>
<div class="line"><span class="lineno">  515</span>    integrated += cond * layer_avg;</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (layer.coord == LayerCoordinate::pressure) {</div>
<div class="line"><span class="lineno">  518</span>        integrated *= -1.0f;</div>
<div class="line"><span class="lineno">  519</span>        weights *= -1.0f;</div>
<div class="line"><span class="lineno">  520</span>    }</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    <span class="keywordflow">if</span> (weighted) integrated /= weights;</div>
<div class="line"><span class="lineno">  523</span>    <span class="keywordflow">return</span> integrated;</div>
<div class="line"><span class="lineno">  524</span>}</div>
<div class="ttc" id="anamespacesharp_html_a3558a68454edd4679ef97335e3a9f1fb"><div class="ttname"><a href="namespacesharp.html#a3558a68454edd4679ef97335e3a9f1fb">sharp::_integ_trapz</a></div><div class="ttdeci">constexpr _T _integ_trapz(_T var_top, _T var_bottom, _T coord_top, _T coord_bottom, _T &amp;weights, const bool weighted=false)</div><div class="ttdoc">A kernel that computes the area under a curve using the trapezoidal rule.</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_8h_source.html#l00125">algorithms.h:125</a></div></div>
<div class="ttc" id="astructsharp_1_1LayerIndex_html"><div class="ttname"><a href="structsharp_1_1LayerIndex.html">sharp::LayerIndex</a></div><div class="ttdoc">A simple structure of two named integer indices for the top and bottom of a layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00131">layer.h:131</a></div></div>
<div class="ttc" id="astructsharp_1_1LayerIndex_html_a29cd85832f403659b88daab19abac1ca"><div class="ttname"><a href="structsharp_1_1LayerIndex.html#a29cd85832f403659b88daab19abac1ca">sharp::LayerIndex::kbot</a></div><div class="ttdeci">std::ptrdiff_t kbot</div><div class="ttdoc">The array index of the bottom of the layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00135">layer.h:135</a></div></div>
<div class="ttc" id="astructsharp_1_1LayerIndex_html_a849a04de93753261c91c58b590e60ee2"><div class="ttname"><a href="structsharp_1_1LayerIndex.html#a849a04de93753261c91c58b590e60ee2">sharp::LayerIndex::ktop</a></div><div class="ttdeci">std::ptrdiff_t ktop</div><div class="ttdoc">The array index of the top of the layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00140">layer.h:140</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a3558a68454edd4679ef97335e3a9f1fb">_integ_trapz()</a>, <a class="el" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index()</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height()</a>, <a class="el" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure()</a>, <a class="el" href="structsharp_1_1LayerIndex.html#a29cd85832f403659b88daab19abac1ca">sharp::LayerIndex::kbot</a>, <a class="el" href="structsharp_1_1LayerIndex.html#a849a04de93753261c91c58b590e60ee2">sharp::LayerIndex::ktop</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>.</p>

<p class="reference">Referenced by <a class="el" href="structsharp_1_1Parcel.html#a0560bd193b2d2d6bc6b08baa7463fba4">sharp::Parcel::cape_cinh()</a>, <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, <a class="el" href="namespacesharp.html#a298e2c96c389f2c5177d3626c908927e">layer_mean()</a>, <a class="el" href="layer__wrap_8h.html#ab80741ac86b523a9b6cab21482effb02">sharp_HeightLayer_integrate()</a>, and <a class="el" href="layer__wrap_8h.html#a97763021bf8f5e59076b8413d9858238">sharp_PressureLayer_integrate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a7acec1642f27591dc988bf9e48b4612d_cgraph.svg" width="747" height="184"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a7acec1642f27591dc988bf9e48b4612d_icgraph.svg" width="915" height="335"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ae8240f026498ad2775633a8d0dcf100d" name="ae8240f026498ad2775633a8d0dcf100d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8240f026498ad2775633a8d0dcf100d">&#9670;&#160;</a></span>interp_height()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::interp_height </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>data_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Linearly interpolate a data field to a requested height level. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Interpolates data in height coordinates (meters) when given the array of heights, the array of data to interpolate, a height level to interpolate to, and the number of levels in the arrays.</p>
<p>The height array must be sorted in ascending order and monotonic. For performance reasons, this routine assumes your data is well ordered. If weird stuff happens, check the ordering of your array values first.Duplicate height values or decreasing height values may produce unexpected results.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">height_val</td><td>The height value to interpolate data to </td></tr>
    <tr><td class="paramname">height_arr</td><td>The array of height values in the profile </td></tr>
    <tr><td class="paramname">data_arr</td><td>The array of data values you want interpolated </td></tr>
    <tr><td class="paramname">N</td><td>The the array length (number of elements)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value of data_arr at the requested height_val. </dd></dl>

<p class="definition">Definition at line <a class="el" href="interp_8cpp_source.html#l00023">23</a> of file <a class="el" href="interp_8cpp_source.html">interp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   24</span>                                                                  {</div>
<div class="line"><span class="lineno">   25</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   26</span>    <span class="keywordflow">if</span> (height_val == MISSING) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   27</span>    <span class="keywordflow">if</span> (std::isnan(height_val)) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   28</span>    <span class="comment">// If the height value is beyond the top of the profile,</span></div>
<div class="line"><span class="lineno">   29</span>    <span class="comment">// or below the surface, we can&#39;t reasonably extrapolate</span></div>
<div class="line"><span class="lineno">   30</span>    <span class="keywordflow">if</span> ((height_val &gt; height_arr[N - 1]) || (height_val &lt; height_arr[0]))</div>
<div class="line"><span class="lineno">   31</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   32</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">auto</span> comp = std::less&lt;float&gt;();</div>
<div class="line"><span class="lineno">   35</span>    std::ptrdiff_t idx_top = <a class="code hl_function" href="namespacesharp.html#a772686549a5111c1152b778731119aa6">upper_bound</a>(height_arr, N, height_val, comp);</div>
<div class="line"><span class="lineno">   36</span>    std::ptrdiff_t idx_bot = idx_top - 1;</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">for</span> (; idx_bot &gt; 0; --idx_bot) {</div>
<div class="line"><span class="lineno">   40</span>        <span class="keywordflow">if</span> (data_arr[idx_bot] != MISSING) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   41</span>    }</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">for</span> (; idx_top &lt; N; ++idx_top) {</div>
<div class="line"><span class="lineno">   44</span>        <span class="keywordflow">if</span> (data_arr[idx_top] != MISSING) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   45</span>    }</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>    <span class="comment">// in the case the data are still missing at this point,</span></div>
<div class="line"><span class="lineno">   48</span>    <span class="comment">// return a missing value</span></div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">if</span> ((data_arr[idx_bot] == MISSING) || (data_arr[idx_top] == MISSING))</div>
<div class="line"><span class="lineno">   50</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   51</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> height_bot = height_arr[idx_bot];</div>
<div class="line"><span class="lineno">   54</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> height_top = height_arr[idx_top];</div>
<div class="line"><span class="lineno">   55</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> data_bot = data_arr[idx_bot];</div>
<div class="line"><span class="lineno">   56</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> data_top = data_arr[idx_top];</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>    <span class="comment">// normalize the distance between values</span></div>
<div class="line"><span class="lineno">   59</span>    <span class="comment">// to a range of 0-1 for the lerp routine</span></div>
<div class="line"><span class="lineno">   60</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> dz_norm = (height_val - height_bot) / (height_top - height_bot);</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>    <span class="comment">// return the linear interpolation</span></div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a0bf533560780fdb77bc3656db8d89208">lerp</a>(data_bot, data_top, dz_norm);</div>
<div class="line"><span class="lineno">   64</span>}</div>
<div class="ttc" id="anamespacesharp_html_a0bf533560780fdb77bc3656db8d89208"><div class="ttname"><a href="namespacesharp.html#a0bf533560780fdb77bc3656db8d89208">sharp::lerp</a></div><div class="ttdeci">constexpr float lerp(const float __a, const float __b, const float __t)</div><div class="ttdoc">Linearly interpolates between a and b with distance t.</div><div class="ttdef"><b>Definition:</b> <a href="interp_8h_source.html#l00093">interp.h:93</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a0bf533560780fdb77bc3656db8d89208">lerp()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="namespacesharp.html#a772686549a5111c1152b778731119aa6">upper_bound()</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, <a class="el" href="namespacesharp.html#ab77e344c7462c9615b0ddac228bc2193">height_layer_to_pressure()</a>, <a class="el" href="namespacesharp.html#a80858337a63be77bafadbb343d6e4931">helicity()</a>, <a class="el" href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">integrate_layer_trapz()</a>, <a class="el" href="namespacesharp.html#a43a01274768ee388a983046651a230d3">lapse_rate()</a>, <a class="el" href="namespacesharp.html#a646b65095b84511b75f6a4a81e545e80">layer_minmax()</a>, <a class="el" href="structsharp_1_1Parcel.html#a1bf670e79f35a1ce8c904b7ead32ccbe">sharp::Parcel::mixed_layer_parcel()</a>, <a class="el" href="interp__wrap_8h.html#a8f8ceea33348c31a1f0763a3896b8128">sharp_interp_height()</a>, and <a class="el" href="namespacesharp.html#a099a4575acc27d6e10f9dfb69bc315a1">wind_shear()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ae8240f026498ad2775633a8d0dcf100d_cgraph.svg" width="515" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ae8240f026498ad2775633a8d0dcf100d_icgraph.svg" width="1123" height="1215"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a55e4f8ee4ff8a4a30d7b3f3d92a41c75" name="a55e4f8ee4ff8a4a30d7b3f3d92a41c75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">&#9670;&#160;</a></span>interp_pressure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::interp_pressure </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>data_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Linearly interpolate a data field to a requested pressure level. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Interpolates data in pressure coordinates (mb) when given the array of pressure values, the array of data to interpolate, a pressure level to interpolate to, and the number of levels in the arrays.</p>
<p>The pressure array must be sorted in descending order and monotonic. Duplicate pressure values or increasing pressure values may produce unexpected results.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure_val</td><td>The pressure value to interpolate data to </td></tr>
    <tr><td class="paramname">pressure_arr</td><td>The array of pressure values in the profile </td></tr>
    <tr><td class="paramname">data_arr</td><td>The array of data values you want interpolated </td></tr>
    <tr><td class="paramname">N</td><td>The the array length (number of elements)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value of data_arr at the requested pressure_val. </dd></dl>

<p class="definition">Definition at line <a class="el" href="interp_8cpp_source.html#l00066">66</a> of file <a class="el" href="interp_8cpp_source.html">interp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   67</span>                                                                    {</div>
<div class="line"><span class="lineno">   68</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordflow">if</span> (pressure_val == MISSING) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordflow">if</span> (std::isnan(pressure_val)) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   71</span>    <span class="comment">// If the pressure value is beyond the top of the profile,</span></div>
<div class="line"><span class="lineno">   72</span>    <span class="comment">// or below the surface, we can&#39;t reasonably extrapolate</span></div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">if</span> ((pressure_val &lt; pressure_arr[N - 1]) ||</div>
<div class="line"><span class="lineno">   74</span>        (pressure_val &gt; pressure_arr[0])) {</div>
<div class="line"><span class="lineno">   75</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   76</span>    }</div>
<div class="line"><span class="lineno">   77</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">auto</span> comp = std::greater&lt;float&gt;();</div>
<div class="line"><span class="lineno">   80</span>    std::ptrdiff_t idx_top = upper_bound(pressure_arr, N, pressure_val, comp);</div>
<div class="line"><span class="lineno">   81</span>    std::ptrdiff_t idx_bot = idx_top - 1;</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">for</span> (; idx_bot &gt; 0; --idx_bot) {</div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">if</span> (data_arr[idx_bot] != MISSING) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   86</span>    }</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>    <span class="keywordflow">for</span> (; idx_top &lt; N; ++idx_top) {</div>
<div class="line"><span class="lineno">   89</span>        <span class="keywordflow">if</span> (data_arr[idx_top] != MISSING) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   90</span>    }</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>    <span class="comment">// in the case the data are still missing at this point,</span></div>
<div class="line"><span class="lineno">   93</span>    <span class="comment">// return a missing value</span></div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">if</span> ((data_arr[idx_bot] == MISSING) || (data_arr[idx_top] == MISSING))</div>
<div class="line"><span class="lineno">   95</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   96</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> pressure_bot = pressure_arr[idx_bot];</div>
<div class="line"><span class="lineno">   99</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> pressure_top = pressure_arr[idx_top];</div>
<div class="line"><span class="lineno">  100</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> data_bot = data_arr[idx_bot];</div>
<div class="line"><span class="lineno">  101</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> data_top = data_arr[idx_top];</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>    <span class="comment">// In order to linearly interpolate pressure properly, distance needs</span></div>
<div class="line"><span class="lineno">  104</span>    <span class="comment">// to be calculated in log10(pressure) coordinates and normalized</span></div>
<div class="line"><span class="lineno">  105</span>    <span class="comment">// between 0 and 1 for the lerp routine.</span></div>
<div class="line"><span class="lineno">  106</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> dp_norm =</div>
<div class="line"><span class="lineno">  107</span>        (std::log10(pressure_bot) - std::log10(pressure_val)) /</div>
<div class="line"><span class="lineno">  108</span>        (std::log10(pressure_bot) - std::log10(pressure_top));</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    <span class="comment">// return the linear interpolation</span></div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a0bf533560780fdb77bc3656db8d89208">lerp</a>(data_bot, data_top, dp_norm);</div>
<div class="line"><span class="lineno">  112</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a0bf533560780fdb77bc3656db8d89208">lerp()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="namespacesharp.html#a772686549a5111c1152b778731119aa6">upper_bound()</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, <a class="el" href="structsharp_1_1Parcel.html#a8a311e09b1d46a829212da94cf181537">sharp::Parcel::find_lfc_el()</a>, <a class="el" href="namespacesharp.html#a80858337a63be77bafadbb343d6e4931">helicity()</a>, <a class="el" href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">integrate_layer_trapz()</a>, <a class="el" href="namespacesharp.html#a646b65095b84511b75f6a4a81e545e80">layer_minmax()</a>, <a class="el" href="namespacesharp.html#a3c8b9022103d067f30281d68fa81cbda">mean_wind()</a>, <a class="el" href="namespacesharp.html#a31da980f398c9f6a5960ddf868101a94">pressure_layer_to_height()</a>, <a class="el" href="interp__wrap_8h.html#aa5d2319f0bc3f96d2bd4d29c52385950">sharp_interp_pressure()</a>, <a class="el" href="namespacesharp.html#ab31d383a3231f8fef873e5a16c0db856">storm_motion_bunkers()</a>, and <a class="el" href="namespacesharp.html#a099a4575acc27d6e10f9dfb69bc315a1">wind_shear()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a55e4f8ee4ff8a4a30d7b3f3d92a41c75_cgraph.svg" width="530" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a55e4f8ee4ff8a4a30d7b3f3d92a41c75_icgraph.svg" width="1131" height="1139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a43a01274768ee388a983046651a230d3" name="a43a01274768ee388a983046651a230d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43a01274768ee388a983046651a230d3">&#9670;&#160;</a></span>lapse_rate() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::lapse_rate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a>&#160;</td>
          <td class="paramname"><em>layer_agl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>temperature</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compute the lapse rate over the given <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a> (AGL) </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes the lapse rate over a given <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a> above-ground-level. This routine handles converting AGL to MSL by adding the surface height value to the layer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer_agl</td><td>(meters AGL) </td></tr>
    <tr><td class="paramname">height</td><td>(meters MSL) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Temperature Lapse Rate (K/km) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00403">403</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  404</span>                                                                  {</div>
<div class="line"><span class="lineno">  405</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  406</span>    <span class="keywordflow">if</span> ((layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a> == MISSING) || (layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> == MISSING)) {</div>
<div class="line"><span class="lineno">  407</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  408</span>    }</div>
<div class="line"><span class="lineno">  409</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>    <span class="comment">// convert from agl to msl</span></div>
<div class="line"><span class="lineno">  412</span>    layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a> += height[0];</div>
<div class="line"><span class="lineno">  413</span>    layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> += height[0];</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>    <span class="comment">// bounds check the height layer</span></div>
<div class="line"><span class="lineno">  416</span>    <span class="keywordflow">if</span> (layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a> &lt; height[0]) {</div>
<div class="line"><span class="lineno">  417</span>        layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a> = height[0];</div>
<div class="line"><span class="lineno">  418</span>    }</div>
<div class="line"><span class="lineno">  419</span>    <span class="keywordflow">if</span> (layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> &gt; height[N - 1]) {</div>
<div class="line"><span class="lineno">  420</span>        layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> = <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[N - 1];</div>
<div class="line"><span class="lineno">  421</span>    }</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>    <span class="comment">// lower and upper temperature</span></div>
<div class="line"><span class="lineno">  424</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> tmpc_l =</div>
<div class="line"><span class="lineno">  425</span>        <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a>, height, temperature, N);</div>
<div class="line"><span class="lineno">  426</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> tmpc_u = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a>, height, temperature, N);</div>
<div class="line"><span class="lineno">  427</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordflow">if</span> ((tmpc_l == MISSING) || (tmpc_u == MISSING)) {</div>
<div class="line"><span class="lineno">  429</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  430</span>    }</div>
<div class="line"><span class="lineno">  431</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>    <span class="comment">// dT/dz, positive (definition of lapse rate), in km</span></div>
<div class="line"><span class="lineno">  434</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> dz = layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> - layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a>;</div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">return</span> ((tmpc_u - tmpc_l) / dz) * -1000.0f;</div>
<div class="line"><span class="lineno">  436</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">sharp::HeightLayer::bottom</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">sharp::HeightLayer::top</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#aa4e86da659bfca2eae1f0baddb84a303">lapse_rate()</a>, <a class="el" href="namespacesharp.html#abd0d1a28608e145c455ace03e787e33b">lapse_rate_max()</a>, <a class="el" href="thermo__wrap_8h.html#a56e4699ce7fd1603ff1957e72c07d367">sharp_HeightLayer_lapse_rate()</a>, and <a class="el" href="thermo__wrap_8h.html#aa9e6b801be3431516421ca34cab2ba95">sharp_PressureLayer_lapse_rate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a43a01274768ee388a983046651a230d3_cgraph.svg" width="698" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a43a01274768ee388a983046651a230d3_icgraph.svg" width="412" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aa4e86da659bfca2eae1f0baddb84a303" name="aa4e86da659bfca2eae1f0baddb84a303"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4e86da659bfca2eae1f0baddb84a303">&#9670;&#160;</a></span>lapse_rate() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::lapse_rate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a>&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>temperature</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compute the lapse rate over the given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes the lapse rate over a given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>. This routine handles converting the pressure layer into a height layer, and then calles the <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a> implementation of this routine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>(Pa) </td></tr>
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">height</td><td>(meters MSL) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Temperature Lapse Rate (K/km) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00438">438</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  440</span>                                       {</div>
<div class="line"><span class="lineno">  441</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  442</span>    <span class="keywordflow">if</span> ((layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a> == MISSING) || (layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> == MISSING)) {</div>
<div class="line"><span class="lineno">  443</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  444</span>    }</div>
<div class="line"><span class="lineno">  445</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    <span class="comment">// bounds check the pressure layer</span></div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">if</span> (layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a> &gt; pressure[0]) {</div>
<div class="line"><span class="lineno">  449</span>        layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a> = pressure[0];</div>
<div class="line"><span class="lineno">  450</span>    }</div>
<div class="line"><span class="lineno">  451</span>    <span class="keywordflow">if</span> (layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> &lt; pressure[N - 1]) {</div>
<div class="line"><span class="lineno">  452</span>        layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> = <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[N - 1];</div>
<div class="line"><span class="lineno">  453</span>    }</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    HeightLayer h_layer =</div>
<div class="line"><span class="lineno">  456</span>        <a class="code hl_function" href="namespacesharp.html#a31da980f398c9f6a5960ddf868101a94">pressure_layer_to_height</a>(layer, pressure, height, N, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a43a01274768ee388a983046651a230d3">lapse_rate</a>(h_layer, height, temperature, N);</div>
<div class="line"><span class="lineno">  459</span>}</div>
<div class="ttc" id="anamespacesharp_html_a43a01274768ee388a983046651a230d3"><div class="ttname"><a href="namespacesharp.html#a43a01274768ee388a983046651a230d3">sharp::lapse_rate</a></div><div class="ttdeci">float lapse_rate(HeightLayer layer_agl, const float height[], const float temperature[], const std::ptrdiff_t N)</div><div class="ttdoc">compute the lapse rate over the given sharp::HeightLayer (AGL)</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00403">thermo.cpp:403</a></div></div>
<div class="ttc" id="astructsharp_1_1PressureLayer_html_a22a8b0e57b0b2e23f87a1f23e6b2cf96"><div class="ttname"><a href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">sharp::PressureLayer::bottom</a></div><div class="ttdeci">float bottom</div><div class="ttdoc">The bottom of the pressure layer (Pa)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00097">layer.h:97</a></div></div>
<div class="ttc" id="astructsharp_1_1PressureLayer_html_adb2306e425e88885902cde3e8f84531a"><div class="ttname"><a href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">sharp::PressureLayer::top</a></div><div class="ttdeci">float top</div><div class="ttdoc">The top of the pressure layer (Pa)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00102">layer.h:102</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">sharp::PressureLayer::bottom</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="namespacesharp.html#a43a01274768ee388a983046651a230d3">lapse_rate()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, <a class="el" href="namespacesharp.html#a31da980f398c9f6a5960ddf868101a94">pressure_layer_to_height()</a>, and <a class="el" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">sharp::PressureLayer::top</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_aa4e86da659bfca2eae1f0baddb84a303_cgraph.svg" width="923" height="102"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="abd0d1a28608e145c455ace03e787e33b" name="abd0d1a28608e145c455ace03e787e33b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd0d1a28608e145c455ace03e787e33b">&#9670;&#160;</a></span>lapse_rate_max() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::lapse_rate_max </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a>&#160;</td>
          <td class="paramname"><em>layer_agl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>temperature</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a> *&#160;</td>
          <td class="paramname"><em>max_lyr</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the maximum lapse rate within a specified layer/depth (AGL). </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Given a layer of the atmosphere (e.g. 2 - 6 km), find the maximum lapse rate over the provided depth (e.g. 2 km) within that given layer. Returns the maximum lapse rate, with the optional ability to return the layer that lapse rate exists within.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer_agl</td><td>(meters AGL) </td></tr>
    <tr><td class="paramname">depth</td><td>(meters) </td></tr>
    <tr><td class="paramname">height</td><td>(meters MSL) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays) </td></tr>
    <tr><td class="paramname">max_lyr</td><td>(The <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a> of the max lapse rate)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Maximum Temperature Lapse Rate (K/km) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00461">461</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  463</span>                                                                 {</div>
<div class="line"><span class="lineno">  464</span>    <span class="keywordtype">float</span> max_lr = MISSING;</div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">for</span> (<span class="keywordtype">float</span> z = layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a>; z &lt;= (layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> - depth);</div>
<div class="line"><span class="lineno">  466</span>         z += layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#af1d902f92c79d012f2ee545219383af4">delta</a>) {</div>
<div class="line"><span class="lineno">  467</span>        <a class="code hl_struct" href="structsharp_1_1HeightLayer.html">HeightLayer</a> lyr = {z, z + depth};</div>
<div class="line"><span class="lineno">  468</span>        <span class="keywordtype">float</span> lr = lapse_rate(lyr, height, temperature, N);</div>
<div class="line"><span class="lineno">  469</span>        <span class="keywordflow">if</span> (lr &gt; max_lr) {</div>
<div class="line"><span class="lineno">  470</span>            max_lr = lr;</div>
<div class="line"><span class="lineno">  471</span>            <span class="keywordflow">if</span> (max_lyr) {</div>
<div class="line"><span class="lineno">  472</span>                max_lyr-&gt;<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a> = lyr.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a>;</div>
<div class="line"><span class="lineno">  473</span>                max_lyr-&gt;<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> = lyr.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a>;</div>
<div class="line"><span class="lineno">  474</span>            }</div>
<div class="line"><span class="lineno">  475</span>        }</div>
<div class="line"><span class="lineno">  476</span>    }</div>
<div class="line"><span class="lineno">  477</span>    <span class="keywordflow">return</span> max_lr;</div>
<div class="line"><span class="lineno">  478</span>}</div>
<div class="ttc" id="astructsharp_1_1HeightLayer_html"><div class="ttname"><a href="structsharp_1_1HeightLayer.html">sharp::HeightLayer</a></div><div class="ttdoc">A simple structure of named floats that represent a height layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00055">layer.h:55</a></div></div>
<div class="ttc" id="astructsharp_1_1HeightLayer_html_af1d902f92c79d012f2ee545219383af4"><div class="ttname"><a href="structsharp_1_1HeightLayer.html#af1d902f92c79d012f2ee545219383af4">sharp::HeightLayer::delta</a></div><div class="ttdeci">float delta</div><div class="ttdoc">The height interval with which to iterate over the layer (meters)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00069">layer.h:69</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">sharp::HeightLayer::bottom</a>, <a class="el" href="structsharp_1_1HeightLayer.html#af1d902f92c79d012f2ee545219383af4">sharp::HeightLayer::delta</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="namespacesharp.html#a43a01274768ee388a983046651a230d3">lapse_rate()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">sharp::HeightLayer::top</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_abd0d1a28608e145c455ace03e787e33b_cgraph.svg" width="916" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="af6c026b54a5c0c2e1bd24d35cb20b11a" name="af6c026b54a5c0c2e1bd24d35cb20b11a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6c026b54a5c0c2e1bd24d35cb20b11a">&#9670;&#160;</a></span>lapse_rate_max() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::lapse_rate_max </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a>&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>temperature</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a> *&#160;</td>
          <td class="paramname"><em>max_lyr</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the maximum lapse rate within a specified layer/depth (Pres) </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Given a mayer of the atmisphere (e.g. 800 hPa - 500 hPa), find the maximum lapse rate over the provided depth (e.g. 100 hPa) within that given layer. Returns the maximum lapse rate, with the optional ability to return the layer that lapse rate exists within.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>(Pa) </td></tr>
    <tr><td class="paramname">depth</td><td>(Pa) </td></tr>
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">height</td><td>(meters MSL) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays) </td></tr>
    <tr><td class="paramname">max_lyr</td><td>(The <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> of the max lapse rate)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Maximum Temperature Lapse Rate (K/km) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00480">480</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  483</span>                                             {</div>
<div class="line"><span class="lineno">  484</span>    <span class="keywordtype">float</span> max_lr = MISSING;</div>
<div class="line"><span class="lineno">  485</span>    <span class="keywordflow">for</span> (<span class="keywordtype">float</span> p = layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a>; p &gt;= (layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> + depth); p += layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a4444597984491f09fa0f4ae92c7984de">delta</a>) {</div>
<div class="line"><span class="lineno">  486</span>        <a class="code hl_struct" href="structsharp_1_1PressureLayer.html">PressureLayer</a> lyr = {p, p - depth};</div>
<div class="line"><span class="lineno">  487</span>        <span class="keywordtype">float</span> lr = lapse_rate(lyr, pressure, height, temperature, N);</div>
<div class="line"><span class="lineno">  488</span>        <span class="keywordflow">if</span> (lr &gt; max_lr) {</div>
<div class="line"><span class="lineno">  489</span>            max_lr = lr;</div>
<div class="line"><span class="lineno">  490</span>            <span class="keywordflow">if</span> (max_lyr) {</div>
<div class="line"><span class="lineno">  491</span>                max_lyr-&gt;<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a> = lyr.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a>;</div>
<div class="line"><span class="lineno">  492</span>                max_lyr-&gt;<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> = lyr.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a>;</div>
<div class="line"><span class="lineno">  493</span>            }</div>
<div class="line"><span class="lineno">  494</span>        }</div>
<div class="line"><span class="lineno">  495</span>    }</div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordflow">return</span> max_lr;</div>
<div class="line"><span class="lineno">  497</span>}</div>
<div class="ttc" id="astructsharp_1_1PressureLayer_html"><div class="ttname"><a href="structsharp_1_1PressureLayer.html">sharp::PressureLayer</a></div><div class="ttdoc">A simple structure of two named floats that represent a pressure layer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00093">layer.h:93</a></div></div>
<div class="ttc" id="astructsharp_1_1PressureLayer_html_a4444597984491f09fa0f4ae92c7984de"><div class="ttname"><a href="structsharp_1_1PressureLayer.html#a4444597984491f09fa0f4ae92c7984de">sharp::PressureLayer::delta</a></div><div class="ttdeci">float delta</div><div class="ttdoc">The pressure interval with which to iterate over the layer (Pa)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00107">layer.h:107</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">sharp::PressureLayer::bottom</a>, <a class="el" href="structsharp_1_1PressureLayer.html#a4444597984491f09fa0f4ae92c7984de">sharp::PressureLayer::delta</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="namespacesharp.html#a43a01274768ee388a983046651a230d3">lapse_rate()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">sharp::PressureLayer::top</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_af6c026b54a5c0c2e1bd24d35cb20b11a_cgraph.svg" width="916" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a6170e3f412ab95b3ba8d9a93ae55dc67" name="a6170e3f412ab95b3ba8d9a93ae55dc67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6170e3f412ab95b3ba8d9a93ae55dc67">&#9670;&#160;</a></span>layer_max()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename L &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::layer_max </td>
          <td>(</td>
          <td class="paramtype">L&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>coord_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>data_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>lvl_of_max</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the maximim value in the given layer. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Returns the maximum value observed within the given data array over the given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> or <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>. The function bounds checks the layer by calling <a class="el" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6" title="Returns the array indices corresponding to the given layer.">sharp::get_layer_index</a>.</p>
<p>If lvl_of_max is not a nullptr, then the pointer will be dereferenced and filled with the coordinate of the maximum value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>(<a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> or <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>) </td></tr>
    <tr><td class="paramname">coord_arr</td><td>(coordinate units; Pa or meters) </td></tr>
    <tr><td class="paramname">data_arr</td><td>(data array to find max on) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays) </td></tr>
    <tr><td class="paramname">lvl_of_max</td><td>(level of max val)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>layer_max </dd></dl>

<p class="definition">Definition at line <a class="el" href="layer_8h_source.html#l00426">426</a> of file <a class="el" href="layer_8h_source.html">layer.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  428</span>                                                       {</div>
<div class="line"><span class="lineno">  429</span>    <span class="keyword">constexpr</span> <span class="keyword">auto</span> comp = std::greater&lt;float&gt;();</div>
<div class="line"><span class="lineno">  430</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a646b65095b84511b75f6a4a81e545e80">layer_minmax</a>(layer, coord_arr, data_arr, N, lvl_of_max, comp);</div>
<div class="line"><span class="lineno">  431</span>}</div>
<div class="ttc" id="anamespacesharp_html_a646b65095b84511b75f6a4a81e545e80"><div class="ttname"><a href="namespacesharp.html#a646b65095b84511b75f6a4a81e545e80">sharp::layer_minmax</a></div><div class="ttdeci">constexpr float layer_minmax(L layer, const float coord_arr[], const float data_arr[], const std::ptrdiff_t N, float *lvl_min_or_max, const C comp)</div><div class="ttdoc">Template for min/max value over sharp::PressureLayer or sharp::HeightLayer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8h_source.html#l00331">layer.h:331</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a646b65095b84511b75f6a4a81e545e80">layer_minmax()</a>.</p>

<p class="reference">Referenced by <a class="el" href="layer__wrap_8h.html#aff049d2f08d0ca532b51ee39dfeff547">sharp_HeightLayer_max()</a>, and <a class="el" href="layer__wrap_8h.html#af26d1ab7a5b701ce5e076ff2a0ef3955">sharp_PressureLayer_max()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a6170e3f412ab95b3ba8d9a93ae55dc67_cgraph.svg" width="924" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a6170e3f412ab95b3ba8d9a93ae55dc67_icgraph.svg" width="387" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aa0726266b4777806bae4e8054e01684c" name="aa0726266b4777806bae4e8054e01684c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0726266b4777806bae4e8054e01684c">&#9670;&#160;</a></span>layer_mean() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::layer_mean </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a>&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>data_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>isAGL</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the mass-weighted mean value of a field over a given height layer. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes the mass-weighted mean value of given arrays of data and corresponding height coordinates over the given <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>. This is really just a fancy wrapper around the implementation that uses <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>(<a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>) </td></tr>
    <tr><td class="paramname">height</td><td>(vertical height array; meters) </td></tr>
    <tr><td class="paramname">pressure</td><td>(vertical pressure array; Pa) </td></tr>
    <tr><td class="paramname">data_arr</td><td>(The data for which to compute a mean) </td></tr>
    <tr><td class="paramname">N</td><td>(length of pressure and data arrays) </td></tr>
    <tr><td class="paramname">isAGL</td><td>(whether or not intput is in AGL or MSL)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>layer_mean </dd></dl>

<p class="definition">Definition at line <a class="el" href="layer_8cpp_source.html#l00151">151</a> of file <a class="el" href="layer_8cpp_source.html">layer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  153</span>                                                         {</div>
<div class="line"><span class="lineno">  154</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">if</span> ((layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a> == MISSING) || (layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> == MISSING)) {</div>
<div class="line"><span class="lineno">  156</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  157</span>    }</div>
<div class="line"><span class="lineno">  158</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">if</span> (isAGL) {</div>
<div class="line"><span class="lineno">  161</span>        layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a> += height[0];</div>
<div class="line"><span class="lineno">  162</span>        layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> += height[0];</div>
<div class="line"><span class="lineno">  163</span>    }</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">if</span> (layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a> &lt; height[0]) {</div>
<div class="line"><span class="lineno">  166</span>        layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a> = <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[0];</div>
<div class="line"><span class="lineno">  167</span>    }</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">if</span> (layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> &gt; height[N - 1]) {</div>
<div class="line"><span class="lineno">  170</span>        layer.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> = <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[N - 1];</div>
<div class="line"><span class="lineno">  171</span>    }</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    PressureLayer pres_layer =</div>
<div class="line"><span class="lineno">  174</span>        <a class="code hl_function" href="namespacesharp.html#ab77e344c7462c9615b0ddac228bc2193">height_layer_to_pressure</a>(layer, pressure, height, N, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">integrate_layer_trapz</a>(pres_layer, data_arr, pressure, N, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  177</span>}</div>
<div class="ttc" id="anamespacesharp_html_ab77e344c7462c9615b0ddac228bc2193"><div class="ttname"><a href="namespacesharp.html#ab77e344c7462c9615b0ddac228bc2193">sharp::height_layer_to_pressure</a></div><div class="ttdeci">PressureLayer height_layer_to_pressure(HeightLayer layer, const float pressure[], const float height[], const std::ptrdiff_t N, const bool isAGL=false)</div><div class="ttdoc">Converts a sharp::HeightLayer to a sharp::PressureLayer.</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00093">layer.cpp:93</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">sharp::HeightLayer::bottom</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="namespacesharp.html#ab77e344c7462c9615b0ddac228bc2193">height_layer_to_pressure()</a>, <a class="el" href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">integrate_layer_trapz()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">sharp::HeightLayer::top</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_aa0726266b4777806bae4e8054e01684c_cgraph.svg" width="938" height="192"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a298e2c96c389f2c5177d3626c908927e" name="a298e2c96c389f2c5177d3626c908927e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a298e2c96c389f2c5177d3626c908927e">&#9670;&#160;</a></span>layer_mean() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::layer_mean </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a>&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>data_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the mass-weighted mean value of a field over a given pressure layer. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes the mass-weighted mean value of given arrays of data and corresponding pressure coordinates over the given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>(<a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>) </td></tr>
    <tr><td class="paramname">pressure</td><td>(vertical pressure array; Pa) </td></tr>
    <tr><td class="paramname">data_arr</td><td>(The data for which to compute a mean) </td></tr>
    <tr><td class="paramname">N</td><td>(length of pressure and data arrays)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>layer_mean </dd></dl>

<p class="definition">Definition at line <a class="el" href="layer_8cpp_source.html#l00132">132</a> of file <a class="el" href="layer_8cpp_source.html">layer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  133</span>                                                               {</div>
<div class="line"><span class="lineno">  134</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">if</span> ((layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a> == MISSING) || (layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> == MISSING)) {</div>
<div class="line"><span class="lineno">  136</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  137</span>    }</div>
<div class="line"><span class="lineno">  138</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">if</span> (layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a> &gt; pressure[0]) {</div>
<div class="line"><span class="lineno">  141</span>        layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a> = pressure[0];</div>
<div class="line"><span class="lineno">  142</span>    }</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    <span class="keywordflow">if</span> (layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> &lt; pressure[N - 1]) {</div>
<div class="line"><span class="lineno">  145</span>        layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> = <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>[N - 1];</div>
<div class="line"><span class="lineno">  146</span>    }</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">integrate_layer_trapz</a>(layer, data_arr, pressure, N, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  149</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">sharp::PressureLayer::bottom</a>, <a class="el" href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">integrate_layer_trapz()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">sharp::PressureLayer::top</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, <a class="el" href="structsharp_1_1Parcel.html#a1bf670e79f35a1ce8c904b7ead32ccbe">sharp::Parcel::mixed_layer_parcel()</a>, <a class="el" href="layer__wrap_8h.html#aed1a796336a18c40e0bf51019b76e09a">sharp_HeightLayer_mean()</a>, and <a class="el" href="layer__wrap_8h.html#acb9a81d9a712786d81c427d428eefd0a">sharp_PressureLayer_mean()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a298e2c96c389f2c5177d3626c908927e_cgraph.svg" width="938" height="184"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a298e2c96c389f2c5177d3626c908927e_icgraph.svg" width="634" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a01a9880c937f63e551893797253da4f7" name="a01a9880c937f63e551893797253da4f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01a9880c937f63e551893797253da4f7">&#9670;&#160;</a></span>layer_min()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename L &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::layer_min </td>
          <td>(</td>
          <td class="paramtype">L&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>coord_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>data_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>lvl_of_min</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the minimum value in the given layer. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Returns the minimum value observed within the given data array over the given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> or <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>. The function bounds checks the layer by calling <a class="el" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6" title="Returns the array indices corresponding to the given layer.">sharp::get_layer_index</a>.</p>
<p>If lvl_of_min is not a nullptr, then the pointer will be dereferenced and filled with the coordinate of the minimum value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>(<a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> or <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>) </td></tr>
    <tr><td class="paramname">coord_arr</td><td>(coordinate units; Pa or meters) </td></tr>
    <tr><td class="paramname">data_arr</td><td>(data array to find min on) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays) </td></tr>
    <tr><td class="paramname">lvl_of_min</td><td>(level of min val)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>layer_min </dd></dl>

<p class="definition">Definition at line <a class="el" href="layer_8h_source.html#l00396">396</a> of file <a class="el" href="layer_8h_source.html">layer.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  398</span>                                                       {</div>
<div class="line"><span class="lineno">  399</span>    <span class="keyword">constexpr</span> <span class="keyword">auto</span> comp = std::less&lt;float&gt;();</div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a646b65095b84511b75f6a4a81e545e80">layer_minmax</a>(layer, coord_arr, data_arr, N, lvl_of_min, comp);</div>
<div class="line"><span class="lineno">  401</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a646b65095b84511b75f6a4a81e545e80">layer_minmax()</a>.</p>

<p class="reference">Referenced by <a class="el" href="layer__wrap_8h.html#a1b669cfe5d14a85dc16aa2ec7b19f914">sharp_HeightLayer_min()</a>, and <a class="el" href="layer__wrap_8h.html#aa9e2591b56d47f5caa08217690927b49">sharp_PressureLayer_min()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a01a9880c937f63e551893797253da4f7_cgraph.svg" width="920" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a01a9880c937f63e551893797253da4f7_icgraph.svg" width="379" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a646b65095b84511b75f6a4a81e545e80" name="a646b65095b84511b75f6a4a81e545e80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a646b65095b84511b75f6a4a81e545e80">&#9670;&#160;</a></span>layer_minmax()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename L , typename C &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::layer_minmax </td>
          <td>(</td>
          <td class="paramtype">L&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>coord_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>data_arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>lvl_min_or_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const C&#160;</td>
          <td class="paramname"><em>comp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Template for min/max value over <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> or <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>This tempalte function contains the algorithm for searching for either the minimum or maximum value over a given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> or <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>. This function is wrapped by the sharp::min_value and sharp::max_value functions, which pass the appropriate comparitor to the template.</p>
<p>If lvl_min_or_max is not a nullptr, then the pointer will be dereferenced and filled with the pressure or height of the maximum/minum value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>(<a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> or <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>) </td></tr>
    <tr><td class="paramname">coord_arr</td><td>(pressure or height) </td></tr>
    <tr><td class="paramname">data_arr</td><td>(data array to find max on) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays) </td></tr>
    <tr><td class="paramname">lvl_min_or_max</td><td>(level of min/max val) </td></tr>
    <tr><td class="paramname">comp</td><td>Comparitor (i.e. std::less or std::greater)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>minmax_value </dd></dl>

<p class="definition">Definition at line <a class="el" href="layer_8h_source.html#l00331">331</a> of file <a class="el" href="layer_8h_source.html">layer.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  335</span>                                                         {</div>
<div class="line"><span class="lineno">  336</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  337</span>    <span class="keywordflow">if</span> ((layer.bottom == MISSING) || (layer.top == MISSING)) {</div>
<div class="line"><span class="lineno">  338</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  339</span>    }</div>
<div class="line"><span class="lineno">  340</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>    LayerIndex layer_idx = get_layer_index(layer, coord_arr, N);</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>    <span class="keywordtype">float</span> min_or_max = MISSING;</div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordtype">float</span> top_val = MISSING;</div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (layer.coord == LayerCoordinate::pressure) {</div>
<div class="line"><span class="lineno">  347</span>        min_or_max = interp_pressure(layer.bottom, coord_arr, data_arr, N);</div>
<div class="line"><span class="lineno">  348</span>        top_val = interp_pressure(layer.top, coord_arr, data_arr, N);</div>
<div class="line"><span class="lineno">  349</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  350</span>        min_or_max = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.bottom, coord_arr, data_arr, N);</div>
<div class="line"><span class="lineno">  351</span>        top_val = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.top, coord_arr, data_arr, N);</div>
<div class="line"><span class="lineno">  352</span>    }</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordtype">float</span> coord_lvl = layer.bottom;</div>
<div class="line"><span class="lineno">  355</span>    <span class="keywordflow">for</span> (std::ptrdiff_t k = layer_idx.kbot; k &lt; layer_idx.ktop + 1; ++k) {</div>
<div class="line"><span class="lineno">  356</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> val = data_arr[k];</div>
<div class="line"><span class="lineno">  357</span>        <span class="keywordflow">if</span> (comp(val, min_or_max)) {</div>
<div class="line"><span class="lineno">  358</span>            min_or_max = val;</div>
<div class="line"><span class="lineno">  359</span>            coord_lvl = coord_arr[k];</div>
<div class="line"><span class="lineno">  360</span>        }</div>
<div class="line"><span class="lineno">  361</span>    }</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>    <span class="keywordflow">if</span> (comp(top_val, min_or_max)) {</div>
<div class="line"><span class="lineno">  364</span>        min_or_max = top_val;</div>
<div class="line"><span class="lineno">  365</span>        coord_lvl = layer.top;</div>
<div class="line"><span class="lineno">  366</span>    }</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">if</span> (lvl_min_or_max) *lvl_min_or_max = coord_lvl;</div>
<div class="line"><span class="lineno">  369</span>    <span class="keywordflow">return</span> min_or_max;</div>
<div class="line"><span class="lineno">  370</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index()</a>, <a class="el" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height()</a>, <a class="el" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure()</a>, <a class="el" href="structsharp_1_1LayerIndex.html#a29cd85832f403659b88daab19abac1ca">sharp::LayerIndex::kbot</a>, <a class="el" href="structsharp_1_1LayerIndex.html#a849a04de93753261c91c58b590e60ee2">sharp::LayerIndex::ktop</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a6170e3f412ab95b3ba8d9a93ae55dc67">layer_max()</a>, and <a class="el" href="namespacesharp.html#a01a9880c937f63e551893797253da4f7">layer_min()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a646b65095b84511b75f6a4a81e545e80_cgraph.svg" width="742" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a646b65095b84511b75f6a4a81e545e80_icgraph.svg" width="595" height="184"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="af016701e4a46d5c04d26c0a09c0aad38" name="af016701e4a46d5c04d26c0a09c0aad38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af016701e4a46d5c04d26c0a09c0aad38">&#9670;&#160;</a></span>lcl_temperature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::lcl_temperature </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dewpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the temperature of the LCL. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes the temperature of a parcels LCL in degres Kelvin given the parcel temperature and dewpoint in Kelvin.</p>
<p>This is implemented as in Bolton (1980) eq 15, and is considered to be within a 10th of a degree of the more exact iterative formula.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">dewpoint</td><td>(K)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>lcl_temperature (K) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00073">73</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>                                                         {</div>
<div class="line"><span class="lineno">   74</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordflow">if</span> ((temperature == MISSING) || (dewpoint == MISSING)) {</div>
<div class="line"><span class="lineno">   76</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   77</span>    }</div>
<div class="line"><span class="lineno">   78</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   79</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> c1 = 56.0f;</div>
<div class="line"><span class="lineno">   80</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> c2 = 800.0f;</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> term_1 = 1.0 / (dewpoint - c1);</div>
<div class="line"><span class="lineno">   83</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> term_2 = std::log(temperature / dewpoint) / c2;</div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">return</span> (1.0 / (term_1 + term_2)) + c1;</div>
<div class="line"><span class="lineno">   85</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#ae4385866921cd7286946d9ffdd65c25e">drylift()</a>, and <a class="el" href="thermo__wrap_8h.html#a29f0ebbfa05234df9f1e41b75c02688f">sharp_lcl_temperature()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_af016701e4a46d5c04d26c0a09c0aad38_icgraph.svg" width="1036" height="312"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a0bf533560780fdb77bc3656db8d89208" name="a0bf533560780fdb77bc3656db8d89208"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bf533560780fdb77bc3656db8d89208">&#9670;&#160;</a></span>lerp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::lerp </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>__a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>__b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>__t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Linearly interpolates between a and b with distance t. </p>
<dl class="section author"><dt>Author</dt><dd>C++20 Standard Template Library</dd></dl>
<p>This routine was copied from the C++20 standard template library. It is used to linearly interpolate between A and B over a normalized distance T, where 0 &lt;= T &lt;= 1. Full documentation and details can be found in the paper located here: <a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p0811r3.html">https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p0811r3.html</a></p>
<p>This linear interpolation guarantees the following:</p>
<ol type="1">
<li>Exactness: lerp(a,b,0)==a &amp; lerp(a,b,1)==b</li>
<li>Monotonicity: cmp(lerp(a,b,t2), lerp(a,b,t1)) * cmp(t2, t1)</li>
</ol>
<p>cmp(b,a) &gt;= 0, where cmp is an arithmetic three-way comparison function</p><ol type="1">
<li>Determinacy: result of NaN only for lerp(a,a,INFINITY)</li>
<li>Boundedness: t&lt;0 || t&gt;1 || isfinite(lerp(a,b,t))</li>
<li>Consistency: lerp(a,a,t) == a</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">__a</td><td>left value </td></tr>
    <tr><td class="paramname">__b</td><td>right value </td></tr>
    <tr><td class="paramname">__t</td><td>where 0 &lt;= __t &lt;= 1.0</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value between __a and __b at distance __t between them. </dd></dl>

<p class="definition">Definition at line <a class="el" href="interp_8h_source.html#l00093">93</a> of file <a class="el" href="interp_8h_source.html">interp.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>                                                    {</div>
<div class="line"><span class="lineno">   95</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#ac4464059524ff56c7974141bb4cc7375">__lerp</a>(__a, __b, __t);</div>
<div class="line"><span class="lineno">   96</span>}</div>
<div class="ttc" id="anamespacesharp_html_ac4464059524ff56c7974141bb4cc7375"><div class="ttname"><a href="namespacesharp.html#ac4464059524ff56c7974141bb4cc7375">sharp::__lerp</a></div><div class="ttdeci">constexpr _Fp __lerp(const _Fp __a, const _Fp __b, const _Fp __t)</div><div class="ttdoc">Linearly interpolates between a and b with distance t.</div><div class="ttdef"><b>Definition:</b> <a href="interp_8h_source.html#l00051">interp.h:51</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#ac4464059524ff56c7974141bb4cc7375">__lerp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height()</a>, and <a class="el" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a0bf533560780fdb77bc3656db8d89208_cgraph.svg" width="255" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a0bf533560780fdb77bc3656db8d89208_icgraph.svg" width="1278" height="1510"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a1edcf8bff9a13429bcbff7c1129024b3" name="a1edcf8bff9a13429bcbff7c1129024b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1edcf8bff9a13429bcbff7c1129024b3">&#9670;&#160;</a></span>lower_bound()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename C  = std::less&lt;&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr std::ptrdiff_t sharp::lower_bound </td>
          <td>(</td>
          <td class="paramtype">const T&#160;</td>
          <td class="paramname"><em>array</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const C&#160;</td>
          <td class="paramname"><em>cmp</em> = <code>C{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds the index of the lower bound that does not satisfy element &lt; value. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Based on std::lower_bound, this iterates over an array using a binary search to find the first element that does not satisfy the comparison condition. By default, the comparison is std::less. Binary search expects data to be sorted in ascending order &ndash; for pressure level data, change the comparitor.</p>
<p>We use a custom implementation of <a class="el" href="namespacesharp.html#a1edcf8bff9a13429bcbff7c1129024b3" title="Finds the index of the lower bound that does not satisfy element &lt; value.">sharp::lower_bound</a> rather than std::lower_bound for a few reasons. First, we prefer raw pointer arrays over vectors for easy integration with SWIG bindings, C code, and the potential future in which this runs on CUDA architecture. Currently, the algorithms in the STL library are not supported by the CUDA STL, but the types in &lt;functional&gt; (i.e. std::less) are supported by the CUDA STL. Additionally, this implementation of lower_bound is designed to reduce branching.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">array</td><td>The array to search over </td></tr>
    <tr><td class="paramname">N</td><td>The length of the array </td></tr>
    <tr><td class="paramname">value</td><td>The value for lower-bound comparison </td></tr>
    <tr><td class="paramname">cmp</td><td>The comparitor</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index of lower bound </dd></dl>

<p class="definition">Definition at line <a class="el" href="algorithms_8h_source.html#l00050">50</a> of file <a class="el" href="algorithms_8h_source.html">algorithms.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   53</span>                                                                  {}) {</div>
<div class="line"><span class="lineno">   54</span>    std::ptrdiff_t len = N;</div>
<div class="line"><span class="lineno">   55</span>    std::ptrdiff_t idx = 0;</div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordflow">while</span> (len &gt; 1) {</div>
<div class="line"><span class="lineno">   57</span>        std::ptrdiff_t half = len / 2;</div>
<div class="line"><span class="lineno">   58</span>        idx += cmp(array[idx + half - 1], value) * half;</div>
<div class="line"><span class="lineno">   59</span>        len -= half;  <span class="comment">// = ceil(len / 2)</span></div>
<div class="line"><span class="lineno">   60</span>    }</div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordflow">return</span> idx;</div>
<div class="line"><span class="lineno">   62</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a1edcf8bff9a13429bcbff7c1129024b3_icgraph.svg" width="1351" height="720"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a3c8b9022103d067f30281d68fa81cbda" name="a3c8b9022103d067f30281d68fa81cbda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c8b9022103d067f30281d68fa81cbda">&#9670;&#160;</a></span>mean_wind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a> sharp::mean_wind </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a>&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pres</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>u_wind</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>v_wind</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>weighted</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the mean wind over the given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes the mean wind over the given <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> and arrays of pressure and wind components with a length of N.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>{bottom, top} </td></tr>
    <tr><td class="paramname">pres</td><td>(Pa) </td></tr>
    <tr><td class="paramname">u_wind</td><td>(m/s) </td></tr>
    <tr><td class="paramname">v_wind</td><td>(m/s) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays) </td></tr>
    <tr><td class="paramname">weighted</td><td>(whether to weight by pressure level)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{mean_u, mean_v} </dd></dl>

<p class="definition">Definition at line <a class="el" href="winds_8cpp_source.html#l00104">104</a> of file <a class="el" href="winds_8cpp_source.html">winds.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  106</span>                                                                    {</div>
<div class="line"><span class="lineno">  107</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">if</span> ((layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a> == MISSING) || (layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> == MISSING))</div>
<div class="line"><span class="lineno">  109</span>        <span class="keywordflow">return</span> {MISSING, MISSING};</div>
<div class="line"><span class="lineno">  110</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">if</span> (layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a> &gt; pressure[0]) layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a> = pressure[0];</div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">if</span> (layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> &lt; pressure[N - 1]) layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> = pressure[N - 1];</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    <span class="keywordtype">float</span> pr_lvl = layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a>;</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordtype">float</span> u_sum = 0;</div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordtype">float</span> v_sum = 0;</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordtype">float</span> weight = 0;</div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordflow">while</span> (pr_lvl &gt;= layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a>) {</div>
<div class="line"><span class="lineno">  120</span>        <span class="keywordtype">float</span> w = (weighted) ? pr_lvl : 1.0f;</div>
<div class="line"><span class="lineno">  121</span>        u_sum += interp_pressure(pr_lvl, pressure, u_wind, N) * w;</div>
<div class="line"><span class="lineno">  122</span>        v_sum += interp_pressure(pr_lvl, pressure, v_wind, N) * w;</div>
<div class="line"><span class="lineno">  123</span>        weight += w;</div>
<div class="line"><span class="lineno">  124</span>        pr_lvl += layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a4444597984491f09fa0f4ae92c7984de">delta</a>;</div>
<div class="line"><span class="lineno">  125</span>    }</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> mean_u = u_sum / weight;</div>
<div class="line"><span class="lineno">  128</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> mean_v = v_sum / weight;</div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordflow">return</span> {mean_u, mean_v};</div>
<div class="line"><span class="lineno">  130</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">sharp::PressureLayer::bottom</a>, <a class="el" href="structsharp_1_1PressureLayer.html#a4444597984491f09fa0f4ae92c7984de">sharp::PressureLayer::delta</a>, <a class="el" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">sharp::PressureLayer::top</a>.</p>

<p class="reference">Referenced by <a class="el" href="winds__wrap_8h.html#a9995026cf811a9d4ec86b568b3201e63">sharp_mean_wind()</a>, and <a class="el" href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">storm_motion_bunkers()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a3c8b9022103d067f30281d68fa81cbda_cgraph.svg" width="719" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a3c8b9022103d067f30281d68fa81cbda_icgraph.svg" width="820" height="230"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a9edcf0847c46e877689081848c58e3f4" name="a9edcf0847c46e877689081848c58e3f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9edcf0847c46e877689081848c58e3f4">&#9670;&#160;</a></span>mixratio() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::mixratio </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the water vapor mixing ratio. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Returns the water vapor mixing ratio in kg/kg given the environmental pressure in Pascals (Pa) and a temperature (dry-bulb or dewpoint) in Kelvin.</p>
<p>This is computed by calling <a class="el" href="namespacesharp.html#a3e31a1a145fc25f07d6326481993b2c2" title="Compute the vapor pressure over liquid water.">sharp::vapor_pressure</a>, which uses the Bolton (1980) equations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixratio (kg/kg) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00129">129</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span>                                                  {</div>
<div class="line"><span class="lineno">  130</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">if</span> ((temperature == MISSING) || (pressure == MISSING)) {</div>
<div class="line"><span class="lineno">  132</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  133</span>    }</div>
<div class="line"><span class="lineno">  134</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> e = vapor_pressure(pressure, temperature);</div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">return</span> (EPSILON * e) / (pressure - e);</div>
<div class="line"><span class="lineno">  138</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a83dfda911c84f0dda42368d0c1b63ef1">EPSILON</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="namespacesharp.html#a3e31a1a145fc25f07d6326481993b2c2">vapor_pressure()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a9edcf0847c46e877689081848c58e3f4_cgraph.svg" width="347" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ac38870166f07ac30aadbc46b81340cc4" name="ac38870166f07ac30aadbc46b81340cc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac38870166f07ac30aadbc46b81340cc4">&#9670;&#160;</a></span>mixratio() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::mixratio </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the water vapor mixing ratio from specific humidity. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Returns the water vapor mixing ratio in kg/kg given the specific humidity in kg/kg.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>(kg/kg)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixratio (kg/kg) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00122">122</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  122</span>                        {</div>
<div class="line"><span class="lineno">  123</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">if</span> (q == MISSING) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  125</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordflow">return</span> q / (1.0 - q);</div>
<div class="line"><span class="lineno">  127</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>, <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, <a class="el" href="structsharp_1_1Parcel.html#a9523de2b8b4c28ca49fba3013f94cb06">sharp::Parcel::lift_parcel()</a>, <a class="el" href="structsharp_1_1lifter__wobus.html#a82be5bdfdff54890488bbc1461b5b05e">sharp::lifter_wobus::parcel_virtual_temperature()</a>, <a class="el" href="structsharp_1_1lifter__cm1.html#a4750e359411eefdfb6d4970052637750">sharp::lifter_cm1::setup()</a>, <a class="el" href="thermo__wrap_8h.html#add9103f2e5305de800352ce787a7c786">sharp_mixratio()</a>, and <a class="el" href="namespacesharp.html#ab06f16aa1caac3136e863db8cd61e2e9">thetae()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ac38870166f07ac30aadbc46b81340cc4_icgraph.svg" width="871" height="442"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a0ebcad18ef9939ff56f23d49c35dd04c" name="a0ebcad18ef9939ff56f23d49c35dd04c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ebcad18ef9939ff56f23d49c35dd04c">&#9670;&#160;</a></span>mixratio_ice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::mixratio_ice </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the ice water mixing ratio. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Returns the ice water mixing ratio in kg/kg given the environmental pressure in Pascals (Pa) and a temperature (dry-bulb or dewpoint) in Kelvin.</p>
<p>This is computed by calling <a class="el" href="namespacesharp.html#aaf448e4ec9a4f7ac7edc9b960f656fd8" title="Compute the vapor pressure over ice.">sharp::vapor_pressure_ice</a>, which uses the Bolton (1980) equations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mixratio (kg/kg) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00140">140</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  140</span>                                                      {</div>
<div class="line"><span class="lineno">  141</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">if</span> ((temperature == MISSING) || (pressure == MISSING)) {</div>
<div class="line"><span class="lineno">  143</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  144</span>    }</div>
<div class="line"><span class="lineno">  145</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  146</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> e = vapor_pressure_ice(pressure, temperature);</div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordflow">return</span> (EPSILON * e) / (pressure - e);</div>
<div class="line"><span class="lineno">  148</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a83dfda911c84f0dda42368d0c1b63ef1">EPSILON</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="namespacesharp.html#aaf448e4ec9a4f7ac7edc9b960f656fd8">vapor_pressure_ice()</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>, and <a class="el" href="thermo__wrap_8h.html#ab30e4198dc286932d722c0c5841cdfc6">sharp_mixratio_ice()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a0ebcad18ef9939ff56f23d49c35dd04c_cgraph.svg" width="398" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a0ebcad18ef9939ff56f23d49c35dd04c_icgraph.svg" width="836" height="123"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aa258841692c25171d3f3b2e8b1f52079" name="aa258841692c25171d3f3b2e8b1f52079"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa258841692c25171d3f3b2e8b1f52079">&#9670;&#160;</a></span>moist_adiabat_cm1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::moist_adiabat_cm1 </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>new_pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>rv_total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>rl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pres_incr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>converge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81">adiabat</a>&#160;</td>
          <td class="paramname"><em>ma_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the temperature of a parcel lifted moist adiabatically to a new level. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>With a given parcel defined by a pressure and temperature (in Pascals and Kelvin), lift it moist adiabatically to a new pressure level (in Pascals) and return the temperature of the parcel at that level.</p>
<p>This function is based on/ripped from George Byran's (NCAR) routine in CM1. It has several options for convergence criteria, pressure increments, and the type of moist adiabat/assumptions (i.e. pseudoadiabatic, adiabatic, liquid, liquid+ice). The <a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81" title="Defines the kinds of moist adiabats used by sharp::moist_adiabat_cm1.">sharp::adiabat</a> defines the types of adiabats, and the float references to qv, ql, and qi are used to keep budgets of the moisture variables.</p>
<p>NOTE: rv_total should most likely be the water vapor mixing ratio either at the parcel's <a class="el" href="namespacesharp.html#a03664f85e552919899eefba1c4a7997f" title="Enum that defines the lifted parcel level (LPL) of origin.">sharp::LPL</a>, or the water vapor mixing ratio at the LCL (these are going to be the same value). Essentially, the total water vapor before condensation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">new_pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">rv_total</td><td>(kg/kg) </td></tr>
    <tr><td class="paramname">rv</td><td>(kg/kg) </td></tr>
    <tr><td class="paramname">rl</td><td>(kg/kg) </td></tr>
    <tr><td class="paramname">ri</td><td>(kg/kg) </td></tr>
    <tr><td class="paramname">pres_incr</td><td>(Pa) </td></tr>
    <tr><td class="paramname">converge</td><td>(precision) </td></tr>
    <tr><td class="paramname">ma_type</td><td>(<a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81" title="Defines the kinds of moist adiabats used by sharp::moist_adiabat_cm1.">sharp::adiabat</a>)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pcl_temperature (K) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00288">288</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  290</span>                                                                          {</div>
<div class="line"><span class="lineno">  291</span>    <span class="comment">// set up solver variables</span></div>
<div class="line"><span class="lineno">  292</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> ice = (ma_type &gt;= adiabat::pseudo_ice) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  293</span>    <span class="keywordtype">float</span> dp = new_pressure - <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>;</div>
<div class="line"><span class="lineno">  294</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> ascending = std::signbit(dp);</div>
<div class="line"><span class="lineno">  295</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> n_iters =</div>
<div class="line"><span class="lineno">  296</span>        (std::abs(dp) &lt; pres_incr) ? 1 : 1 + (<span class="keywordtype">int</span>)(std::abs(dp) / pres_incr);</div>
<div class="line"><span class="lineno">  297</span>    dp = (n_iters == 1) ? dp : dp / (<span class="keywordtype">float</span>)n_iters;</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    <span class="comment">// Start by setting the &quot;top&quot; variables.</span></div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordtype">float</span> pcl_theta_next = <a class="code hl_function" href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">theta</a>(pressure, temperature);</div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordtype">float</span> pcl_pres_next = <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>;</div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordtype">float</span> pcl_pi_next = std::pow(pressure / THETA_REF_PRESSURE, ROCP);</div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordtype">float</span> pcl_t_next = pcl_theta_next * pcl_pi_next;</div>
<div class="line"><span class="lineno">  304</span>    <span class="keywordtype">float</span> pcl_rv_next = rv;</div>
<div class="line"><span class="lineno">  305</span>    <span class="keywordtype">float</span> pcl_rl_next = rl;</div>
<div class="line"><span class="lineno">  306</span>    <span class="keywordtype">float</span> pcl_ri_next = ri;</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <span class="comment">// Iterate the required number of times to reach the new pressure</span></div>
<div class="line"><span class="lineno">  309</span>    <span class="comment">// level from the old one in increments of dp</span></div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_iters; ++i) {</div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordtype">float</span> pcl_theta_prev = pcl_theta_next;</div>
<div class="line"><span class="lineno">  312</span>        <span class="keywordtype">float</span> pcl_pres_prev = pcl_pres_next;</div>
<div class="line"><span class="lineno">  313</span>        <span class="keywordtype">float</span> pcl_rv_prev = pcl_rv_next;</div>
<div class="line"><span class="lineno">  314</span>        <span class="keywordtype">float</span> pcl_rl_prev = pcl_rl_next;</div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordtype">float</span> pcl_ri_prev = pcl_ri_next;</div>
<div class="line"><span class="lineno">  316</span>        <span class="keywordtype">float</span> pcl_t_prev = pcl_t_next;</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>        pcl_pres_next += dp;</div>
<div class="line"><span class="lineno">  319</span>        pcl_pi_next = std::pow(pcl_pres_next / THETA_REF_PRESSURE, ROCP);</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>        <span class="comment">// call the iterative solver to get the new parcel</span></div>
<div class="line"><span class="lineno">  322</span>        <span class="comment">// theta accounting for liquid (and ice if enabled)</span></div>
<div class="line"><span class="lineno">  323</span>        pcl_theta_next = <a class="code hl_function" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1</a>(</div>
<div class="line"><span class="lineno">  324</span>            pcl_pres_next, pcl_pi_next, pcl_t_next, pcl_rv_next, pcl_rl_next,</div>
<div class="line"><span class="lineno">  325</span>            pcl_ri_next, pcl_pres_prev, pcl_t_prev, pcl_theta_prev, pcl_rv_prev,</div>
<div class="line"><span class="lineno">  326</span>            pcl_rl_prev, pcl_ri_prev, rv_total, ascending, ice, converge);</div>
<div class="line"><span class="lineno">  327</span>        <span class="comment">/*printf(&quot;%f %f\t%f\t%f %f\n&quot;, pcl_pres_prev, pcl_theta_prev,*/</span></div>
<div class="line"><span class="lineno">  328</span>        <span class="comment">/*       pcl_pres_next, pcl_rv_next, rv_total);*/</span></div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>        <span class="keywordflow">if</span> ((ma_type == adiabat::pseudo_liq) ||</div>
<div class="line"><span class="lineno">  331</span>            (ma_type == adiabat::pseudo_ice)) {</div>
<div class="line"><span class="lineno">  332</span>            rv_total = pcl_rv_next;</div>
<div class="line"><span class="lineno">  333</span>            pcl_rl_next = 0.0f;</div>
<div class="line"><span class="lineno">  334</span>            pcl_ri_next = 0.0f;</div>
<div class="line"><span class="lineno">  335</span>        }</div>
<div class="line"><span class="lineno">  336</span>    }</div>
<div class="line"><span class="lineno">  337</span>    pcl_t_next = pcl_theta_next * pcl_pi_next;</div>
<div class="line"><span class="lineno">  338</span>    rv = pcl_rv_next;</div>
<div class="line"><span class="lineno">  339</span>    rl = pcl_rl_next;</div>
<div class="line"><span class="lineno">  340</span>    ri = pcl_ri_next;</div>
<div class="line"><span class="lineno">  341</span>    <span class="keywordflow">return</span> pcl_t_next;</div>
<div class="line"><span class="lineno">  342</span>}</div>
<div class="ttc" id="anamespacesharp_html_a7494c22424745a8847092b64195fb9ae"><div class="ttname"><a href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">sharp::_solve_cm1</a></div><div class="ttdeci">float _solve_cm1(float &amp;pcl_pres_next, float &amp;pcl_pi_next, float &amp;pcl_t_next, float &amp;pcl_rv_next, float &amp;pcl_rl_next, float &amp;pcl_ri_next, float pcl_pres_prev, float pcl_t_prev, float pcl_theta_prev, float pcl_rv_prev, float pcl_rl_prev, float pcl_ri_prev, float rv_total, bool ascending, bool ice=false, float converge=0.0002f)</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00223">thermo.cpp:223</a></div></div>
<div class="ttc" id="anamespacesharp_html_acfd0143ab72871c4aabc95c1140ee8fb"><div class="ttname"><a href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">sharp::theta</a></div><div class="ttdeci">float theta(float pressure, float temperature, float ref_pressure=THETA_REF_PRESSURE)</div><div class="ttdoc">Compute the potential temperature.</div><div class="ttdef"><b>Definition:</b> <a href="thermo_8cpp_source.html#l00112">thermo.cpp:112</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, <a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81ad4a63946bf6f9aa1165238e71094024a">pseudo_ice</a>, <a class="el" href="namespacesharp.html#ad39fcd09ffea548c2aa8468c7d834d81a2950b2ab4ab4c2d385ff16dfae8003c0">pseudo_liq</a>, <a class="el" href="namespacesharp.html#a21aa81ae76506b5845830b588cbfb993">ROCP</a>, <a class="el" href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">theta()</a>, and <a class="el" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">THETA_REF_PRESSURE</a>.</p>

<p class="reference">Referenced by <a class="el" href="structsharp_1_1lifter__cm1.html#a2eeb5b118ef40e873c09ac9b3635f7b9">sharp::lifter_cm1::operator()()</a>, and <a class="el" href="thermo__wrap_8h.html#aac6beaaefcb6cf02512e6a74b6ab5be7">sharp_moist_adiabat_cm1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_aa258841692c25171d3f3b2e8b1f52079_cgraph.svg" width="831" height="110"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_aa258841692c25171d3f3b2e8b1f52079_icgraph.svg" width="447" height="102"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab5fed65fe0cdf797961047fb9cde3295" name="ab5fed65fe0cdf797961047fb9cde3295"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5fed65fe0cdf797961047fb9cde3295">&#9670;&#160;</a></span>moist_static_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::moist_static_energy </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>height_agl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>specific_humidity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute moist static energy. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">height_agl</td><td>(meters) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">specific_humidity</td><td>(kg/kg)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>moist static energy () </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00510">510</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  511</span>                                                   {</div>
<div class="line"><span class="lineno">  512</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordflow">if</span> ((height_agl == MISSING) || (temperature == MISSING) ||</div>
<div class="line"><span class="lineno">  514</span>        (specific_humidity == MISSING)) {</div>
<div class="line"><span class="lineno">  515</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  516</span>    }</div>
<div class="line"><span class="lineno">  517</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>    <span class="keywordflow">return</span> (CP_DRYAIR * temperature) + (EXP_LV * specific_humidity) +</div>
<div class="line"><span class="lineno">  520</span>           (GRAVITY * height_agl);</div>
<div class="line"><span class="lineno">  521</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#afda77fe7a6cefaab1ecb404167ed90b4">CP_DRYAIR</a>, <a class="el" href="namespacesharp.html#addc30683489f1fc452c739aeba758985">EXP_LV</a>, <a class="el" href="namespacesharp.html#a6e49daafd469b40abf4197bf26af2097">GRAVITY</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="namespacesharp.html#a792a4a2a9f9243a82fb44cb77c2ee561">specific_humidity()</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, and <a class="el" href="thermo__wrap_8h.html#a9c9c5dbb5d7955e51b8fd67d680850a3">sharp_moist_static_energy()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab5fed65fe0cdf797961047fb9cde3295_cgraph.svg" width="386" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab5fed65fe0cdf797961047fb9cde3295_icgraph.svg" width="620" height="102"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a31da980f398c9f6a5960ddf868101a94" name="a31da980f398c9f6a5960ddf868101a94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31da980f398c9f6a5960ddf868101a94">&#9670;&#160;</a></span>pressure_layer_to_height()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a> sharp::pressure_layer_to_height </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a>&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>toAGL</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> to a <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Converts a <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a> to a <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a> via interpolation, with the obtion of returning the layer in meters AGL or MSL. If for some strange reason you provide a <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">PressureLayer</a> that is out of the bounds of pressure[], then the bottom and top of the output layer will be set to <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">sharp::MISSING</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>(Pa) </td></tr>
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">height</td><td>(meters) </td></tr>
    <tr><td class="paramname">N</td><td>(Length of arrays) </td></tr>
    <tr><td class="paramname">toAGL</td><td>Flag whether to return meters AGL or MSL (default: false)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{bottom, top} </dd></dl>

<p class="definition">Definition at line <a class="el" href="layer_8cpp_source.html#l00113">113</a> of file <a class="el" href="layer_8cpp_source.html">layer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  116</span>                                                                             {</div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordflow">if</span> ((layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a> &gt; pressure[0]) || (layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> &lt; pressure[N - 1])) {</div>
<div class="line"><span class="lineno">  118</span>        <span class="keywordflow">return</span> {MISSING, MISSING};</div>
<div class="line"><span class="lineno">  119</span>    }</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordtype">float</span> zbot = <a class="code hl_function" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure</a>(layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a>, pressure, height, N);</div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordtype">float</span> ztop = <a class="code hl_function" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure</a>(layer.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a>, pressure, height, N);</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">if</span> (toAGL) {</div>
<div class="line"><span class="lineno">  125</span>        zbot -= <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[0];</div>
<div class="line"><span class="lineno">  126</span>        ztop -= <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[0];</div>
<div class="line"><span class="lineno">  127</span>    }</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordflow">return</span> {zbot, ztop};</div>
<div class="line"><span class="lineno">  130</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">sharp::PressureLayer::bottom</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">sharp::PressureLayer::top</a>.</p>

<p class="reference">Referenced by <a class="el" href="structsharp_1_1Parcel.html#a0560bd193b2d2d6bc6b08baa7463fba4">sharp::Parcel::cape_cinh()</a>, <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, <a class="el" href="namespacesharp.html#aa4e86da659bfca2eae1f0baddb84a303">lapse_rate()</a>, <a class="el" href="layer__wrap_8cpp.html#ad026c34f615f290fcd838421ed3dd192">sharp_PressureLayer_to_HeightLayer()</a>, and <a class="el" href="namespacesharp.html#ab31d383a3231f8fef873e5a16c0db856">storm_motion_bunkers()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a31da980f398c9f6a5960ddf868101a94_cgraph.svg" width="740" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a31da980f398c9f6a5960ddf868101a94_icgraph.svg" width="852" height="339"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab8a75ed92a2c2062162264a54f3a5338" name="ab8a75ed92a2c2062162264a54f3a5338"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8a75ed92a2c2062162264a54f3a5338">&#9670;&#160;</a></span>saturated_lift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::saturated_lift </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>theta_sat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>converge</em> = <code>0.001f</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the temperature along a moist adiabat (wet-bulb potential temperature) at a given pressure. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>Compute the temperature at which the moist adiabat intersects a line of constant pressure on a Skew-T log-P diagram. The wet-bulb potential temperature, given by theta_sat, defines a moist adiabat in Kelvin, and the temperature at the given pressure level in Pascals (Pa) is returned.</p>
<p>This function relies on the Wobus Function ( <a class="el" href="namespacesharp.html#ab535b8214969a50771219a275ebb7f4d" title="Computes the difference between the wet-bulb potential temperatures for saturated and dry air given t...">sharp::wobf</a> ), and it was shown by Robert Davies-Jones (2007) that the Wobus function has a slight dependence on pressure, which results in errors of up to 1.2 Kelvin in the temperature of a lifted parcel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">theta_sat</td><td>(K) </td></tr>
    <tr><td class="paramname">converge</td><td>(convergence criteria; default = 0.001f)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>lifted_temperature (K) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00167">167</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  167</span>                                                                      {</div>
<div class="line"><span class="lineno">  168</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">if</span> ((pressure == MISSING) || (theta_sat == MISSING)) {</div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  171</span>    }</div>
<div class="line"><span class="lineno">  172</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>    <span class="keywordflow">if</span> (std::fabs(pressure - THETA_REF_PRESSURE) &lt;= converge) <span class="keywordflow">return</span> theta_sat;</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> pwrp = std::pow(pressure / THETA_REF_PRESSURE, ROCP);</div>
<div class="line"><span class="lineno">  177</span>    <span class="comment">// get the temperature</span></div>
<div class="line"><span class="lineno">  178</span>    <span class="keywordtype">float</span> t1 = theta_sat * pwrp;</div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordtype">float</span> e1 = wobf(t1) - wobf(theta_sat);</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordtype">float</span> rate = 1.0f;</div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordtype">float</span> eor = 999;</div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordtype">float</span> t2;</div>
<div class="line"><span class="lineno">  183</span>    <span class="keywordtype">int</span> condition = 0;</div>
<div class="line"><span class="lineno">  184</span>    <span class="comment">// Testing the original showed that only</span></div>
<div class="line"><span class="lineno">  185</span>    <span class="comment">// 5 or so iterations are needed, but</span></div>
<div class="line"><span class="lineno">  186</span>    <span class="comment">// double that just in case. It&#39;ll exit</span></div>
<div class="line"><span class="lineno">  187</span>    <span class="comment">// early if it converges anyway.</span></div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter = 0; iter &lt; 10; ++iter) {</div>
<div class="line"><span class="lineno">  189</span>        t2 = t1 - e1 * rate;</div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordtype">float</span> e2 = (t2) / pwrp;</div>
<div class="line"><span class="lineno">  191</span>        e2 = e2 + wobf(t2) - wobf(e2) - theta_sat;</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>        eor = e2 * rate;</div>
<div class="line"><span class="lineno">  194</span>        rate = (t2 - t1) / (e2 - e1);</div>
<div class="line"><span class="lineno">  195</span>        t1 = t2;</div>
<div class="line"><span class="lineno">  196</span>        e1 = e2;</div>
<div class="line"><span class="lineno">  197</span>        condition |= (std::fabs(eor) &lt;= converge);</div>
<div class="line"><span class="lineno">  198</span>        <span class="keywordflow">if</span> (condition) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  199</span>    }</div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordflow">return</span> t2 - eor;</div>
<div class="line"><span class="lineno">  201</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, <a class="el" href="namespacesharp.html#a21aa81ae76506b5845830b588cbfb993">ROCP</a>, <a class="el" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">THETA_REF_PRESSURE</a>, and <a class="el" href="namespacesharp.html#ab535b8214969a50771219a275ebb7f4d">wobf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="thermo__wrap_8h.html#a9f2ca1ce5fd50b35722fd2a5f8330f47">sharp_saturated_lift()</a>, and <a class="el" href="namespacesharp.html#ad4014313c60a66a321e4050a2a07058e">wetlift()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab8a75ed92a2c2062162264a54f3a5338_cgraph.svg" width="310" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab8a75ed92a2c2062162264a54f3a5338_icgraph.svg" width="555" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a6eeef5c5c9f1cbe1736996eaf8fe9ae5" name="a6eeef5c5c9f1cbe1736996eaf8fe9ae5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eeef5c5c9f1cbe1736996eaf8fe9ae5">&#9670;&#160;</a></span>significant_tornado_parameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::significant_tornado_parameter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1Parcel.html">Parcel</a>&#160;</td>
          <td class="paramname"><em>pcl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>lcl_hght_agl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>storm_relative_helicity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>bulk_wind_difference</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="convective_8cpp_source.html#l00254">254</a> of file <a class="el" href="convective_8cpp_source.html">convective.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  256</span>                                                                {</div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordtype">float</span> cinh_term, lcl_term, shear_term, srh_term, cape_term;</div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">if</span> (pcl.<a class="code hl_variable" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">cape</a> == MISSING) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordflow">if</span> (pcl.<a class="code hl_variable" href="structsharp_1_1Parcel.html#af2f4106c560b37ed8d13c3f272fa68a4">cinh</a> &gt;= -50.0)</div>
<div class="line"><span class="lineno">  261</span>        cinh_term = 1.0;</div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pcl.<a class="code hl_variable" href="structsharp_1_1Parcel.html#af2f4106c560b37ed8d13c3f272fa68a4">cinh</a> &lt; -200.0)</div>
<div class="line"><span class="lineno">  263</span>        cinh_term = 0.0;</div>
<div class="line"><span class="lineno">  264</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  265</span>        cinh_term = ((200.0 + pcl.<a class="code hl_variable" href="structsharp_1_1Parcel.html#af2f4106c560b37ed8d13c3f272fa68a4">cinh</a>) / 150.0);</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>    <span class="comment">// units of comparisons are meters</span></div>
<div class="line"><span class="lineno">  268</span>    <span class="keywordflow">if</span> (lcl_hght_agl &lt; 1000.0)</div>
<div class="line"><span class="lineno">  269</span>        lcl_term = 1.0;</div>
<div class="line"><span class="lineno">  270</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lcl_hght_agl &gt; 2000.0)</div>
<div class="line"><span class="lineno">  271</span>        lcl_term = 0.0;</div>
<div class="line"><span class="lineno">  272</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  273</span>        lcl_term = ((2000.0 - lcl_hght_agl) / 1000.0);</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>    <span class="comment">// units of comparisons are m/s</span></div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">if</span> (bulk_wind_difference &gt; 30)</div>
<div class="line"><span class="lineno">  277</span>        shear_term = 1.5;</div>
<div class="line"><span class="lineno">  278</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bulk_wind_difference &lt; 12.5)</div>
<div class="line"><span class="lineno">  279</span>        shear_term = 0.0;</div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  281</span>        shear_term = bulk_wind_difference / 20.0;</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">if</span> (storm_relative_helicity == MISSING)</div>
<div class="line"><span class="lineno">  284</span>        srh_term = 0.0;</div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  286</span>        srh_term = storm_relative_helicity / 150.0;</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    cape_term = pcl.<a class="code hl_variable" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">cape</a> / 1500.0;</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <span class="keywordtype">float</span> stp = cape_term * cinh_term * lcl_term * srh_term * shear_term;</div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">if</span> (stp &lt; 0) stp = 0;</div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordflow">return</span> stp;</div>
<div class="line"><span class="lineno">  293</span>}</div>
<div class="ttc" id="astructsharp_1_1Parcel_html_af2f4106c560b37ed8d13c3f272fa68a4"><div class="ttname"><a href="structsharp_1_1Parcel.html#af2f4106c560b37ed8d13c3f272fa68a4">sharp::Parcel::cinh</a></div><div class="ttdeci">float cinh</div><div class="ttdoc">Parcel Convective Inhibition (J/kg) between the LFC and EL.</div><div class="ttdef"><b>Definition:</b> <a href="parcel_8h_source.html#l00272">parcel.h:272</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1Parcel.html#abe6f9e3ee98fde1d361814a5d6384b1a">sharp::Parcel::cape</a>, <a class="el" href="structsharp_1_1Parcel.html#af2f4106c560b37ed8d13c3f272fa68a4">sharp::Parcel::cinh</a>, and <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>.</p>

<p class="reference">Referenced by <a class="el" href="convective__wrap_8h.html#a1f68f58bf144a9465dc98d4bdfc55317">sharp_significant_tornado_parameter()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a6eeef5c5c9f1cbe1736996eaf8fe9ae5_icgraph.svg" width="403" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a792a4a2a9f9243a82fb44cb77c2ee561" name="a792a4a2a9f9243a82fb44cb77c2ee561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a792a4a2a9f9243a82fb44cb77c2ee561">&#9670;&#160;</a></span>specific_humidity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::specific_humidity </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>rv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute specific humidity from a mixing ratio. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Returns the specific humidity given the mixing ratio.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rv</td><td>(kg/kg)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>specific_humidity (unitless) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00150">150</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  150</span>                                  {</div>
<div class="line"><span class="lineno">  151</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordflow">if</span> (rv == MISSING) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  153</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordflow">return</span> rv / (1.0 + rv);</div>
<div class="line"><span class="lineno">  155</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, <a class="el" href="namespacesharp.html#ab5fed65fe0cdf797961047fb9cde3295">moist_static_energy()</a>, and <a class="el" href="thermo__wrap_8h.html#a57cc5deecd6d890490139407a981749e">sharp_specific_humidity()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a792a4a2a9f9243a82fb44cb77c2ee561_icgraph.svg" width="880" height="151"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a74a735636c932467b4d2ced544e0cb51" name="a74a735636c932467b4d2ced544e0cb51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74a735636c932467b4d2ced544e0cb51">&#9670;&#160;</a></span>storm_motion_bunkers() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a> sharp::storm_motion_bunkers </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>u_wind</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>v_wind</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a>&#160;</td>
          <td class="paramname"><em>mean_wind_layer_agl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsharp_1_1HeightLayer.html">HeightLayer</a>&#160;</td>
          <td class="paramname"><em>wind_shear_layer_agl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>leftMover</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>pressureWeighted</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimates supercell storm motion using the Bunkers et al. 2000 method. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Estimates supercell storm motion using the Bunkers et al. 2000 method described in the following paper: <a href="https://doi.org/10.1175/1520-0434(2000)015%3C0061:PSMUAN%3E2.0.CO;2">https://doi.org/10.1175/1520-0434(2000)015%3C0061:PSMUAN%3E2.0.CO;2</a></p>
<p>This does not use any of the updated methods described by Bunkers et al. 2014, which uses Effective Inflow Layer metricks to get better estimates of storm motion, especially when considering elevated convection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">height</td><td>(meters) </td></tr>
    <tr><td class="paramname">u_wind</td><td>(m/s) </td></tr>
    <tr><td class="paramname">v_wind</td><td>(m/s) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays) </td></tr>
    <tr><td class="paramname">mean_wind_layer_agl</td><td>{bottom, top} </td></tr>
    <tr><td class="paramname">wind_shear_layer_agl</td><td>{bottom, top} </td></tr>
    <tr><td class="paramname">leftMover</td><td>(default=false) </td></tr>
    <tr><td class="paramname">pressureWeighted</td><td>(default=false)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{storm_u, storm_v} </dd></dl>

<p class="definition">Definition at line <a class="el" href="convective_8cpp_source.html#l00037">37</a> of file <a class="el" href="convective_8cpp_source.html">convective.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   41</span>                                                                       {</div>
<div class="line"><span class="lineno">   42</span>    <span class="keyword">constexpr</span> <span class="keywordtype">float</span> deviation = 7.5;  <span class="comment">// deviation from mean wind in m/s</span></div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_struct" href="structsharp_1_1PressureLayer.html">PressureLayer</a> mw_lyr = <a class="code hl_function" href="namespacesharp.html#ab77e344c7462c9615b0ddac228bc2193">height_layer_to_pressure</a>(mean_wind_layer_agl,</div>
<div class="line"><span class="lineno">   45</span>                                                    pressure, height, N, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>    <a class="code hl_struct" href="structsharp_1_1WindComponents.html">WindComponents</a> layer_mean_wind = {MISSING, MISSING};</div>
<div class="line"><span class="lineno">   48</span>    layer_mean_wind =</div>
<div class="line"><span class="lineno">   49</span>        mean_wind(mw_lyr, pressure, u_wind, v_wind, N, pressureWeighted);</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>    <span class="comment">// The shear is computed by finding the 500m deep</span></div>
<div class="line"><span class="lineno">   52</span>    <span class="comment">// mean winds at the top and bottom of the wind_shear_layer</span></div>
<div class="line"><span class="lineno">   53</span>    <span class="comment">// and then differencing the two. Means are not pressure weighted</span></div>
<div class="line"><span class="lineno">   54</span>    <span class="comment">// for the non-parcel based method.</span></div>
<div class="line"><span class="lineno">   55</span>    HeightLayer h_layer_lo = {wind_shear_layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a>,</div>
<div class="line"><span class="lineno">   56</span>                              wind_shear_layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">bottom</a> + 500.0f};</div>
<div class="line"><span class="lineno">   57</span>    HeightLayer h_layer_hi = {wind_shear_layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a> - 500.0f,</div>
<div class="line"><span class="lineno">   58</span>                              wind_shear_layer_agl.<a class="code hl_variable" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">top</a>};</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>    PressureLayer p_layer_lo =</div>
<div class="line"><span class="lineno">   61</span>        <a class="code hl_function" href="namespacesharp.html#ab77e344c7462c9615b0ddac228bc2193">height_layer_to_pressure</a>(h_layer_lo, pressure, height, N, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">   62</span>    PressureLayer p_layer_hi =</div>
<div class="line"><span class="lineno">   63</span>        <a class="code hl_function" href="namespacesharp.html#ab77e344c7462c9615b0ddac228bc2193">height_layer_to_pressure</a>(h_layer_hi, pressure, height, N, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>    WindComponents winds_lo =</div>
<div class="line"><span class="lineno">   66</span>        <a class="code hl_function" href="namespacesharp.html#a3c8b9022103d067f30281d68fa81cbda">mean_wind</a>(p_layer_lo, pressure, u_wind, v_wind, N, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">   67</span>    WindComponents winds_hi =</div>
<div class="line"><span class="lineno">   68</span>        <a class="code hl_function" href="namespacesharp.html#a3c8b9022103d067f30281d68fa81cbda">mean_wind</a>(p_layer_hi, pressure, u_wind, v_wind, N, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> shear_u = winds_hi.u - winds_lo.u;</div>
<div class="line"><span class="lineno">   71</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> shear_v = winds_hi.v - winds_lo.v;</div>
<div class="line"><span class="lineno">   72</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> mag = <a class="code hl_function" href="namespacesharp.html#af887f27accb1a1d656a35abec65cab5f">vector_magnitude</a>(shear_u, shear_v);</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordtype">float</span> storm_u = MISSING;</div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordtype">float</span> storm_v = MISSING;</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">if</span> (leftMover) {</div>
<div class="line"><span class="lineno">   78</span>        storm_u = layer_mean_wind.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">u</a> - ((deviation / mag) * shear_v);</div>
<div class="line"><span class="lineno">   79</span>        storm_v = layer_mean_wind.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">v</a> + ((deviation / mag) * shear_u);</div>
<div class="line"><span class="lineno">   80</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   81</span>        storm_u = layer_mean_wind.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">u</a> + ((deviation / mag) * shear_v);</div>
<div class="line"><span class="lineno">   82</span>        storm_v = layer_mean_wind.<a class="code hl_variable" href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">v</a> - ((deviation / mag) * shear_u);</div>
<div class="line"><span class="lineno">   83</span>    }</div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">return</span> {storm_u, storm_v};</div>
<div class="line"><span class="lineno">   85</span>}</div>
<div class="ttc" id="anamespacesharp_html_a3c8b9022103d067f30281d68fa81cbda"><div class="ttname"><a href="namespacesharp.html#a3c8b9022103d067f30281d68fa81cbda">sharp::mean_wind</a></div><div class="ttdeci">WindComponents mean_wind(PressureLayer layer, const float pres[], const float u_wind[], const float v_wind[], const std::ptrdiff_t N, const bool weighted)</div><div class="ttdoc">Compute the mean wind over the given sharp::PressureLayer.</div><div class="ttdef"><b>Definition:</b> <a href="winds_8cpp_source.html#l00104">winds.cpp:104</a></div></div>
<div class="ttc" id="astructsharp_1_1WindComponents_html"><div class="ttname"><a href="structsharp_1_1WindComponents.html">sharp::WindComponents</a></div><div class="ttdoc">A simple structure of two names floats that represent the components of a wind vector.</div><div class="ttdef"><b>Definition:</b> <a href="winds_8h_source.html#l00048">winds.h:48</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">sharp::HeightLayer::bottom</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="namespacesharp.html#ab77e344c7462c9615b0ddac228bc2193">height_layer_to_pressure()</a>, <a class="el" href="namespacesharp.html#a3c8b9022103d067f30281d68fa81cbda">mean_wind()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, <a class="el" href="structsharp_1_1HeightLayer.html#a482aa23d807be5d28d98ac96dc6434d0">sharp::HeightLayer::top</a>, <a class="el" href="structsharp_1_1WindComponents.html#a22a9ed9c3191bd7ff6b9235b3adb846e">sharp::WindComponents::u</a>, <a class="el" href="structsharp_1_1WindComponents.html#aff73fe4ca73b059b4b655358aa782b45">sharp::WindComponents::v</a>, and <a class="el" href="namespacesharp.html#af887f27accb1a1d656a35abec65cab5f">vector_magnitude()</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, <a class="el" href="convective__wrap_8h.html#aa0e261971f41c6f95514e9ab584cc91e">sharp_storm_motion_bunkers()</a>, <a class="el" href="convective__wrap_8h.html#a9c1783d5b0cde5deea749c0f4e0ee310">sharp_storm_motion_bunkers_np()</a>, and <a class="el" href="namespacesharp.html#ab31d383a3231f8fef873e5a16c0db856">storm_motion_bunkers()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a74a735636c932467b4d2ced544e0cb51_cgraph.svg" width="967" height="151"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a74a735636c932467b4d2ced544e0cb51_icgraph.svg" width="631" height="230"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab31d383a3231f8fef873e5a16c0db856" name="ab31d383a3231f8fef873e5a16c0db856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab31d383a3231f8fef873e5a16c0db856">&#9670;&#160;</a></span>storm_motion_bunkers() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a> sharp::storm_motion_bunkers </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>pressure</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>height</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>u_wind</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>v_wind</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsharp_1_1PressureLayer.html">PressureLayer</a>&#160;</td>
          <td class="paramname"><em>eff_infl_lyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsharp_1_1Parcel.html">Parcel</a> *&#160;</td>
          <td class="paramname"><em>mupcl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>leftMover</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimates supercell storm motion by using the Bunkers et al. 2014 method. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Estimates supercell storm motion using the Bunkers et al. 2014 method described in the following paper: <a href="http://dx.doi.org/10.15191/nwajom.2014.0211">http://dx.doi.org/10.15191/nwajom.2014.0211</a></p>
<p>This method is parcel based, using a mean-wind vector defined as the pressure-weighted mean wind between the Effective Inflow Layer surface (see <a class="el" href="namespacesharp.html#a2e6b7cd4a3594a8f2c2050b0e4784cce" title="Computes the Effective Inflow Layer for a given atmospheric sounding.">sharp::effective_inflow_layer</a>) and 65% of the depth between that surface and the most-unstable parcel's Equilibrium Level. This method produces the same storm motion estimate for surface based supercells, and captures the motion of elevated supercells much better than the Bunkers 2000 method.</p>
<p>The input parameters eff_infl_lyr and mupcl (effective inflow layer bounds and the most unstable parcel, respectively) are required to be be precomputed and passed to this routine. These are expensive operations that are presumed to be computed at some other point in the analysis pipeline, so just pass those variables here.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">height</td><td>(meters) </td></tr>
    <tr><td class="paramname">u_wind</td><td>(m/s) </td></tr>
    <tr><td class="paramname">v_wind</td><td>(m/s) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays) </td></tr>
    <tr><td class="paramname">eff_infl_lyr</td><td>{bottom, top} </td></tr>
    <tr><td class="paramname">mupcl</td><td>(Precomputed parcel) </td></tr>
    <tr><td class="paramname">leftMover</td><td>(default=false)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{storm_u, storm_v} </dd></dl>

<p class="definition">Definition at line <a class="el" href="convective_8cpp_source.html#l00087">87</a> of file <a class="el" href="convective_8cpp_source.html">convective.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   90</span>                                                       {</div>
<div class="line"><span class="lineno">   91</span>    <a class="code hl_struct" href="structsharp_1_1HeightLayer.html">HeightLayer</a> shr_layer = {0, 6000.0};</div>
<div class="line"><span class="lineno">   92</span>    HeightLayer dflt_mw_lyr = {0.0, 6000.0};</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">if</span> (mupcl-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#ac76710675fd2f495d52ac35d0d1de246">eql_pressure</a> == MISSING) {</div>
<div class="line"><span class="lineno">   95</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">storm_motion_bunkers</a>(pressure, height, u_wind, v_wind, N,</div>
<div class="line"><span class="lineno">   96</span>                                    dflt_mw_lyr, shr_layer, leftMover, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">   97</span>    }</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> eql_pres = mupcl-&gt;<a class="code hl_variable" href="structsharp_1_1Parcel.html#ac76710675fd2f495d52ac35d0d1de246">eql_pressure</a>;</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">if</span> ((eff_infl_lyr.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">bottom</a> == MISSING) || (eff_infl_lyr.<a class="code hl_variable" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">top</a> == MISSING)) {</div>
<div class="line"><span class="lineno">  101</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">storm_motion_bunkers</a>(pressure, height, u_wind, v_wind, N,</div>
<div class="line"><span class="lineno">  102</span>                                    dflt_mw_lyr, shr_layer, leftMover, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  103</span>    }</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>    HeightLayer eil_hght =</div>
<div class="line"><span class="lineno">  106</span>        <a class="code hl_function" href="namespacesharp.html#a31da980f398c9f6a5960ddf868101a94">pressure_layer_to_height</a>(eff_infl_lyr, pressure, height, N, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordtype">float</span> eql_ht = <a class="code hl_function" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure</a>(eql_pres, pressure, height, N);</div>
<div class="line"><span class="lineno">  109</span>    <span class="comment">// get AGL</span></div>
<div class="line"><span class="lineno">  110</span>    eql_ht -= <a class="code hl_enumvalue" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>[0];</div>
<div class="line"><span class="lineno">  111</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> htop = 0.65 * (eql_ht - eil_hght.bottom);</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">if</span> ((htop &lt; 3000.0f) || (eil_hght.bottom &gt; htop)) {</div>
<div class="line"><span class="lineno">  114</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">storm_motion_bunkers</a>(pressure, height, u_wind, v_wind, N,</div>
<div class="line"><span class="lineno">  115</span>                                    dflt_mw_lyr, shr_layer, leftMover, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  116</span>    }</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    HeightLayer mw_layer = {eil_hght.bottom, htop};</div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">storm_motion_bunkers</a>(pressure, height, u_wind, v_wind, N, mw_layer,</div>
<div class="line"><span class="lineno">  120</span>                                shr_layer, leftMover, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  121</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1HeightLayer.html#a0e1207130406a14e4362a933a72e6588">sharp::HeightLayer::bottom</a>, <a class="el" href="structsharp_1_1PressureLayer.html#a22a8b0e57b0b2e23f87a1f23e6b2cf96">sharp::PressureLayer::bottom</a>, <a class="el" href="structsharp_1_1Parcel.html#ac76710675fd2f495d52ac35d0d1de246">sharp::Parcel::eql_pressure</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ab435e227d5dd201e1768b2bcb2e0aa81">height</a>, <a class="el" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, <a class="el" href="namespacesharp.html#a31da980f398c9f6a5960ddf868101a94">pressure_layer_to_height()</a>, <a class="el" href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">storm_motion_bunkers()</a>, and <a class="el" href="structsharp_1_1PressureLayer.html#adb2306e425e88885902cde3e8f84531a">sharp::PressureLayer::top</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab31d383a3231f8fef873e5a16c0db856_cgraph.svg" width="1178" height="266"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a7d1cb8e1918ad656aceef6a512151483" name="a7d1cb8e1918ad656aceef6a512151483"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d1cb8e1918ad656aceef6a512151483">&#9670;&#160;</a></span>supercell_composite_parameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::supercell_composite_parameter </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>mu_cape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>eff_srh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>eff_shear</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="convective_8cpp_source.html#l00232">232</a> of file <a class="el" href="convective_8cpp_source.html">convective.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  233</span>                                                     {</div>
<div class="line"><span class="lineno">  234</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">if</span> ((mu_cape == MISSING) || (eff_srh == MISSING) ||</div>
<div class="line"><span class="lineno">  236</span>        (eff_shear == MISSING)) {</div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  238</span>    }</div>
<div class="line"><span class="lineno">  239</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordflow">if</span> (eff_shear &gt; 20.0) {</div>
<div class="line"><span class="lineno">  242</span>        eff_shear = 20.0;</div>
<div class="line"><span class="lineno">  243</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eff_shear &lt; 10.0) {</div>
<div class="line"><span class="lineno">  244</span>        eff_shear = 0.0;</div>
<div class="line"><span class="lineno">  245</span>    }</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> mu_cape_term = mu_cape / 1000.0f;</div>
<div class="line"><span class="lineno">  248</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> eff_srh_term = eff_srh / 50.0f;</div>
<div class="line"><span class="lineno">  249</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> eff_shear_term = eff_shear / 20.0f;</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>    <span class="keywordflow">return</span> mu_cape_term * eff_srh_term * eff_shear_term;</div>
<div class="line"><span class="lineno">  252</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>.</p>

<p class="reference">Referenced by <a class="el" href="convective__wrap_8h.html#abc12316a31f9b0bde658d1d481af80e2">sharp_supercell_composite_parameter()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a7d1cb8e1918ad656aceef6a512151483_icgraph.svg" width="458" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a90a9ae3f1a154cecbcf65d7dbf19233f" name="a90a9ae3f1a154cecbcf65d7dbf19233f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90a9ae3f1a154cecbcf65d7dbf19233f">&#9670;&#160;</a></span>temperature_at_mixratio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::temperature_at_mixratio </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>wv_mixratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the temperature at a given water vapor mixing ratio and pressure level. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes the temperature in Kelvin of air at the given water vapor mixing ratio in kg/kg and the air pressure in Pa.</p>
<p>The routine is implemented as in Bolton (1980) eq 11, and is considered to be accurate to 0.03 for -35C &lt;= T &lt;= 35C</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wv_mixratio</td><td>(kg/kg) </td></tr>
    <tr><td class="paramname">pressure</td><td>(Pa)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>temperature (K) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00087">87</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   87</span>                                                                 {</div>
<div class="line"><span class="lineno">   88</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordflow">if</span> ((wv_mixratio == MISSING) || (pressure == MISSING)) {</div>
<div class="line"><span class="lineno">   90</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   91</span>    }</div>
<div class="line"><span class="lineno">   92</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordtype">float</span> es = (wv_mixratio / EPSILON) * pressure / 100.0f /</div>
<div class="line"><span class="lineno">   94</span>               (1.0 + (wv_mixratio / EPSILON));</div>
<div class="line"><span class="lineno">   95</span>    <span class="comment">// for extremely cold temperatures</span></div>
<div class="line"><span class="lineno">   96</span>    es = std::min(es, pressure * 0.5f);</div>
<div class="line"><span class="lineno">   97</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> el = std::log(es);</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">return</span> ZEROCNK + (243.5f * el - 440.8f) / (19.48f - el);</div>
<div class="line"><span class="lineno">   99</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a83dfda911c84f0dda42368d0c1b63ef1">EPSILON</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="namespacesharp.html#aa8d73d01806950def2c52b818f90cb6c">ZEROCNK</a>.</p>

<p class="reference">Referenced by <a class="el" href="structsharp_1_1Parcel.html#a1bf670e79f35a1ce8c904b7ead32ccbe">sharp::Parcel::mixed_layer_parcel()</a>, and <a class="el" href="thermo__wrap_8h.html#ab4888413f15a8c5d29a4a5ebdc1ff629">sharp_temperature_at_mixratio()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a90a9ae3f1a154cecbcf65d7dbf19233f_icgraph.svg" width="372" height="115"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="acfd0143ab72871c4aabc95c1140ee8fb" name="acfd0143ab72871c4aabc95c1140ee8fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfd0143ab72871c4aabc95c1140ee8fb">&#9670;&#160;</a></span>theta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::theta </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>ref_pressure</em> = <code><a class="el" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">THETA_REF_PRESSURE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the potential temperature. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>Returns the potential temperature in Kelvin of a parcel given its pressure in Pascals and temperature in Kelvin. The final argument is the reference level, which is usually 100000.0 Pa, conveniently also called <a class="el" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">sharp::THETA_REF_PRESSURE</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">ref_pressure</td><td>(Pa)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>potential_temperature (K) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00112">112</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  112</span>                                                                   {</div>
<div class="line"><span class="lineno">  113</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">if</span> ((temperature == MISSING) || (pressure == MISSING) ||</div>
<div class="line"><span class="lineno">  115</span>        (ref_pressure == MISSING)) {</div>
<div class="line"><span class="lineno">  116</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  117</span>    }</div>
<div class="line"><span class="lineno">  118</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordflow">return</span> (temperature * std::pow(ref_pressure / pressure, ROCP));</div>
<div class="line"><span class="lineno">  120</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="namespacesharp.html#a21aa81ae76506b5845830b588cbfb993">ROCP</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#ae4385866921cd7286946d9ffdd65c25e">drylift()</a>, <a class="el" href="structsharp_1_1Parcel.html#a9523de2b8b4c28ca49fba3013f94cb06">sharp::Parcel::lift_parcel()</a>, <a class="el" href="structsharp_1_1Parcel.html#a1bf670e79f35a1ce8c904b7ead32ccbe">sharp::Parcel::mixed_layer_parcel()</a>, <a class="el" href="namespacesharp.html#aa258841692c25171d3f3b2e8b1f52079">moist_adiabat_cm1()</a>, <a class="el" href="thermo__wrap_8h.html#a2060b4dede3b850478f20bbff8380eb0">sharp_theta()</a>, <a class="el" href="namespacesharp.html#ab06f16aa1caac3136e863db8cd61e2e9">thetae()</a>, and <a class="el" href="namespacesharp.html#ad4014313c60a66a321e4050a2a07058e">wetlift()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_acfd0143ab72871c4aabc95c1140ee8fb_icgraph.svg" width="1028" height="540"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab50b565bcba73d207dc1433dee5b03c9" name="ab50b565bcba73d207dc1433dee5b03c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab50b565bcba73d207dc1433dee5b03c9">&#9670;&#160;</a></span>theta_level()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::theta_level </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>potential_temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Comute the pressure level given potential temperature and temperature. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>Returns the pressure level in Pascals (Pa) of a parcel given the potential temperature in Kelvin and the temperature of the parcel in Kelvin.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">potential_temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pressure (Pa) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00101">101</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  101</span>                                                                  {</div>
<div class="line"><span class="lineno">  102</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordflow">if</span> ((potential_temperature == MISSING) || (temperature == MISSING)) {</div>
<div class="line"><span class="lineno">  104</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  105</span>    }</div>
<div class="line"><span class="lineno">  106</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  107</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> CPOR = CP_DRYAIR / RDGAS;</div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">return</span> THETA_REF_PRESSURE /</div>
<div class="line"><span class="lineno">  109</span>           std::pow((potential_temperature / temperature), CPOR);</div>
<div class="line"><span class="lineno">  110</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#afda77fe7a6cefaab1ecb404167ed90b4">CP_DRYAIR</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a95fe38384587dd0ca0f08eafa30c0597">RDGAS</a>, and <a class="el" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">THETA_REF_PRESSURE</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#ae4385866921cd7286946d9ffdd65c25e">drylift()</a>, and <a class="el" href="thermo__wrap_8h.html#a55093f841a1789ae9d59e964df469b4d">sharp_theta_level()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab50b565bcba73d207dc1433dee5b03c9_icgraph.svg" width="976" height="312"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a5e3156aa7f5bafbd908184c7f51927ee" name="a5e3156aa7f5bafbd908184c7f51927ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e3156aa7f5bafbd908184c7f51927ee">&#9670;&#160;</a></span>theta_wetbulb() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Lft &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">float sharp::theta_wetbulb </td>
          <td>(</td>
          <td class="paramtype">Lft&#160;</td>
          <td class="paramname"><em>lifter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dewpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the wetbulb potential temperature. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>Compute the wet bulb potential temperature (K) given the pressure (Pa), temperature (K), and dewpoint (K).</p>
<p>First, it lifts a parcel with the given pressure, temperature, and dewpoint temperature to its Lifted Condensation Level (LCL). To compute the temperature and pressure of the LCL, an approximation is used. See the <a class="el" href="namespacesharp.html#af016701e4a46d5c04d26c0a09c0aad38" title="Compute the temperature of the LCL.">sharp::lcl_temperature</a> documentation for more information.</p>
<p>After the parcel has reached the LCL, the lifter passed in lowers the parcel to the standard reference pressure level (1000.0 hPa) along a moist adiabat.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lifter</td><td>(wobf, cm1) </td></tr>
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">dewpoint</td><td>(K)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>wetbulb_potential_temperature (K) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8h_source.html#l00480">480</a> of file <a class="el" href="thermo_8h_source.html">thermo.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  481</span>                                                  {</div>
<div class="line"><span class="lineno">  482</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">if</span> ((pressure == MISSING) || (temperature == MISSING) ||</div>
<div class="line"><span class="lineno">  484</span>        (dewpoint == MISSING)) {</div>
<div class="line"><span class="lineno">  485</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  486</span>    }</div>
<div class="line"><span class="lineno">  487</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordtype">float</span> pres_lcl = MISSING;</div>
<div class="line"><span class="lineno">  490</span>    <span class="keywordtype">float</span> tmpk_lcl = MISSING;</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>    <span class="comment">// pressure_at_lcl and temperature_at_lcl are passed by reference,</span></div>
<div class="line"><span class="lineno">  493</span>    <span class="comment">// so the values are changed by the drylift routine</span></div>
<div class="line"><span class="lineno">  494</span>    drylift(pressure, temperature, dewpoint, pres_lcl, tmpk_lcl);</div>
<div class="line"><span class="lineno">  495</span>    lifter.setup(pres_lcl, tmpk_lcl);</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>    <span class="keywordflow">return</span> lifter(pres_lcl, tmpk_lcl, THETA_REF_PRESSURE);</div>
<div class="line"><span class="lineno">  498</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#ae4385866921cd7286946d9ffdd65c25e">drylift()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">THETA_REF_PRESSURE</a>.</p>

<p class="reference">Referenced by <a class="el" href="thermo__wrap_8h.html#adfde578d6548e8bbf3d24159d2e6f0bc">sharp_theta_wetbulb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a5e3156aa7f5bafbd908184c7f51927ee_cgraph.svg" width="539" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a5e3156aa7f5bafbd908184c7f51927ee_icgraph.svg" width="376" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a514db8e8d5e4925dd56fd773fdd9ef55" name="a514db8e8d5e4925dd56fd773fdd9ef55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a514db8e8d5e4925dd56fd773fdd9ef55">&#9670;&#160;</a></span>theta_wetbulb() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::theta_wetbulb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1lifter__cm1.html">lifter_cm1</a>&#160;</td>
          <td class="paramname"><em>lifter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dewpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4a24e90b43358dfbdac50c9008de657c" name="a4a24e90b43358dfbdac50c9008de657c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a24e90b43358dfbdac50c9008de657c">&#9670;&#160;</a></span>theta_wetbulb() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::theta_wetbulb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1lifter__wobus.html">lifter_wobus</a>&#160;</td>
          <td class="paramname"><em>lifter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dewpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab06f16aa1caac3136e863db8cd61e2e9" name="ab06f16aa1caac3136e863db8cd61e2e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab06f16aa1caac3136e863db8cd61e2e9">&#9670;&#160;</a></span>thetae()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::thetae </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dewpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the equivalent potential temperature. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>Compute the equivalent potential temperature (K) given the pressure (Pa), temperature (K), and dewpoint (K). The equivalent potential temperature is computed as in Bolton 1980. It was found in Davies-Jones 2009 that this is the most accurate non-iterative formulation of ThetaE.</p>
<p>Bolton 1980: <a href="https://doi.org/10.1175/1520-0493(1980)108%3C1046:TCOEPT%3E2.0.CO;2">https://doi.org/10.1175/1520-0493(1980)108%3C1046:TCOEPT%3E2.0.CO;2</a> Davies-Jones 2009: <a href="https://doi.org/10.1175/2009MWR2774.1">https://doi.org/10.1175/2009MWR2774.1</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">dewpoint</td><td>(K)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>equivalent_potential_temperature (K) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00377">377</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  377</span>                                                                {</div>
<div class="line"><span class="lineno">  378</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  379</span>    <span class="keywordflow">if</span> ((pressure == MISSING) || (temperature == MISSING) ||</div>
<div class="line"><span class="lineno">  380</span>        (dewpoint == MISSING)) {</div>
<div class="line"><span class="lineno">  381</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  382</span>    }</div>
<div class="line"><span class="lineno">  383</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>    <span class="keywordtype">float</span> pressure_at_lcl = MISSING;</div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordtype">float</span> temperature_at_lcl = MISSING;</div>
<div class="line"><span class="lineno">  387</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> mixr = mixratio(pressure, dewpoint);</div>
<div class="line"><span class="lineno">  388</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> vappres = vapor_pressure(pressure, temperature);</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>    <span class="comment">// pressure_at_lcl and temperature_at_lcl are passed by reference,</span></div>
<div class="line"><span class="lineno">  391</span>    <span class="comment">// so the values are changed by the drylift routine</span></div>
<div class="line"><span class="lineno">  392</span>    drylift(pressure, temperature, dewpoint, pressure_at_lcl,</div>
<div class="line"><span class="lineno">  393</span>            temperature_at_lcl);</div>
<div class="line"><span class="lineno">  394</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> theta_lcl_dry =</div>
<div class="line"><span class="lineno">  395</span>        theta(pressure - vappres, temperature) *</div>
<div class="line"><span class="lineno">  396</span>        std::pow((temperature / temperature_at_lcl), (0.28f * mixr));</div>
<div class="line"><span class="lineno">  397</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> thetae =</div>
<div class="line"><span class="lineno">  398</span>        theta_lcl_dry * std::exp(mixr * (1.0 + 0.448 * mixr) *</div>
<div class="line"><span class="lineno">  399</span>                                 (3036.0 / temperature_at_lcl - 1.78));</div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordflow">return</span> thetae;</div>
<div class="line"><span class="lineno">  401</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#ae4385866921cd7286946d9ffdd65c25e">drylift()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#ac38870166f07ac30aadbc46b81340cc4">mixratio()</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, <a class="el" href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">theta()</a>, <a class="el" href="namespacesharp.html#ab06f16aa1caac3136e863db8cd61e2e9">thetae()</a>, and <a class="el" href="namespacesharp.html#a3e31a1a145fc25f07d6326481993b2c2">vapor_pressure()</a>.</p>

<p class="reference">Referenced by <a class="el" href="thermo__wrap_8h.html#a6fa159149e40e0b462647cd423be313f">sharp_thetae()</a>, and <a class="el" href="namespacesharp.html#ab06f16aa1caac3136e863db8cd61e2e9">thetae()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab06f16aa1caac3136e863db8cd61e2e9_cgraph.svg" width="551" height="235"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab06f16aa1caac3136e863db8cd61e2e9_icgraph.svg" width="274" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ac17d8171de07c7a610de63da30ed4f6c" name="ac17d8171de07c7a610de63da30ed4f6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac17d8171de07c7a610de63da30ed4f6c">&#9670;&#160;</a></span>u_component()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::u_component </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>wind_speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>wind_direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the zonal (U) wind component from a wind vector. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>Given the wind speed and direction, compute and return the zonal (U) wind component.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wind_speed</td><td>(m/s) </td></tr>
    <tr><td class="paramname">wind_direction</td><td>(degrees from North)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>u_component (m/s) </dd></dl>

<p class="definition">Definition at line <a class="el" href="winds_8cpp_source.html#l00023">23</a> of file <a class="el" href="winds_8cpp_source.html">winds.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   23</span>                                                          {</div>
<div class="line"><span class="lineno">   24</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   25</span>    <span class="keywordflow">if</span> ((wind_direction == MISSING) || (wind_speed == MISSING)) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   26</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   27</span>    wind_direction *= (PI / 180.0);</div>
<div class="line"><span class="lineno">   28</span>    <span class="keywordflow">return</span> -1.0 * wind_speed * std::sin(wind_direction);</div>
<div class="line"><span class="lineno">   29</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="namespacesharp.html#a36f9a81a6f5f2f96e2e34b5607b8a3da">PI</a>.</p>

<p class="reference">Referenced by <a class="el" href="winds__wrap_8h.html#a8d1a1686a5bb8bab2f0743548c68514c">sharp_u_component()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ac17d8171de07c7a610de63da30ed4f6c_icgraph.svg" width="367" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a772686549a5111c1152b778731119aa6" name="a772686549a5111c1152b778731119aa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a772686549a5111c1152b778731119aa6">&#9670;&#160;</a></span>upper_bound()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename C  = std::less&lt;&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr std::ptrdiff_t sharp::upper_bound </td>
          <td>(</td>
          <td class="paramtype">const T&#160;</td>
          <td class="paramname"><em>array</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const C&#160;</td>
          <td class="paramname"><em>cmp</em> = <code>C{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds the first index that satisfies value &lt; element. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Based on std::upper_bound, this iterates over an array using a binary search to find the first element that satisfies the comparison condition. By default, the comparison is std::less. Binary search expects data to be in ascending order &ndash; for pressure level data, change the comparitor.</p>
<p>We use a custom implementation of <a class="el" href="namespacesharp.html#a772686549a5111c1152b778731119aa6" title="Finds the first index that satisfies value &lt; element.">sharp::upper_bound</a> rather than std::upper_bound for a few reasons. First, we prefer raw pointer arrays over vectors for easy integration with SWIG bindings, C code, and the potential future in which this runs on CUDA architecture. Currently, the algorithms in the STL library are not supported by the CUDA STL, but the types in &lt;functional&gt; (i.e. std::less) are supported by the CUDA STL. Additionally, this implementation of lower_bound is designed to reduce branching.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">array</td><td>The array to search over </td></tr>
    <tr><td class="paramname">N</td><td>The length of the array </td></tr>
    <tr><td class="paramname">value</td><td>The value for upper-bound comparison </td></tr>
    <tr><td class="paramname">cmp</td><td>The comparitor</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index of the upper bound </dd></dl>

<p class="definition">Definition at line <a class="el" href="algorithms_8h_source.html#l00091">91</a> of file <a class="el" href="algorithms_8h_source.html">algorithms.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>                                                                  {}) {</div>
<div class="line"><span class="lineno">   95</span>    std::ptrdiff_t len = N;</div>
<div class="line"><span class="lineno">   96</span>    std::ptrdiff_t idx = 0;</div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordflow">while</span> (len &gt; 1) {</div>
<div class="line"><span class="lineno">   98</span>        std::ptrdiff_t half = len / 2;</div>
<div class="line"><span class="lineno">   99</span>        idx += !cmp(value, array[idx + half - 1]) * half;</div>
<div class="line"><span class="lineno">  100</span>        len -= half;  <span class="comment">// = ceil(len / 2)</span></div>
<div class="line"><span class="lineno">  101</span>    }</div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">return</span> idx;</div>
<div class="line"><span class="lineno">  103</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="namespacesharp.html#ac93f477dfa774c966b5da7521bd43ee6">get_layer_index()</a>, <a class="el" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height()</a>, and <a class="el" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a772686549a5111c1152b778731119aa6_icgraph.svg" width="1360" height="1780"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="af2232af9f4649a0701f64d2d7770f5ea" name="af2232af9f4649a0701f64d2d7770f5ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2232af9f4649a0701f64d2d7770f5ea">&#9670;&#160;</a></span>v_component()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::v_component </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>wind_speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>wind_direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the meridional (V) wind component from a wind vector. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>Given the wind speed and direction, compute and return the meridional (V) wind component.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wind_speed</td><td>(m/s) </td></tr>
    <tr><td class="paramname">wind_direction</td><td>(degrees from North)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>v_component (m/s) </dd></dl>

<p class="definition">Definition at line <a class="el" href="winds_8cpp_source.html#l00031">31</a> of file <a class="el" href="winds_8cpp_source.html">winds.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   31</span>                                                          {</div>
<div class="line"><span class="lineno">   32</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   33</span>    <span class="keywordflow">if</span> ((wind_direction == MISSING) || (wind_speed == MISSING)) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   34</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   35</span>    wind_direction *= (PI / 180.0);</div>
<div class="line"><span class="lineno">   36</span>    <span class="keywordflow">return</span> -1.0 * wind_speed * std::cos(wind_direction);</div>
<div class="line"><span class="lineno">   37</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="namespacesharp.html#a36f9a81a6f5f2f96e2e34b5607b8a3da">PI</a>.</p>

<p class="reference">Referenced by <a class="el" href="winds__wrap_8h.html#ad74d4e38d8cd931d62a28e483ebdf24a">sharp_v_component()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_af2232af9f4649a0701f64d2d7770f5ea_icgraph.svg" width="367" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a3e31a1a145fc25f07d6326481993b2c2" name="a3e31a1a145fc25f07d6326481993b2c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e31a1a145fc25f07d6326481993b2c2">&#9670;&#160;</a></span>vapor_pressure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::vapor_pressure </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the vapor pressure over liquid water. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes the vapor pressure (or saturation vapor pressure) in Pascals (Pa) over liquid water given the temperature in Kelvin (or dewpoint temperature in Kelvin). The air pressure is used as a minimum floor for extremely cold temperatures and low pressures.</p>
<p>This function uses the formulation by Bolton (1980), and is accurate to 0.3% for the temperature range of -35C &lt;= T &lt;= 35 C</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vapor_pressure (Pa) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00052">52</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span>                                                        {</div>
<div class="line"><span class="lineno">   53</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">if</span> ((temperature == MISSING) || (pressure == MISSING)) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   55</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   56</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> tmpc = temperature - ZEROCNK;</div>
<div class="line"><span class="lineno">   57</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> es = 611.2f * std::exp(17.67f * tmpc / (temperature - 29.65f));</div>
<div class="line"><span class="lineno">   58</span>    <span class="comment">// for extremely cold temperatures</span></div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordflow">return</span> std::min(es, pressure * 0.5f);</div>
<div class="line"><span class="lineno">   60</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="namespacesharp.html#aa8d73d01806950def2c52b818f90cb6c">ZEROCNK</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a9edcf0847c46e877689081848c58e3f4">mixratio()</a>, <a class="el" href="thermo__wrap_8h.html#abbd416cbe5887bd7073a36cc2ac382c5">sharp_vapor_pressure()</a>, and <a class="el" href="namespacesharp.html#ab06f16aa1caac3136e863db8cd61e2e9">thetae()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a3e31a1a145fc25f07d6326481993b2c2_icgraph.svg" width="546" height="159"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aaf448e4ec9a4f7ac7edc9b960f656fd8" name="aaf448e4ec9a4f7ac7edc9b960f656fd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf448e4ec9a4f7ac7edc9b960f656fd8">&#9670;&#160;</a></span>vapor_pressure_ice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::vapor_pressure_ice </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the vapor pressure over ice. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes the vapor pressure (or saturation vapor pressure) in Pascals (Pa) over ice given the temperature in Kelvin (or dewpoint temperature in Kelvin). The air pressure is used as a minimum floor for extremely cold temperatures and low pressures.</p>
<p>This function uses the formulation by Bolton (1980), and is accurate to 0.3% for the temperature range of -35C &lt;= T &lt;= 35C</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vapor_pressure (Pa) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00062">62</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   62</span>                                                            {</div>
<div class="line"><span class="lineno">   63</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   64</span>    <span class="keywordflow">if</span> ((temperature == MISSING) || (pressure == MISSING)) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   65</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   66</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> tmpc = temperature - ZEROCNK;</div>
<div class="line"><span class="lineno">   67</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> es =</div>
<div class="line"><span class="lineno">   68</span>        611.2f * std::exp(21.8745584f * tmpc / (temperature - 7.66f));</div>
<div class="line"><span class="lineno">   69</span>    <span class="comment">// for extremely cold temperatures</span></div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordflow">return</span> std::min(es, pressure * 0.5f);</div>
<div class="line"><span class="lineno">   71</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, and <a class="el" href="namespacesharp.html#aa8d73d01806950def2c52b818f90cb6c">ZEROCNK</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a0ebcad18ef9939ff56f23d49c35dd04c">mixratio_ice()</a>, and <a class="el" href="thermo__wrap_8h.html#ac0d2e63a39f8d0501390e1ae61d38338">sharp_vapor_pressure_ice()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_aaf448e4ec9a4f7ac7edc9b960f656fd8_icgraph.svg" width="1120" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a24ba1a17b591165e527fa9bf6156eed2" name="a24ba1a17b591165e527fa9bf6156eed2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24ba1a17b591165e527fa9bf6156eed2">&#9670;&#160;</a></span>vector_angle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::vector_angle </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>u_comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>v_comp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the direction (degrees from North) a vector points to. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>Given the zonal (U) and meridional (V) components of a vector, compute and return the direction (degrees from North) the vector points to.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u_comp</td><td>(m/s) </td></tr>
    <tr><td class="paramname">v_comp</td><td>(m/s)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>wind_direction (degrees from North) </dd></dl>

<p class="definition">Definition at line <a class="el" href="winds_8cpp_source.html#l00039">39</a> of file <a class="el" href="winds_8cpp_source.html">winds.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   39</span>                                               {</div>
<div class="line"><span class="lineno">   40</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   41</span>    <span class="keywordflow">if</span> ((u_comp == MISSING) || (v_comp == MISSING)) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   42</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">if</span> ((u_comp == 0) &amp;&amp; (v_comp == 0)) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>    <span class="keywordtype">float</span> wind_direction =</div>
<div class="line"><span class="lineno">   46</span>        std::atan2(-1.0 * u_comp, -1.0 * v_comp) * (180.0 / PI);</div>
<div class="line"><span class="lineno">   47</span>    <span class="keywordflow">if</span> (wind_direction &lt; 0) wind_direction += 360.0;</div>
<div class="line"><span class="lineno">   48</span>    <span class="keywordflow">if</span> (wind_direction &lt; TOL) wind_direction = 0;</div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">return</span> wind_direction;</div>
<div class="line"><span class="lineno">   50</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a36f9a81a6f5f2f96e2e34b5607b8a3da">PI</a>, and <a class="el" href="namespacesharp.html#a97ce2ca879d02b75bc90aa0f33da4ecb">TOL</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#adc84f46d1ec5872b1777857983bdb4be">components_to_vector()</a>, and <a class="el" href="winds__wrap_8h.html#a478d6357c54b82d439b182c838da33eb">sharp_vector_angle()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a24ba1a17b591165e527fa9bf6156eed2_icgraph.svg" width="590" height="102"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="af887f27accb1a1d656a35abec65cab5f" name="af887f27accb1a1d656a35abec65cab5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af887f27accb1a1d656a35abec65cab5f">&#9670;&#160;</a></span>vector_magnitude()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::vector_magnitude </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>u_comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>v_comp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the magnitude of a vector given its components. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>Given the zonal (U) and meridional (V) components of a vector, compute and return the magnitude (m/s) of the vector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u_comp</td><td>(m/s) </td></tr>
    <tr><td class="paramname">v_comp</td><td>(m/s)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>wind_speed (m/s) </dd></dl>

<p class="definition">Definition at line <a class="el" href="winds_8cpp_source.html#l00052">52</a> of file <a class="el" href="winds_8cpp_source.html">winds.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span>                                                   {</div>
<div class="line"><span class="lineno">   53</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">if</span> ((u_comp == MISSING) || (v_comp == MISSING)) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   55</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordflow">return</span> std::sqrt((u_comp * u_comp) + (v_comp * v_comp));</div>
<div class="line"><span class="lineno">   57</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#adc84f46d1ec5872b1777857983bdb4be">components_to_vector()</a>, <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, <a class="el" href="winds__wrap_8h.html#aeb2c523b18446c5d9c1bc6a15cb98a7b">sharp_vector_magnitude()</a>, and <a class="el" href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">storm_motion_bunkers()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_af887f27accb1a1d656a35abec65cab5f_icgraph.svg" width="888" height="294"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ace465acac91184c91987bb085a81777a" name="ace465acac91184c91987bb085a81777a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace465acac91184c91987bb085a81777a">&#9670;&#160;</a></span>vector_magnitude_precise()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::vector_magnitude_precise </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>u_comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>v_comp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Precisely computes the magnitude of a vector given its components. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>Given the zonal (U) and meridional (V) components of a vector, compute and return the magnitude (distance / time) of the vector. Instead of using a standard sqrt(u*u + v*v) approach, this uses the c++ Standard Template Library implementation of std::hypot. Using std::hypot is ~20 times slower, but ensures a higher accuracy and checks for overflow/underflow when using extremely large or extremely small values. Chances are, you are fine using the imprecise version as long as values are in the range of 1e-100 &lt; values &lt; 1e100.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u_comp</td><td>(m/s) </td></tr>
    <tr><td class="paramname">v_comp</td><td>(m/s)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>wind_speed (m/s) </dd></dl>

<p class="definition">Definition at line <a class="el" href="winds_8cpp_source.html#l00059">59</a> of file <a class="el" href="winds_8cpp_source.html">winds.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   59</span>                                                           {</div>
<div class="line"><span class="lineno">   60</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordflow">if</span> ((u_comp == MISSING) || (v_comp == MISSING)) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   62</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordflow">return</span> std::hypot(u_comp, v_comp);</div>
<div class="line"><span class="lineno">   64</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>.</p>

</div>
</div>
<a id="a1a4cb8e554c04774503b004939f27f54" name="a1a4cb8e554c04774503b004939f27f54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a4cb8e554c04774503b004939f27f54">&#9670;&#160;</a></span>vector_to_components() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a> sharp::vector_to_components </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>wind_speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>wind_direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Conveniance function to compute the U and V components of a wind vector. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Given the wind speed and direction of a vector, compute and return the zonal and meridional vector components as a struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wind_speed</td><td>(m/s) </td></tr>
    <tr><td class="paramname">wind_direction</td><td>(degrees from North)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{u_comp, v_comp} </dd></dl>

<p class="definition">Definition at line <a class="el" href="winds_8cpp_source.html#l00080">80</a> of file <a class="el" href="winds_8cpp_source.html">winds.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   80</span>                                                                            {</div>
<div class="line"><span class="lineno">   81</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordflow">if</span> ((wind_direction == MISSING) || (wind_speed == MISSING))</div>
<div class="line"><span class="lineno">   83</span>        <span class="keywordflow">return</span> {MISSING, MISSING};</div>
<div class="line"><span class="lineno">   84</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   85</span>    wind_direction *= (PI / 180.0);</div>
<div class="line"><span class="lineno">   86</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> u_comp = -1.0 * wind_speed * std::sin(wind_direction);</div>
<div class="line"><span class="lineno">   87</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> v_comp = -1.0 * wind_speed * std::cos(wind_direction);</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordflow">return</span> {u_comp, v_comp};</div>
<div class="line"><span class="lineno">   90</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="namespacesharp.html#a36f9a81a6f5f2f96e2e34b5607b8a3da">PI</a>.</p>

<p class="reference">Referenced by <a class="el" href="winds__wrap_8h.html#ad572f107b81caef24445e9dcc70587d2">sharp_vector_to_components()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a1a4cb8e554c04774503b004939f27f54_icgraph.svg" width="487" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ae211cc70dd043a0e2fe7e92ab9dd34a2" name="ae211cc70dd043a0e2fe7e92ab9dd34a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae211cc70dd043a0e2fe7e92ab9dd34a2">&#9670;&#160;</a></span>vector_to_components() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a> sharp::vector_to_components </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1WindVector.html">WindVector</a>&#160;</td>
          <td class="paramname"><em>vect</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Conveniance function to compute the U and V components of a wind vector. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Given the wind speed and direction of a vector via <a class="el" href="structsharp_1_1WindVector.html" title="A simple structure of two named floats that represent a wind vector.">sharp::WindVector</a>, compute and return the zonal and meridional vector components as a struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vect</td><td>{speed, direction}</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{u_comp, v_comp} </dd></dl>

<p class="definition">Definition at line <a class="el" href="winds_8cpp_source.html#l00092">92</a> of file <a class="el" href="winds_8cpp_source.html">winds.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   92</span>                                                     {</div>
<div class="line"><span class="lineno">   93</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">if</span> ((vect.<a class="code hl_variable" href="structsharp_1_1WindVector.html#aa3f670f49d0be2a84315ade680e36f2c">speed</a> == MISSING) || (vect.<a class="code hl_variable" href="structsharp_1_1WindVector.html#a7b0e4f3430c225b096be25471fdaee46">direction</a> == MISSING))</div>
<div class="line"><span class="lineno">   95</span>        <span class="keywordflow">return</span> {MISSING, MISSING};</div>
<div class="line"><span class="lineno">   96</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   97</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> wind_direction = vect.<a class="code hl_variable" href="structsharp_1_1WindVector.html#a7b0e4f3430c225b096be25471fdaee46">direction</a> * (PI / 180.0);</div>
<div class="line"><span class="lineno">   98</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> u_comp = -1.0 * vect.<a class="code hl_variable" href="structsharp_1_1WindVector.html#aa3f670f49d0be2a84315ade680e36f2c">speed</a> * std::sin(wind_direction);</div>
<div class="line"><span class="lineno">   99</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> v_comp = -1.0 * vect.<a class="code hl_variable" href="structsharp_1_1WindVector.html#aa3f670f49d0be2a84315ade680e36f2c">speed</a> * std::cos(wind_direction);</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">return</span> {u_comp, v_comp};</div>
<div class="line"><span class="lineno">  102</span>}</div>
<div class="ttc" id="astructsharp_1_1WindVector_html_a7b0e4f3430c225b096be25471fdaee46"><div class="ttname"><a href="structsharp_1_1WindVector.html#a7b0e4f3430c225b096be25471fdaee46">sharp::WindVector::direction</a></div><div class="ttdeci">float direction</div><div class="ttdoc">The direction (degrees from North) of a wind vector.</div><div class="ttdef"><b>Definition:</b> <a href="winds_8h_source.html#l00039">winds.h:39</a></div></div>
<div class="ttc" id="astructsharp_1_1WindVector_html_aa3f670f49d0be2a84315ade680e36f2c"><div class="ttname"><a href="structsharp_1_1WindVector.html#aa3f670f49d0be2a84315ade680e36f2c">sharp::WindVector::speed</a></div><div class="ttdeci">float speed</div><div class="ttdoc">The magntidue of a wind vector.</div><div class="ttdef"><b>Definition:</b> <a href="winds_8h_source.html#l00034">winds.h:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structsharp_1_1WindVector.html#a7b0e4f3430c225b096be25471fdaee46">sharp::WindVector::direction</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a36f9a81a6f5f2f96e2e34b5607b8a3da">PI</a>, and <a class="el" href="structsharp_1_1WindVector.html#aa3f670f49d0be2a84315ade680e36f2c">sharp::WindVector::speed</a>.</p>

</div>
</div>
<a id="a46e2f332f68747fee1eb817f7bd3a00b" name="a46e2f332f68747fee1eb817f7bd3a00b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46e2f332f68747fee1eb817f7bd3a00b">&#9670;&#160;</a></span>virtual_temperature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::virtual_temperature </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>rl</em> = <code>0.0f</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>ri</em> = <code>0.0f</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the full virtual temperature. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Returns the virtual temperature in Kelvin given the dry-bulb temperature in Kelvin, the water vapor mixing ratio (rv) in kg/kg, the liquid water mixing ratio (rl) in kg/kg, and the ice water mixing ratio (ri) in kg/kg.</p>
<p>For convenience, the rl and ri terms have a default value of zero to easily support returning just the virtual temperature from water vapor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">rv</td><td>(kg/kg) </td></tr>
    <tr><td class="paramname">rl</td><td>(kg/kg) </td></tr>
    <tr><td class="paramname">ri</td><td>(kg/kg)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>virtual_temperature (K) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00157">157</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  157</span>                                                                           {</div>
<div class="line"><span class="lineno">  158</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">if</span> ((qv == MISSING) || (ql == MISSING) || (qi == MISSING) ||</div>
<div class="line"><span class="lineno">  160</span>        (temperature == MISSING)) {</div>
<div class="line"><span class="lineno">  161</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  162</span>    }</div>
<div class="line"><span class="lineno">  163</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">return</span> (temperature * ((1.0 + (qv / EPSILON)) / (1.0 + qv + ql + qi)));</div>
<div class="line"><span class="lineno">  165</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#a83dfda911c84f0dda42368d0c1b63ef1">EPSILON</a>, and <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>.</p>

<p class="reference">Referenced by <a class="el" href="structsharp_1_1Parcel.html#a9523de2b8b4c28ca49fba3013f94cb06">sharp::Parcel::lift_parcel()</a>, <a class="el" href="structsharp_1_1lifter__wobus.html#a82be5bdfdff54890488bbc1461b5b05e">sharp::lifter_wobus::parcel_virtual_temperature()</a>, <a class="el" href="structsharp_1_1lifter__cm1.html#a2fc203010e232bd969ac0b09f15c4329">sharp::lifter_cm1::parcel_virtual_temperature()</a>, and <a class="el" href="thermo__wrap_8h.html#a0568dcc4e8ae316e0385f98ceee9fbb0">sharp_virtual_temperature()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a46e2f332f68747fee1eb817f7bd3a00b_icgraph.svg" width="895" height="262"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="accda9c75278f1a32978bbfd662492822" name="accda9c75278f1a32978bbfd662492822"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accda9c75278f1a32978bbfd662492822">&#9670;&#160;</a></span>wetbulb() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Lft &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">float sharp::wetbulb </td>
          <td>(</td>
          <td class="paramtype">Lft&#160;</td>
          <td class="paramname"><em>lifter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dewpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the wetbulb temperature. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>Compute the wet bulb temperature (K) given the pressure (Pa), temperature (K), and dewpoint (K).</p>
<p>First, it lifts a parcel with the given pressure, temperature, and dewpoint temperature to its Lifted Condensation Level (LCL). To compute the temperature and pressure of the LCL, an approximation is used. See the <a class="el" href="namespacesharp.html#af016701e4a46d5c04d26c0a09c0aad38" title="Compute the temperature of the LCL.">sharp::lcl_temperature</a> documentation for more information.</p>
<p>After the parcel has reached the LCL, the lifter passed in lowers the parcel to its initial pressure level along a moist adiabat.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lifter</td><td>(cm1, wobf) </td></tr>
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">dewpoint</td><td>(K)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>wetbulb_temperature (K) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8h_source.html#l00433">433</a> of file <a class="el" href="thermo_8h_source.html">thermo.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  434</span>                                            {</div>
<div class="line"><span class="lineno">  435</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  436</span>    <span class="keywordflow">if</span> ((pressure == MISSING) || (temperature == MISSING) ||</div>
<div class="line"><span class="lineno">  437</span>        (dewpoint == MISSING)) {</div>
<div class="line"><span class="lineno">  438</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  439</span>    }</div>
<div class="line"><span class="lineno">  440</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  441</span> </div>
<div class="line"><span class="lineno">  442</span>    <span class="keywordtype">float</span> pres_lcl = MISSING;</div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordtype">float</span> tmpk_lcl = MISSING;</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>    <span class="comment">// pressure_at_lcl and temperature_at_lcl are passed by reference,</span></div>
<div class="line"><span class="lineno">  446</span>    <span class="comment">// so the values are changed by the drylift routine</span></div>
<div class="line"><span class="lineno">  447</span>    drylift(pressure, temperature, dewpoint, pres_lcl, tmpk_lcl);</div>
<div class="line"><span class="lineno">  448</span>    lifter.setup(pres_lcl, tmpk_lcl);</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">return</span> lifter(pres_lcl, tmpk_lcl, pressure);</div>
<div class="line"><span class="lineno">  451</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#ae4385866921cd7286946d9ffdd65c25e">drylift()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>.</p>

<p class="reference">Referenced by <a class="el" href="thermo__wrap_8h.html#a3d62d7747127fc25886aed2e9db56cae">sharp_wetbulb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_accda9c75278f1a32978bbfd662492822_cgraph.svg" width="499" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_accda9c75278f1a32978bbfd662492822_icgraph.svg" width="295" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="abb48d1954c4d2cd29e2575bff749a34e" name="abb48d1954c4d2cd29e2575bff749a34e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb48d1954c4d2cd29e2575bff749a34e">&#9670;&#160;</a></span>wetbulb() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::wetbulb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1lifter__cm1.html">lifter_cm1</a>&#160;</td>
          <td class="paramname"><em>lifter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dewpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5301da4223bbde718f7e5b2e8f14e420" name="a5301da4223bbde718f7e5b2e8f14e420"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5301da4223bbde718f7e5b2e8f14e420">&#9670;&#160;</a></span>wetbulb() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::wetbulb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsharp_1_1lifter__wobus.html">lifter_wobus</a>&#160;</td>
          <td class="paramname"><em>lifter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dewpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad4014313c60a66a321e4050a2a07058e" name="ad4014313c60a66a321e4050a2a07058e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4014313c60a66a321e4050a2a07058e">&#9670;&#160;</a></span>wetlift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::wetlift </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>lifted_pressure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the temperature of a parcel lifted moist adiabatically to a new level. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>With a given parcel defined by a pressure and temperature (in Pascals and Kelvin), lift it moist adiabatically to a new pressure level (in Pascals) and return the temperture of the parcel at that level.</p>
<p>This function relies on the Wobus Function ( <a class="el" href="namespacesharp.html#ab535b8214969a50771219a275ebb7f4d" title="Computes the difference between the wet-bulb potential temperatures for saturated and dry air given t...">sharp::wobf</a> ), and it was shown by Robert Davies-Jones (2007) that the Wobus function has a slight dependence on pressure, which results in errors of up to 1.2 Kelvin in the temperature of a lifted parcel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>(Pa) </td></tr>
    <tr><td class="paramname">temperature</td><td>(K) </td></tr>
    <tr><td class="paramname">lifted_pressure</td><td>(Pa)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>lifted_temperature (K) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00203">203</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  203</span>                                                                        {</div>
<div class="line"><span class="lineno">  204</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">if</span> ((temperature == MISSING) || (pressure == MISSING) ||</div>
<div class="line"><span class="lineno">  206</span>        (lifted_pressure == MISSING)) {</div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">  208</span>    }</div>
<div class="line"><span class="lineno">  209</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>    <span class="comment">// parcels potential temperature</span></div>
<div class="line"><span class="lineno">  212</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> pcl_theta = theta(pressure, temperature, THETA_REF_PRESSURE);</div>
<div class="line"><span class="lineno">  213</span>    <span class="comment">// some Wobus voodo</span></div>
<div class="line"><span class="lineno">  214</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> woth = wobf(pcl_theta);</div>
<div class="line"><span class="lineno">  215</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> wott = wobf(temperature);</div>
<div class="line"><span class="lineno">  216</span>    <span class="comment">// This is the wet bulb potential temperature</span></div>
<div class="line"><span class="lineno">  217</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> pcl_thetaw = pcl_theta - woth + wott;</div>
<div class="line"><span class="lineno">  218</span>    <span class="comment">// get the temperature that crosses the moist adiabat at</span></div>
<div class="line"><span class="lineno">  219</span>    <span class="comment">// this pressure level</span></div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">return</span> saturated_lift(lifted_pressure, pcl_thetaw);</div>
<div class="line"><span class="lineno">  221</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>, <a class="el" href="namespacesharp.html#ab8a75ed92a2c2062162264a54f3a5338">saturated_lift()</a>, <a class="el" href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">theta()</a>, <a class="el" href="namespacesharp.html#ab4bb52918c53f75e2175d67840111600">THETA_REF_PRESSURE</a>, and <a class="el" href="namespacesharp.html#ab535b8214969a50771219a275ebb7f4d">wobf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="structsharp_1_1lifter__wobus.html#a92ffe04c0425aef07c524759d799066e">sharp::lifter_wobus::operator()()</a>, and <a class="el" href="thermo__wrap_8h.html#aa66ee47ed2c19f239f7bf3c90669bacf">sharp_wetlift()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ad4014313c60a66a321e4050a2a07058e_cgraph.svg" width="464" height="138"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ad4014313c60a66a321e4050a2a07058e_icgraph.svg" width="311" height="102"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a099a4575acc27d6e10f9dfb69bc315a1" name="a099a4575acc27d6e10f9dfb69bc315a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a099a4575acc27d6e10f9dfb69bc315a1">&#9670;&#160;</a></span>wind_shear()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename L &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="structsharp_1_1WindComponents.html">WindComponents</a> sharp::wind_shear </td>
          <td>(</td>
          <td class="paramtype">L&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>coord</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>u_wind</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>v_wind</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::ptrdiff_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compue the wind shear for a given layer. </p>
<dl class="section author"><dt>Author</dt><dd>Kelton Halbert - NWS Storm Prediction Center</dd></dl>
<p>Computes the U and V components of the wind shear over a layer given the vertical sounding arrays of pressure/height, u_wind, v_wind, and their length.</p>
<p>This generic template handles the logic at compike time on whether or not this is a <a class="el" href="structsharp_1_1HeightLayer.html" title="A simple structure of named floats that represent a height layer.">sharp::HeightLayer</a> or a <a class="el" href="structsharp_1_1PressureLayer.html" title="A simple structure of two named floats that represent a pressure layer.">sharp::PressureLayer</a>, and calls the interpolation routines accordingly</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>{bottom, top} </td></tr>
    <tr><td class="paramname">coord</td><td>(meters or Pa) </td></tr>
    <tr><td class="paramname">u_wind</td><td>(m/s) </td></tr>
    <tr><td class="paramname">v_wind</td><td>(m/s) </td></tr>
    <tr><td class="paramname">N</td><td>(length of arrays)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>{shear_u, shear_v} </dd></dl>

<p class="definition">Definition at line <a class="el" href="winds_8h_source.html#l00262">262</a> of file <a class="el" href="winds_8h_source.html">winds.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  265</span>                                                                        {</div>
<div class="line"><span class="lineno">  266</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordflow">if</span> ((layer.bottom == MISSING) || (layer.top == MISSING))</div>
<div class="line"><span class="lineno">  268</span>        <span class="keywordflow">return</span> {MISSING, MISSING};</div>
<div class="line"><span class="lineno">  269</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>    <span class="keywordtype">float</span> u_bot = MISSING;</div>
<div class="line"><span class="lineno">  272</span>    <span class="keywordtype">float</span> u_top = MISSING;</div>
<div class="line"><span class="lineno">  273</span>    <span class="keywordtype">float</span> v_bot = MISSING;</div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordtype">float</span> v_top = MISSING;</div>
<div class="line"><span class="lineno">  275</span>    <span class="comment">// This if statement disappears at compile time depending</span></div>
<div class="line"><span class="lineno">  276</span>    <span class="comment">// on which kind of layer is passed</span></div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (layer.coord == LayerCoordinate::pressure) {</div>
<div class="line"><span class="lineno">  278</span>        <span class="keywordflow">if</span> (layer.bottom &gt; coord[0]) layer.bottom = coord[0];</div>
<div class="line"><span class="lineno">  279</span>        <span class="keywordflow">if</span> (layer.top &lt; coord[N - 1]) layer.top = coord[N - 1];</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>        u_bot = interp_pressure(layer.bottom, coord, u_wind, N);</div>
<div class="line"><span class="lineno">  282</span>        u_top = interp_pressure(layer.top, coord, u_wind, N);</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>        v_bot = interp_pressure(layer.bottom, coord, v_wind, N);</div>
<div class="line"><span class="lineno">  285</span>        v_top = interp_pressure(layer.top, coord, v_wind, N);</div>
<div class="line"><span class="lineno">  286</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  287</span>        <span class="comment">// AGL to MSL</span></div>
<div class="line"><span class="lineno">  288</span>        layer.bottom += coord[0];</div>
<div class="line"><span class="lineno">  289</span>        layer.top += coord[0];</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>        <span class="keywordflow">if</span> (layer.bottom &lt; coord[0]) layer.bottom = coord[0];</div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">if</span> (layer.top &gt; coord[N - 1]) layer.top = coord[N - 1];</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>        u_bot = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.bottom, coord, u_wind, N);</div>
<div class="line"><span class="lineno">  295</span>        u_top = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.top, coord, u_wind, N);</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>        v_bot = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.bottom, coord, v_wind, N);</div>
<div class="line"><span class="lineno">  298</span>        v_top = <a class="code hl_function" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height</a>(layer.top, coord, v_wind, N);</div>
<div class="line"><span class="lineno">  299</span>    }</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordflow">if</span> ((u_bot == MISSING) || (v_bot == MISSING) || (u_top == MISSING) ||</div>
<div class="line"><span class="lineno">  303</span>        (v_top == MISSING)) {</div>
<div class="line"><span class="lineno">  304</span>        <span class="keywordflow">return</span> {MISSING, MISSING};</div>
<div class="line"><span class="lineno">  305</span>    }</div>
<div class="line"><span class="lineno">  306</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">return</span> {u_top - u_bot, v_top - v_bot};</div>
<div class="line"><span class="lineno">  309</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height()</a>, <a class="el" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure()</a>, <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="namespacesharp.html#a5670844352aa7728286639ae3c43d351ad99fad96a5d0a7cb2eb41341ea556093">pressure</a>.</p>

<p class="reference">Referenced by <a class="el" href="winds__wrap_8h.html#a1c0e9a86e60d26bf1e2d1cedff36c601">sharp_HeightLayer_wind_shear()</a>, and <a class="el" href="winds__wrap_8h.html#a3eac778ad96a01cf68ea55e502520a9c">sharp_PressureLayer_wind_shear()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a099a4575acc27d6e10f9dfb69bc315a1_cgraph.svg" width="718" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_a099a4575acc27d6e10f9dfb69bc315a1_icgraph.svg" width="382" height="115"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab535b8214969a50771219a275ebb7f4d" name="ab535b8214969a50771219a275ebb7f4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab535b8214969a50771219a275ebb7f4d">&#9670;&#160;</a></span>wobf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sharp::wobf </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the difference between the wet-bulb potential temperatures for saturated and dry air given the temperature. </p>
<dl class="section author"><dt>Author</dt><dd>John Hart - NSSFC KCMO / NWSSPC OUN</dd></dl>
<p>The Wobus Function (wobf) is defined as the difference between the wet-bulb potential temperature for saturated air (WBPTS) and the wet-bulb potential temperature for dry air (WBPTD) given an input temperature in Kelvin.</p>
<p>WOBF(T) := WBPTS - WBPTD</p>
<p>Although WBPTS and WBPTD are functions of both pressure and temperature, it is assumed their difference is a function of temperature only. The difference is also proportional to the heat imparted to a parcel.</p>
<p>This function uses a polynomial approximation to the wobus function, fitted to values in Table 78 of PP.319-322 of the Smithsonian Meteorological Tables by Roland List (6th Revised Edition). Herman Wobus, a mathematician for the Navy Weather Research Facility in Norfolk, VA computed these coefficients a very long time ago, as he was retired as of the time of the documentation found on this routine written in 1981.</p>
<p>It was shown by Robert Davies-Jones (2007) that the Wobus function has a slight dependence on pressure, which results in errors of up to 1.2 Kelvin in the temperature of a lifted parcel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temperature</td><td>(K)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>wobf (K) </dd></dl>

<p class="definition">Definition at line <a class="el" href="thermo_8cpp_source.html#l00027">27</a> of file <a class="el" href="thermo_8cpp_source.html">thermo.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   27</span>                              {</div>
<div class="line"><span class="lineno">   28</span><span class="preprocessor">#ifndef NO_QC</span></div>
<div class="line"><span class="lineno">   29</span>    <span class="keywordflow">if</span> (temperature == MISSING) <span class="keywordflow">return</span> MISSING;</div>
<div class="line"><span class="lineno">   30</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   31</span>    <span class="keywordtype">float</span> pol;</div>
<div class="line"><span class="lineno">   32</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> x = temperature - ZEROCNK - 20.0f;</div>
<div class="line"><span class="lineno">   33</span>    <span class="keywordflow">if</span> (x &lt;= 0.0f) {</div>
<div class="line"><span class="lineno">   34</span>        pol = 1.0f +</div>
<div class="line"><span class="lineno">   35</span>              x * (-8.841660499999999e-03f +</div>
<div class="line"><span class="lineno">   36</span>                   x * (1.4714143e-04f +</div>
<div class="line"><span class="lineno">   37</span>                        x * (-9.671989000000001e-07f +</div>
<div class="line"><span class="lineno">   38</span>                             x * (-3.2607217e-08f + x * (-3.8598073e-10f)))));</div>
<div class="line"><span class="lineno">   39</span>        pol = pol * pol;</div>
<div class="line"><span class="lineno">   40</span>        <span class="keywordflow">return</span> (15.13f / (pol * pol)) + ZEROCNK;</div>
<div class="line"><span class="lineno">   41</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   42</span>        pol = x * (4.9618922e-07f +</div>
<div class="line"><span class="lineno">   43</span>                   x * (-6.1059365e-09f +</div>
<div class="line"><span class="lineno">   44</span>                        x * (3.9401551e-11f +</div>
<div class="line"><span class="lineno">   45</span>                             x * (-1.2588129e-13f + x * (1.6688280e-16f)))));</div>
<div class="line"><span class="lineno">   46</span>        pol = 1.0f + x * (3.6182989e-03f + x * (-1.3603273e-05f + pol));</div>
<div class="line"><span class="lineno">   47</span>        pol = pol * pol;</div>
<div class="line"><span class="lineno">   48</span>        <span class="keywordflow">return</span> (29.93f / (pol * pol) + 0.96f * x - 14.8f) + ZEROCNK;</div>
<div class="line"><span class="lineno">   49</span>    }</div>
<div class="line"><span class="lineno">   50</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacesharp.html#af2ffcc858ff03be6e2ae2fe2ee20040d">MISSING</a>, and <a class="el" href="namespacesharp.html#aa8d73d01806950def2c52b818f90cb6c">ZEROCNK</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#ab8a75ed92a2c2062162264a54f3a5338">saturated_lift()</a>, <a class="el" href="thermo__wrap_8h.html#a0a64ef2c75362d5757bc850f28b166d9">sharp_wobf()</a>, and <a class="el" href="namespacesharp.html#ad4014313c60a66a321e4050a2a07058e">wetlift()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesharp_ab535b8214969a50771219a275ebb7f4d_icgraph.svg" width="702" height="138"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="afda77fe7a6cefaab1ecb404167ed90b4" name="afda77fe7a6cefaab1ecb404167ed90b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afda77fe7a6cefaab1ecb404167ed90b4">&#9670;&#160;</a></span>CP_DRYAIR</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::CP_DRYAIR</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">    <a class="code hl_variable" href="namespacesharp.html#a76aec25e3cffb5ba454e762e63aafbf3">DRYAIR_SPEC_HEAT_RATIO</a> * <a class="code hl_variable" href="namespacesharp.html#a95fe38384587dd0ca0f08eafa30c0597">RDGAS</a> / (<a class="code hl_variable" href="namespacesharp.html#a76aec25e3cffb5ba454e762e63aafbf3">DRYAIR_SPEC_HEAT_RATIO</a> - 1.0f)</div>
<div class="ttc" id="anamespacesharp_html_a76aec25e3cffb5ba454e762e63aafbf3"><div class="ttname"><a href="namespacesharp.html#a76aec25e3cffb5ba454e762e63aafbf3">sharp::DRYAIR_SPEC_HEAT_RATIO</a></div><div class="ttdeci">static constexpr float DRYAIR_SPEC_HEAT_RATIO</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00026">constants.h:26</a></div></div>
<div class="ttc" id="anamespacesharp_html_a95fe38384587dd0ca0f08eafa30c0597"><div class="ttname"><a href="namespacesharp.html#a95fe38384587dd0ca0f08eafa30c0597">sharp::RDGAS</a></div><div class="ttdeci">static constexpr float RDGAS</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00045">constants.h:45</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00052">52</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>, <a class="el" href="namespacesharp.html#a0cc6e590243b248f4fb44d9b0e1a6400">buoyancy_dilution_potential()</a>, <a class="el" href="namespacesharp.html#ab5fed65fe0cdf797961047fb9cde3295">moist_static_energy()</a>, and <a class="el" href="namespacesharp.html#ab50b565bcba73d207dc1433dee5b03c9">theta_level()</a>.</p>

</div>
</div>
<a id="a5e0154c5bf801be652400fa05934af6c" name="a5e0154c5bf801be652400fa05934af6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e0154c5bf801be652400fa05934af6c">&#9670;&#160;</a></span>CP_ICE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::CP_ICE = 2118.636f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00059">59</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>.</p>

</div>
</div>
<a id="a2e3e641b9148566d1f4fc1bd06494ec2" name="a2e3e641b9148566d1f4fc1bd06494ec2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e3e641b9148566d1f4fc1bd06494ec2">&#9670;&#160;</a></span>CP_LIQUID</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::CP_LIQUID = 4190.0f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00057">57</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>.</p>

</div>
</div>
<a id="ac7b120df294d5b7f6fb85dbed074d52d" name="ac7b120df294d5b7f6fb85dbed074d52d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7b120df294d5b7f6fb85dbed074d52d">&#9670;&#160;</a></span>CP_VAPOR</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::CP_VAPOR = 1875.0f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00055">55</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>.</p>

</div>
</div>
<a id="a76aec25e3cffb5ba454e762e63aafbf3" name="a76aec25e3cffb5ba454e762e63aafbf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76aec25e3cffb5ba454e762e63aafbf3">&#9670;&#160;</a></span>DRYAIR_SPEC_HEAT_RATIO</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::DRYAIR_SPEC_HEAT_RATIO = 1.4f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00026">26</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

</div>
</div>
<a id="a83dfda911c84f0dda42368d0c1b63ef1" name="a83dfda911c84f0dda42368d0c1b63ef1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83dfda911c84f0dda42368d0c1b63ef1">&#9670;&#160;</a></span>EPSILON</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::EPSILON = <a class="el" href="namespacesharp.html#a95fe38384587dd0ca0f08eafa30c0597">RDGAS</a> / <a class="el" href="namespacesharp.html#a230af88716879ad2bc5cbafef0570e8f">RVGAS</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00049">49</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a9edcf0847c46e877689081848c58e3f4">mixratio()</a>, <a class="el" href="namespacesharp.html#a0ebcad18ef9939ff56f23d49c35dd04c">mixratio_ice()</a>, <a class="el" href="namespacesharp.html#a90a9ae3f1a154cecbcf65d7dbf19233f">temperature_at_mixratio()</a>, and <a class="el" href="namespacesharp.html#a46e2f332f68747fee1eb817f7bd3a00b">virtual_temperature()</a>.</p>

</div>
</div>
<a id="adf7769c64b4673b190d07f0b5d294269" name="adf7769c64b4673b190d07f0b5d294269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf7769c64b4673b190d07f0b5d294269">&#9670;&#160;</a></span>EXP_LS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::EXP_LS = 2.836017e6f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00065">65</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

</div>
</div>
<a id="addc30683489f1fc452c739aeba758985" name="addc30683489f1fc452c739aeba758985"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addc30683489f1fc452c739aeba758985">&#9670;&#160;</a></span>EXP_LV</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::EXP_LV = 2.501e6f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00062">62</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#ab5fed65fe0cdf797961047fb9cde3295">moist_static_energy()</a>.</p>

</div>
</div>
<a id="a35757d2935b734ce153186ef51c2692c" name="a35757d2935b734ce153186ef51c2692c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35757d2935b734ce153186ef51c2692c">&#9670;&#160;</a></span>GAMMA_D</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::GAMMA_D = <a class="el" href="namespacesharp.html#a6e49daafd469b40abf4197bf26af2097">GRAVITY</a> / <a class="el" href="namespacesharp.html#afda77fe7a6cefaab1ecb404167ed90b4">CP_DRYAIR</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00077">77</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

</div>
</div>
<a id="a6e49daafd469b40abf4197bf26af2097" name="a6e49daafd469b40abf4197bf26af2097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e49daafd469b40abf4197bf26af2097">&#9670;&#160;</a></span>GRAVITY</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::GRAVITY = 9.80665f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00038">38</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#aae31e8a18568ec26222b603e629c5598">buoyancy()</a>, <a class="el" href="namespacesharp.html#a0cc6e590243b248f4fb44d9b0e1a6400">buoyancy_dilution_potential()</a>, and <a class="el" href="namespacesharp.html#ab5fed65fe0cdf797961047fb9cde3295">moist_static_energy()</a>.</p>

</div>
</div>
<a id="a4e158bdc0b7370e0fb83a4aaa4dd6757" name="a4e158bdc0b7370e0fb83a4aaa4dd6757"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e158bdc0b7370e0fb83a4aaa4dd6757">&#9670;&#160;</a></span>HPA_TO_PA</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::HPA_TO_PA = 100.0f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00031">31</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

</div>
</div>
<a id="a6adf296a3a61023be86b275deeb25924" name="a6adf296a3a61023be86b275deeb25924"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6adf296a3a61023be86b275deeb25924">&#9670;&#160;</a></span>LS1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::LS1 = <a class="el" href="namespacesharp.html#adf7769c64b4673b190d07f0b5d294269">EXP_LS</a> + (<a class="el" href="namespacesharp.html#a5e0154c5bf801be652400fa05934af6c">CP_ICE</a> - <a class="el" href="namespacesharp.html#ac7b120df294d5b7f6fb85dbed074d52d">CP_VAPOR</a>) * <a class="el" href="namespacesharp.html#aa8d73d01806950def2c52b818f90cb6c">ZEROCNK</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00072">72</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>.</p>

</div>
</div>
<a id="a2fd1765db902cdc4872bc01af9b619e5" name="a2fd1765db902cdc4872bc01af9b619e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fd1765db902cdc4872bc01af9b619e5">&#9670;&#160;</a></span>LS2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::LS2 = <a class="el" href="namespacesharp.html#a5e0154c5bf801be652400fa05934af6c">CP_ICE</a> - <a class="el" href="namespacesharp.html#ac7b120df294d5b7f6fb85dbed074d52d">CP_VAPOR</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00073">73</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>.</p>

</div>
</div>
<a id="a44c890aa9dcb1317ac2e1ad0eeb5ea9c" name="a44c890aa9dcb1317ac2e1ad0eeb5ea9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44c890aa9dcb1317ac2e1ad0eeb5ea9c">&#9670;&#160;</a></span>LV1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::LV1 = <a class="el" href="namespacesharp.html#addc30683489f1fc452c739aeba758985">EXP_LV</a> + (<a class="el" href="namespacesharp.html#a2e3e641b9148566d1f4fc1bd06494ec2">CP_LIQUID</a> - <a class="el" href="namespacesharp.html#ac7b120df294d5b7f6fb85dbed074d52d">CP_VAPOR</a>) * <a class="el" href="namespacesharp.html#aa8d73d01806950def2c52b818f90cb6c">ZEROCNK</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00070">70</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>.</p>

</div>
</div>
<a id="aa60aa56bd4c3247725da749cfa87ade6" name="aa60aa56bd4c3247725da749cfa87ade6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa60aa56bd4c3247725da749cfa87ade6">&#9670;&#160;</a></span>LV2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::LV2 = <a class="el" href="namespacesharp.html#a2e3e641b9148566d1f4fc1bd06494ec2">CP_LIQUID</a> - <a class="el" href="namespacesharp.html#ac7b120df294d5b7f6fb85dbed074d52d">CP_VAPOR</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00071">71</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>.</p>

</div>
</div>
<a id="a741f56d59b05fd970ec5f84382c444af" name="a741f56d59b05fd970ec5f84382c444af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a741f56d59b05fd970ec5f84382c444af">&#9670;&#160;</a></span>MDRY</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::MDRY = 28.96546e-3f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00023">23</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

</div>
</div>
<a id="af2ffcc858ff03be6e2ae2fe2ee20040d" name="af2ffcc858ff03be6e2ae2fe2ee20040d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2ffcc858ff03be6e2ae2fe2ee20040d">&#9670;&#160;</a></span>MISSING</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::MISSING = -9999.0f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00036">36</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a0cc6e590243b248f4fb44d9b0e1a6400">buoyancy_dilution_potential()</a>, <a class="el" href="structsharp_1_1Parcel.html#a0560bd193b2d2d6bc6b08baa7463fba4">sharp::Parcel::cape_cinh()</a>, <a class="el" href="namespacesharp.html#ae4385866921cd7286946d9ffdd65c25e">drylift()</a>, <a class="el" href="namespacesharp.html#a2e6b7cd4a3594a8f2c2050b0e4784cce">effective_inflow_layer()</a>, <a class="el" href="namespacesharp.html#ab89a7e3555a52f0fd9f4086d5aba7037">energy_helicity_index()</a>, <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, <a class="el" href="structsharp_1_1Parcel.html#a8a311e09b1d46a829212da94cf181537">sharp::Parcel::find_lfc_el()</a>, <a class="el" href="namespacesharp.html#ab77e344c7462c9615b0ddac228bc2193">height_layer_to_pressure()</a>, <a class="el" href="namespacesharp.html#a80858337a63be77bafadbb343d6e4931">helicity()</a>, <a class="el" href="namespacesharp.html#a7acec1642f27591dc988bf9e48b4612d">integrate_layer_trapz()</a>, <a class="el" href="namespacesharp.html#ae8240f026498ad2775633a8d0dcf100d">interp_height()</a>, <a class="el" href="namespacesharp.html#a55e4f8ee4ff8a4a30d7b3f3d92a41c75">interp_pressure()</a>, <a class="el" href="namespacesharp.html#a43a01274768ee388a983046651a230d3">lapse_rate()</a>, <a class="el" href="namespacesharp.html#abd0d1a28608e145c455ace03e787e33b">lapse_rate_max()</a>, <a class="el" href="namespacesharp.html#a298e2c96c389f2c5177d3626c908927e">layer_mean()</a>, <a class="el" href="namespacesharp.html#a646b65095b84511b75f6a4a81e545e80">layer_minmax()</a>, <a class="el" href="namespacesharp.html#af016701e4a46d5c04d26c0a09c0aad38">lcl_temperature()</a>, <a class="el" href="namespacesharp.html#a3c8b9022103d067f30281d68fa81cbda">mean_wind()</a>, <a class="el" href="namespacesharp.html#ac38870166f07ac30aadbc46b81340cc4">mixratio()</a>, <a class="el" href="namespacesharp.html#a0ebcad18ef9939ff56f23d49c35dd04c">mixratio_ice()</a>, <a class="el" href="namespacesharp.html#ab5fed65fe0cdf797961047fb9cde3295">moist_static_energy()</a>, <a class="el" href="namespacesharp.html#a31da980f398c9f6a5960ddf868101a94">pressure_layer_to_height()</a>, <a class="el" href="namespacesharp.html#ab8a75ed92a2c2062162264a54f3a5338">saturated_lift()</a>, <a class="el" href="convective__wrap_8h.html#ab0bfb728bbbf3a731c330b61a5c415ad">sharp_entrainment_cape()</a>, <a class="el" href="layer__wrap_8h.html#a1772e4176b54acab025fba01152bf063">sharp_HeightLayer_get_bottom()</a>, <a class="el" href="layer__wrap_8h.html#a808a8ea0fe113278b18da8ce52f949c3">sharp_HeightLayer_get_top()</a>, <a class="el" href="winds__wrap_8h.html#a2275eb46450351ce583c7aef971a0507">sharp_HeightLayer_helicity()</a>, <a class="el" href="thermo__wrap_8h.html#a56e4699ce7fd1603ff1957e72c07d367">sharp_HeightLayer_lapse_rate()</a>, <a class="el" href="layer__wrap_8h.html#aff049d2f08d0ca532b51ee39dfeff547">sharp_HeightLayer_max()</a>, <a class="el" href="layer__wrap_8h.html#a1b669cfe5d14a85dc16aa2ec7b19f914">sharp_HeightLayer_min()</a>, <a class="el" href="parcel__wrap_8h.html#a22f7a49fe7912333a481f6c95f69591e">sharp_Parcel_get_cape()</a>, <a class="el" href="parcel__wrap_8h.html#a2b557d6f731937979a95f2c2546e4fc6">sharp_Parcel_get_cinh()</a>, <a class="el" href="parcel__wrap_8h.html#a7f6f65fafb088dcd06952e0fad794619">sharp_Parcel_get_dwpk()</a>, <a class="el" href="parcel__wrap_8h.html#aad62088857d06858a63e6f06ccdafdc0">sharp_Parcel_get_el_pres()</a>, <a class="el" href="parcel__wrap_8h.html#a192d05d00a38ba14c77bfb4e315eb1d8">sharp_Parcel_get_lcl_pres()</a>, <a class="el" href="parcel__wrap_8h.html#aaaf67b0585fd568c8f6748a1e6df4226">sharp_Parcel_get_lfc_pres()</a>, <a class="el" href="parcel__wrap_8h.html#ac1c765e060093c90bf5c512c112447d2">sharp_Parcel_get_pres()</a>, <a class="el" href="parcel__wrap_8h.html#a75a0b04a763461f32e1bd8ab49f7217c">sharp_Parcel_get_tmpk()</a>, <a class="el" href="layer__wrap_8h.html#a42191f83aa56bf2af5a9d7e7eaa7170e">sharp_PressureLayer_get_bottom()</a>, <a class="el" href="layer__wrap_8h.html#a4bd483073b22cf01d09a14e9b624f46e">sharp_PressureLayer_get_top()</a>, <a class="el" href="winds__wrap_8h.html#a111ef482a9bae9f405ccb271e0816769">sharp_PressureLayer_helicity()</a>, <a class="el" href="thermo__wrap_8h.html#aa9e6b801be3431516421ca34cab2ba95">sharp_PressureLayer_lapse_rate()</a>, <a class="el" href="layer__wrap_8h.html#af26d1ab7a5b701ce5e076ff2a0ef3955">sharp_PressureLayer_max()</a>, <a class="el" href="layer__wrap_8h.html#aa9e2591b56d47f5caa08217690927b49">sharp_PressureLayer_min()</a>, <a class="el" href="convective__wrap_8h.html#a1f68f58bf144a9465dc98d4bdfc55317">sharp_significant_tornado_parameter()</a>, <a class="el" href="winds__wrap_8h.html#ad1ed218be3e8e00573161dc21294cf9f">sharp_WindComponents_get_u()</a>, <a class="el" href="winds__wrap_8h.html#a9d757c87e16d8054f7cd55ce7461db8e">sharp_WindComponents_get_v()</a>, <a class="el" href="winds__wrap_8h.html#a2aed63ca74de2402bfa22a0e70c9b4fb">sharp_WindVector_get_direction()</a>, <a class="el" href="winds__wrap_8h.html#a0b8add65db6e72304b51176c26c5cae2">sharp_WindVector_get_speed()</a>, <a class="el" href="namespacesharp.html#a6eeef5c5c9f1cbe1736996eaf8fe9ae5">significant_tornado_parameter()</a>, <a class="el" href="namespacesharp.html#a792a4a2a9f9243a82fb44cb77c2ee561">specific_humidity()</a>, <a class="el" href="namespacesharp.html#a74a735636c932467b4d2ced544e0cb51">storm_motion_bunkers()</a>, <a class="el" href="namespacesharp.html#a7d1cb8e1918ad656aceef6a512151483">supercell_composite_parameter()</a>, <a class="el" href="namespacesharp.html#a90a9ae3f1a154cecbcf65d7dbf19233f">temperature_at_mixratio()</a>, <a class="el" href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">theta()</a>, <a class="el" href="namespacesharp.html#ab50b565bcba73d207dc1433dee5b03c9">theta_level()</a>, <a class="el" href="namespacesharp.html#a5e3156aa7f5bafbd908184c7f51927ee">theta_wetbulb()</a>, <a class="el" href="namespacesharp.html#ab06f16aa1caac3136e863db8cd61e2e9">thetae()</a>, <a class="el" href="namespacesharp.html#ac17d8171de07c7a610de63da30ed4f6c">u_component()</a>, <a class="el" href="namespacesharp.html#af2232af9f4649a0701f64d2d7770f5ea">v_component()</a>, <a class="el" href="namespacesharp.html#a3e31a1a145fc25f07d6326481993b2c2">vapor_pressure()</a>, <a class="el" href="namespacesharp.html#aaf448e4ec9a4f7ac7edc9b960f656fd8">vapor_pressure_ice()</a>, <a class="el" href="namespacesharp.html#a24ba1a17b591165e527fa9bf6156eed2">vector_angle()</a>, <a class="el" href="namespacesharp.html#af887f27accb1a1d656a35abec65cab5f">vector_magnitude()</a>, <a class="el" href="namespacesharp.html#ace465acac91184c91987bb085a81777a">vector_magnitude_precise()</a>, <a class="el" href="namespacesharp.html#a1a4cb8e554c04774503b004939f27f54">vector_to_components()</a>, <a class="el" href="namespacesharp.html#a46e2f332f68747fee1eb817f7bd3a00b">virtual_temperature()</a>, <a class="el" href="namespacesharp.html#accda9c75278f1a32978bbfd662492822">wetbulb()</a>, <a class="el" href="namespacesharp.html#ad4014313c60a66a321e4050a2a07058e">wetlift()</a>, <a class="el" href="namespacesharp.html#a099a4575acc27d6e10f9dfb69bc315a1">wind_shear()</a>, and <a class="el" href="namespacesharp.html#ab535b8214969a50771219a275ebb7f4d">wobf()</a>.</p>

</div>
</div>
<a id="a5d349d4863e1a955abac2ba65f264a55" name="a5d349d4863e1a955abac2ba65f264a55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d349d4863e1a955abac2ba65f264a55">&#9670;&#160;</a></span>MWATER</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::MWATER = 18.015268e-3f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00025">25</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

</div>
</div>
<a id="a6ed9189675cbc084cdba640eac37a0c4" name="a6ed9189675cbc084cdba640eac37a0c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ed9189675cbc084cdba640eac37a0c4">&#9670;&#160;</a></span>PA_TO_HPA</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::PA_TO_HPA = 0.01f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00032">32</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

</div>
</div>
<a id="a36f9a81a6f5f2f96e2e34b5607b8a3da" name="a36f9a81a6f5f2f96e2e34b5607b8a3da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36f9a81a6f5f2f96e2e34b5607b8a3da">&#9670;&#160;</a></span>PI</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::PI = 3.14159265f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00042">42</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>, <a class="el" href="namespacesharp.html#ac17d8171de07c7a610de63da30ed4f6c">u_component()</a>, <a class="el" href="namespacesharp.html#af2232af9f4649a0701f64d2d7770f5ea">v_component()</a>, <a class="el" href="namespacesharp.html#a24ba1a17b591165e527fa9bf6156eed2">vector_angle()</a>, and <a class="el" href="namespacesharp.html#a1a4cb8e554c04774503b004939f27f54">vector_to_components()</a>.</p>

</div>
</div>
<a id="a9390aa610ba3e66b2e8f84c4261c49af" name="a9390aa610ba3e66b2e8f84c4261c49af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9390aa610ba3e66b2e8f84c4261c49af">&#9670;&#160;</a></span>PRANDTL</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::PRANDTL = 1.f / 3.f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00079">79</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>.</p>

</div>
</div>
<a id="a95fe38384587dd0ca0f08eafa30c0597" name="a95fe38384587dd0ca0f08eafa30c0597"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95fe38384587dd0ca0f08eafa30c0597">&#9670;&#160;</a></span>RDGAS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::RDGAS = <a class="el" href="namespacesharp.html#a4718012c47a66f5229433dd785fc753f">RGAS</a> / <a class="el" href="namespacesharp.html#a741f56d59b05fd970ec5f84382c444af">MDRY</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00045">45</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>, and <a class="el" href="namespacesharp.html#ab50b565bcba73d207dc1433dee5b03c9">theta_level()</a>.</p>

</div>
</div>
<a id="a4718012c47a66f5229433dd785fc753f" name="a4718012c47a66f5229433dd785fc753f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4718012c47a66f5229433dd785fc753f">&#9670;&#160;</a></span>RGAS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::RGAS = 8.314462618f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00021">21</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

</div>
</div>
<a id="a21aa81ae76506b5845830b588cbfb993" name="a21aa81ae76506b5845830b588cbfb993"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21aa81ae76506b5845830b588cbfb993">&#9670;&#160;</a></span>ROCP</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::ROCP = <a class="el" href="namespacesharp.html#a95fe38384587dd0ca0f08eafa30c0597">RDGAS</a> / <a class="el" href="namespacesharp.html#afda77fe7a6cefaab1ecb404167ed90b4">CP_DRYAIR</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00075">75</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>, <a class="el" href="namespacesharp.html#aa258841692c25171d3f3b2e8b1f52079">moist_adiabat_cm1()</a>, <a class="el" href="namespacesharp.html#ab8a75ed92a2c2062162264a54f3a5338">saturated_lift()</a>, and <a class="el" href="namespacesharp.html#acfd0143ab72871c4aabc95c1140ee8fb">theta()</a>.</p>

</div>
</div>
<a id="a230af88716879ad2bc5cbafef0570e8f" name="a230af88716879ad2bc5cbafef0570e8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a230af88716879ad2bc5cbafef0570e8f">&#9670;&#160;</a></span>RVGAS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::RVGAS = <a class="el" href="namespacesharp.html#a4718012c47a66f5229433dd785fc753f">RGAS</a> / <a class="el" href="namespacesharp.html#a5d349d4863e1a955abac2ba65f264a55">MWATER</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00048">48</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>.</p>

</div>
</div>
<a id="ab4bb52918c53f75e2175d67840111600" name="ab4bb52918c53f75e2175d67840111600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4bb52918c53f75e2175d67840111600">&#9670;&#160;</a></span>THETA_REF_PRESSURE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::THETA_REF_PRESSURE = 100000.0f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00034">34</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#ae4385866921cd7286946d9ffdd65c25e">drylift()</a>, <a class="el" href="structsharp_1_1Parcel.html#a9523de2b8b4c28ca49fba3013f94cb06">sharp::Parcel::lift_parcel()</a>, <a class="el" href="structsharp_1_1Parcel.html#a1bf670e79f35a1ce8c904b7ead32ccbe">sharp::Parcel::mixed_layer_parcel()</a>, <a class="el" href="namespacesharp.html#aa258841692c25171d3f3b2e8b1f52079">moist_adiabat_cm1()</a>, <a class="el" href="namespacesharp.html#ab8a75ed92a2c2062162264a54f3a5338">saturated_lift()</a>, <a class="el" href="namespacesharp.html#ab50b565bcba73d207dc1433dee5b03c9">theta_level()</a>, <a class="el" href="namespacesharp.html#a5e3156aa7f5bafbd908184c7f51927ee">theta_wetbulb()</a>, and <a class="el" href="namespacesharp.html#ad4014313c60a66a321e4050a2a07058e">wetlift()</a>.</p>

</div>
</div>
<a id="a97ce2ca879d02b75bc90aa0f33da4ecb" name="a97ce2ca879d02b75bc90aa0f33da4ecb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97ce2ca879d02b75bc90aa0f33da4ecb">&#9670;&#160;</a></span>TOL</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::TOL = 1e-10f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00040">40</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a24ba1a17b591165e527fa9bf6156eed2">vector_angle()</a>.</p>

</div>
</div>
<a id="a2a834f494fab1d9ccc18699ad11a51bc" name="a2a834f494fab1d9ccc18699ad11a51bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a834f494fab1d9ccc18699ad11a51bc">&#9670;&#160;</a></span>VAPPRES_REF</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::VAPPRES_REF = 611.65f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00084">84</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

</div>
</div>
<a id="aee70f2aa7bfda20363d82e6eef5b1a21" name="aee70f2aa7bfda20363d82e6eef5b1a21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee70f2aa7bfda20363d82e6eef5b1a21">&#9670;&#160;</a></span>VKSQ</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::VKSQ = 0.18f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00081">81</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a72bbdc4cfe7895dd51981902ac9fc822">entrainment_cape()</a>.</p>

</div>
</div>
<a id="aa8d73d01806950def2c52b818f90cb6c" name="aa8d73d01806950def2c52b818f90cb6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8d73d01806950def2c52b818f90cb6c">&#9670;&#160;</a></span>ZEROCNK</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float sharp::ZEROCNK = 273.15f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="constants_8h_source.html#l00029">29</a> of file <a class="el" href="constants_8h_source.html">constants.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="namespacesharp.html#a7494c22424745a8847092b64195fb9ae">_solve_cm1()</a>, <a class="el" href="namespacesharp.html#a90a9ae3f1a154cecbcf65d7dbf19233f">temperature_at_mixratio()</a>, <a class="el" href="namespacesharp.html#a3e31a1a145fc25f07d6326481993b2c2">vapor_pressure()</a>, <a class="el" href="namespacesharp.html#aaf448e4ec9a4f7ac7edc9b960f656fd8">vapor_pressure_ice()</a>, and <a class="el" href="namespacesharp.html#ab535b8214969a50771219a275ebb7f4d">wobf()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacesharp.html">sharp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
